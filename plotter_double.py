import csv
import math
from scipy.stats import genpareto
import matplotlib.pyplot as plt
import numpy as numpy
import random
import numpy as np
import statistics
import csv
import matplotlib
from matplotlib.ticker import MaxNLocator
from waa.myglobal import *

ch=1

dual_load_total_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11015840000.0, 11667188571.428572, 12380384000.0, 13158358709.67742, 13881073230.76923, 14642430909.09091, 15366662988.505747, 16159744680.851065, 16895396781.609196, 17677365797.101448, 18474295172.41379, 19221647659.574467, 19950520000.0, 20774480000.0, 21590257297.2973, 22290220000.0, 23075166666.666668, 23757593600.0, 24662049523.809525, 25240676923.076923, 25988406153.846153, 26804933333.333332, 27629902222.22222, 28305480000.0, 29072640000.0, 34433149090.90909]
dual_load_total_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 75801846.94319789, 225992862.2037275, 226165084.24894708, 227049368.55724177, 204674994.51193723, 217384659.99045116, 233931724.93379316, 214649735.8799631, 224237796.30527744, 221421360.28267196, 217152846.14025176, 230695047.59212705, 197595815.61595926, 209828166.2270874, 253176422.37785107, 227905658.3537965, 216918641.58404335, 236136929.67711198, 244552395.6635099, 148038296.3619333, 188124277.96266583, 232212987.29112172, 201123777.91908258, 115505274.81068088, 233474925.42026863, 5251069861.55289]
dual_load_high_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7889920000.0, 7982994285.714286, 7965798400.0, 7976340645.16129, 8009097846.153846, 7985541818.181818, 7987023448.275862, 7987091063.829787, 7972840459.770115, 7999777391.304348, 7988303448.275862, 8029848510.638298, 7986666666.666667, 8020869565.217391, 8014114594.594595, 8020480000.0, 7941226666.666667, 8033689600.0, 8027062857.142858, 8019495384.615385, 8029144615.384615, 7958186666.666667, 8097280000.0, 8047146666.666667, 7925120000.0, 7980450909.090909]
dual_load_high_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18101933.59837562, 151879121.8605864, 132236824.16029206, 161877880.82754323, 147562011.0378632, 136346560.861377, 150170605.930873, 136476675.50114688, 122860374.44631398, 133101710.33121486, 114298840.57295525, 152974752.09382874, 153092570.8181697, 154009970.10953575, 153863621.62271777, 163361883.0260182, 111642646.46695244, 170961366.8951751, 171050478.8985654, 145235497.53276485, 102573391.66140056, 113977992.72959086, 108490854.9141355, 155084062.91330186, 109280819.90907645, 111106788.4023785]
dual_load_med_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3125920000.0, 3684194285.714286, 4245740800.0, 5100322580.645162, 5609772307.692307, 6160807272.727273, 6577588965.5172415, 7090035744.680851, 6861526436.78161, 7001224347.826087, 7202140689.655172, 7176844255.319149, 7209770000.0, 6827346086.956522, 7367009729.72973, 6553845000.0, 6929053333.333333, 7287097600.0, 7090331428.571428, 7893083076.923077, 7137476923.076923, 7326693333.333333, 7297564444.444445, 7254693333.333333, 7993280000.0, 7702618181.818182]
dual_load_med_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 57699913.34482228, 290303364.66197896, 456469999.4698447, 347715452.0766991, 776133229.958719, 948710757.2641929, 1017269400.3831503, 1376936200.12552, 1615377047.1964893, 1672175789.8754318, 1574049070.2396553, 1624247737.009813, 1475764459.104991, 1506880214.7475696, 1439044986.9396148, 1332817043.2922602, 1370050383.4171388, 1345020135.7640214, 1195977580.0669749, 1344395959.3772006, 1863022600.575852, 1311336091.2087588, 1743632316.7966857, 2032042804.225851, 2205275540.3955007, 1520365910.100711]
dual_load_low_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 168844800.0, 81695483.87096775, 262203076.92307693, 496081818.1818182, 802050574.7126436, 1082617872.3404255, 2061029885.0574713, 2676364057.9710145, 3283851034.4827585, 4014954893.617021, 4754083333.333333, 5926264347.826087, 6209132972.972973, 7715895000.0, 8204886666.666667, 8436806400.0, 9544655238.095238, 9328098461.538462, 10821784615.384615, 11520053333.333334, 12235057777.777779, 13003640000.0, 13154240000.0, 18750080000.0]
dual_load_low_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 445970791.31859446, 281415828.68596417, 698955232.196873, 946837550.4095842, 1017920485.8873805, 1370587209.248125, 1686110309.4727972, 1668503173.1697152, 1671019392.822353, 1653404507.7773845, 1550528573.1074727, 1523806910.26368, 1461835001.1788168, 1284063624.8229868, 1413967831.6575377, 1418625766.1873574, 1280073164.8137112, 1288490362.2058785, 1899795557.1087792, 1092846521.6061523, 1630692033.5993688, 2103278287.972028, 2219332625.693289, 5534047633.072921]
dual_thru_total_bps_avg=[4267520000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4120320000.0, 3961234285.714286, 4020531200.0, 4050787096.774194, 4047438769.230769, 4010414545.4545455, 4026320919.54023, 4047278297.87234, 4099795862.0689654, 4053667246.3768115, 4059630344.827586, 4056837446.808511, 4092000000.0, 4045968695.652174, 4088402162.1621623, 3999840000.0, 4044373333.3333335, 4092211200.0, 4153287619.047619, 4058781538.4615383, 4001476923.076923, 3977386666.6666665, 4130417777.7777777, 4072960000.0, 3914880000.0, 4182356363.6363635]
dual_thru_total_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 229894556.69937032, 221740262.66763574, 210530650.03145424, 244215009.6781294, 239337739.81230277, 220920935.24534082, 221462599.83285215, 224766241.82411885, 205649906.08082107, 225192102.51461554, 280004671.1700931, 226877444.54994512, 221260485.593579, 189661818.69151202, 259193282.8255043, 239130308.976022, 202140177.16225642, 197082760.11868718, 454306380.4296035, 153367345.16872412, 163781528.02766532, 275752128.3084986, 196270840.53532875, 167077111.864824, 189755413.09801942, 341094874.0533263]
dual_thru_high_bps_avg=[4267520000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4120320000.0, 3961234285.714286, 4020531200.0, 4050787096.774194, 4047438769.230769, 4010414545.4545455, 4026320919.54023, 4047278297.87234, 4099795862.0689654, 4053667246.3768115, 4059630344.827586, 4056837446.808511, 4092000000.0, 4045968695.652174, 4051580540.5405407, 3999840000.0, 4044373333.3333335, 4092211200.0, 3974217142.857143, 4058781538.4615383, 4001476923.076923, 3977386666.6666665, 4130133333.3333335, 4072960000.0, 3914880000.0, 3860247272.7272725]
dual_thru_high_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 229894556.69937032, 221740262.66763574, 210530650.03145424, 244215009.6781294, 239337739.81230277, 220920935.24534082, 221462599.83285215, 224766241.82411885, 205649906.08082107, 225192102.51461554, 280004671.1700931, 226877444.54994512, 221260485.593579, 189661818.69151202, 201941127.09106782, 239130308.976022, 202140177.16225642, 197082760.11868718, 501574869.63705486, 153367345.16872412, 163781528.02766532, 275752128.3084986, 196082464.28480035, 167077111.864824, 189755413.09801942, 810532106.4719263]
dual_thru_med_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24778378.37837838, 0.0, 0.0, 0.0, 124769523.8095238, 0.0, 0.0, 0.0, 284444.44444444444, 0.0, 0.0, 156480000.0]
dual_thru_med_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150720991.56155157, 0.0, 0.0, 0.0, 571765787.2807379, 0.0, 0.0, 0.0, 853333.3333333333, 0.0, 0.0, 518985447.19481295]
dual_thru_low_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12043243.243243244, 0.0, 0.0, 0.0, 54300952.38095238, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165629090.9090909]
dual_thru_low_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 73256188.74326721, 0.0, 0.0, 0.0, 248838224.59390685, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 548481030.6556562]
dual_drop_total_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7600800000.0, 7298731428.571428, 8043500800.0, 8964219354.838709, 9745122461.538462, 10542670909.09091, 11099904367.816092, 11703014468.085106, 12270740229.885057, 12848825507.246376, 13706965517.241379, 14147155744.680851, 15372253333.333334, 15661593043.47826, 15792406486.486486, 17477325000.0, 18830680000.0, 18222860800.0, 16507565714.285715, 16459643076.923077, 17488443076.923077, 20827200000.0, 18455822222.22222, 23151520000.0, 20616080000.0, 14023069090.90909]
dual_drop_total_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 767295710.4011464, 1245917215.022776, 1266063321.2768888, 1122450030.7777712, 1029844359.3057381, 1197838774.064372, 1548150614.4787505, 1629616196.7602255, 2275761139.424835, 2113869551.2534077, 2863330378.598953, 3589511335.686931, 1768292680.3730748, 3326090509.800003, 4917688122.355539, 2787556625.970771, 1384272782.3662503, 4411569697.558455, 8243793483.937217, 9413610045.75059, 6304638283.474827, 5299424022.317897, 10471329367.508427, 3438471906.1815815, 9590201278.777555, 10223812151.217817]
dual_drop_high_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4474880000.0, 3614537142.857143, 3655065600.0, 3794663225.806452, 3899037538.4615383, 3953250909.090909, 3816371494.2528734, 3684411914.893617, 3641143908.045977, 3557954782.6086955, 3699244137.9310346, 3611070638.2978725, 3616000000.0, 3593683478.2608695, 3386741621.6216216, 3767840000.0, 3843306666.6666665, 3363532800.0, 3216944761.904762, 3235643076.923077, 2346732307.6923075, 3406506666.6666665, 3210808888.888889, 3530240000.0, 3277440000.0, 1102661818.1818182]
dual_drop_high_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 709595797.0563241, 1314772375.70983, 1107353214.5243149, 1104882319.4494727, 892469487.4301565, 944765148.4073389, 1042036774.0671183, 1226249979.4169009, 1153261283.3131964, 1217531386.447242, 1130628057.5174735, 1202234194.5391293, 1179905295.8173687, 1427733715.7470808, 1321033995.6461577, 1298425473.8820424, 1143308844.830069, 1622409857.9056199, 1699820043.4858365, 2009413959.7047718, 2022743838.3466234, 1772459897.0996964, 1879288823.9733431, 1281340737.8211308, 2231543228.7694244, 1899949524.5812097]
dual_drop_med_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3125920000.0, 3684194285.714286, 4219590400.0, 5087860645.16129, 5590089846.153846, 6136241818.181818, 6504993103.448276, 6989433191.489362, 6611378390.804598, 6877977971.014493, 6954706206.896552, 6787302127.6595745, 7097610000.0, 6411353043.478261, 6669885405.405405, 6181875000.0, 6929053333.333333, 6831756800.0, 5772815238.095238, 5878867692.307693, 5819778461.538462, 6235813333.333333, 5707004444.444445, 6617640000.0, 5463120000.0, 2404305454.5454545]
dual_drop_med_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 57699913.34482228, 290303364.66197896, 469156460.7931985, 351406015.06310016, 785299989.4954401, 980765511.3830702, 1236508623.3717964, 1583881647.0027947, 2091664829.0958211, 1924547125.9192533, 2057574468.4857235, 2376545084.581302, 1780829091.7411163, 2223593356.8976636, 2590262920.8490644, 1916071240.745736, 1370050383.4171388, 2276396292.210417, 3087785338.4061837, 3546198885.318743, 3179590803.383999, 3302354465.4483514, 3596642461.6547275, 2450772537.258776, 4014546330.267801, 3723665062.457588]
dual_drop_low_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 168844800.0, 81695483.87096775, 255995076.92307693, 453178181.8181818, 778539770.1149426, 1029169361.7021277, 2018217931.0344827, 2412892753.6231885, 3053015172.413793, 3748782978.7234044, 4658643333.333333, 5656556521.73913, 5735779459.459459, 7527610000.0, 8058320000.0, 8027571200.0, 7517805714.285714, 7345132307.692307, 9321932307.692308, 11184880000.0, 9538008888.88889, 13003640000.0, 11875520000.0, 10516101818.181818]
dual_drop_low_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 445970791.31859446, 281415828.68596417, 699449198.1376379, 936049315.3509969, 1012285668.5301706, 1377523784.8414414, 1691502724.6471384, 1741435701.70596, 1763936059.4502618, 1792144343.017137, 1580580197.653439, 1938459962.273852, 2246211337.551332, 1854856546.0712118, 1321784982.5273333, 2160961817.818476, 4038238957.214607, 4339090374.456675, 3804582203.7252083, 1170382069.5824077, 5594477741.265141, 2103278287.972028, 4186118887.306793, 6085468429.769097]
dual_drop_prob_total_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.68976491553196, 0.6264039774287877, 0.6495956645000507, 0.6813630930935306, 0.7017494610864502, 0.7200092388646308, 0.7222905993594203, 0.7242207100632542, 0.7263809404942715, 0.7269178150367465, 0.7420178602383091, 0.735998007790045, 0.7705347764988579, 0.753967330781988, 0.7309067698029862, 0.7842352256528901, 0.8160054680946311, 0.7671373019556349, 0.6697802486787484, 0.6519378510574885, 0.6737854787130426, 0.7763462920924061, 0.6670592753726057, 0.817721301109494, 0.7109574618922475, 0.439679263962111]
dual_drop_prob_total_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.06490746559928293, 0.11059083013323338, 0.10019341731486618, 0.0853206455861923, 0.07080499794368485, 0.08113718214109707, 0.09961517186275809, 0.09991077847714853, 0.13446558857905588, 0.11937044465092898, 0.1549766593904084, 0.18649664128481472, 0.08787304244097507, 0.1604330158192988, 0.22747587075091216, 0.12501249752015545, 0.058837605040444295, 0.1859701045428686, 0.33461236440169123, 0.3728589984953314, 0.24415608252043913, 0.19560960006481157, 0.378466510869783, 0.12062865782283112, 0.3325410109270316, 0.3293589864358771]
dual_drop_prob_high_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5670624998223441, 0.45312755995950643, 0.4595804352486384, 0.4753756379109384, 0.4866631599874401, 0.4949384058899699, 0.4776656098507222, 0.46099416882056743, 0.45689119954456575, 0.44452317148822934, 0.4628054178760074, 0.44956550882460794, 0.45272955052329394, 0.4469241213297196, 0.42226155160988244, 0.4688001967117602, 0.4842027604244597, 0.4199576376303494, 0.40043672817520315, 0.4011757787938552, 0.29202781064939576, 0.4284844099071121, 0.39764098295747846, 0.4391245232889856, 0.41381401050708605, 0.13768911350669585]
dual_drop_prob_high_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.08863598988816253, 0.16533761589571683, 0.1392400881813694, 0.13782109098021006, 0.11072870374800836, 0.11712337300567313, 0.13028827249770708, 0.15318665762174877, 0.1446166641571257, 0.15128760196812002, 0.14086803548752266, 0.14900225843243942, 0.14658004301332983, 0.17552584838829818, 0.16348716924441706, 0.16009778494918508, 0.14372551593205982, 0.2021007688318132, 0.21114737613916107, 0.2482482181594909, 0.25186087479614827, 0.22492573149631848, 0.23166077395560558, 0.160683661584596, 0.2834616504340332, 0.2369246899004977]
dual_drop_prob_med_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 1.0, 0.9939801104972376, 0.9976830349603107, 0.9966535531932703, 0.9955179695443301, 0.9879047365594631, 0.9830811335539981, 0.956977092673403, 0.9749531299365877, 0.9655172413793104, 0.9361702127659575, 0.9776176039778595, 0.9291629901291544, 0.9025793091801938, 0.9469427834801976, 1.0, 0.9220118196405563, 0.8095238095238095, 0.7692307692307693, 0.7776010114412134, 0.8333333333333334, 0.7777777777777778, 0.9322859977324263, 0.75, 0.30312242362312614]
dual_drop_prob_med_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.03009944751381215, 0.018243800966323175, 0.026979916696825652, 0.03082133957775881, 0.1072319932202945, 0.10407182524926446, 0.19857059159462329, 0.1358745725836433, 0.18405922400991942, 0.24709224814516542, 0.14430537885717817, 0.2385659692621167, 0.28936425764786694, 0.2122753705923122, 0.0, 0.24754709313677292, 0.4023739080814782, 0.4385290096535146, 0.36348018522767844, 0.408248290463863, 0.44095855184409843, 0.23456818462254364, 0.5, 0.45837456825406975]
dual_drop_prob_low_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2, 0.12903225806451613, 0.24625083348487603, 0.32954545454545453, 0.5023864596886085, 0.4574468085106383, 0.7171798323892676, 0.7989914906940512, 0.8448275862068966, 0.8818534191979776, 0.9853490199931227, 0.9554279984729945, 0.9189116889372695, 0.96875, 0.9863212031617091, 0.96, 0.7910469219709841, 0.7692307692307693, 0.8751260630338623, 0.9723906300796935, 0.7777777777777778, 1.0, 0.8876123243942569, 0.6393133369094914]
dual_drop_prob_low_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.408248290463863, 0.3379723030529027, 0.43406641913568733, 0.47274184126735436, 0.4981848528907529, 0.5008571924688408, 0.4482189220668935, 0.3923659957831015, 0.3652311999283316, 0.3179291584823273, 0.10150496701034882, 0.20608222693793238, 0.27672255692972064, 0.1767766952966369, 0.06701214509801717, 0.2, 0.40209863184306727, 0.4385290096535146, 0.31435962151841285, 0.06762886842449713, 0.44095855184409843, 0.0, 0.22477535121148629, 0.38025206719728855]
dual_delay_total_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.015861880230041696, 0.0155415927211605, 0.015507895948187456, 0.015691209471736293, 0.015779768190223083, 0.015684531713455536, 0.01565380054710256, 0.015834567811069827, 0.016092713981209376, 0.016647201738591046, 0.01653953863672747, 0.01671000445429946, 0.016035650594633053, 0.016995441809035682, 0.01765124267797079, 0.016633804025852645, 0.01588439385695358, 0.016781612897233324, 0.021178654936317588, 0.02258565286634509, 0.020930074248678425, 0.018273554762970597, 0.02280811549695986, 0.016712614871558767, 0.022478987160766694, 0.03773152731686164]
dual_delay_total_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.588761721799605e-05, 0.0008119641457459126, 0.0005333034840295831, 0.0005274929819497777, 0.0008282782610664946, 0.0010371753853641247, 0.0013352544710297691, 0.0015653723242186573, 0.0019777464739498753, 0.0031081580328919133, 0.0044799731997203105, 0.004107012997889332, 0.002587089769050243, 0.0042920048262499455, 0.006312584052572069, 0.0037809053578067423, 0.0019778011870895786, 0.005056863186301636, 0.011166098250237032, 0.0133745174420011, 0.009539523769077142, 0.006292024332116875, 0.014013157968151698, 0.004176923257665711, 0.013998390234385108, 0.018908553849643003]
dual_delay_high_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.015861880230041696, 0.0155415927211605, 0.01542988556131918, 0.015633138510755228, 0.01564739213220518, 0.015461317717417582, 0.015321177927244339, 0.015318716069634492, 0.015220354188009752, 0.015257238330689617, 0.015090670383154377, 0.014869120329196623, 0.015320802795914152, 0.01495910464071436, 0.0144526244522162, 0.015045836015370843, 0.015520859937735351, 0.014548891152485713, 0.01285786730476637, 0.012771263573381984, 0.01294466111427657, 0.01416365585009179, 0.012882616781672311, 0.014907173876854479, 0.012421238624360694, 0.008166091224305096]
dual_delay_high_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.588761721799605e-05, 0.0008119641457459126, 0.0008846196294007646, 0.0006640535012031667, 0.0006645319291014425, 0.0006964135123412516, 0.0015105728600676455, 0.0012130052973253166, 0.002175183090363151, 0.001984197572114627, 0.002320252338560336, 0.0031288034073803424, 0.0017062352550214098, 0.0027379136542785977, 0.0038660653345250475, 0.0019073331424805425, 0.0006495246132980328, 0.003020076061401535, 0.005190374958950094, 0.005359763029009453, 0.0038867391323280783, 0.0037832793420210157, 0.005755061186000395, 0.002190075220330044, 0.006118469403275579, 0.0056060960288589305]
dual_delay_med_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2157026692802755, 0.2149569224582883, 0.21557659271296606, 0.21535821827476634, 0.2163886484879169, 0.21787848226831186, 0.2179931972955614, 0.21802256496848615, 0.21727289793681326, 0.2169035033547311, 0.2182825453560401, 0.2177936426969047, 0.21525214486672573, 0.21885499177681872, 0, 0.2181114214452965, 0.2039740785582451, 0.21701411473017118, 0.218028761411929, 0.2188301409984025, 0.21692680741653791, 0.21842002245581163, 0.2170273691056713, 0.20612508225749834]
dual_delay_med_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.782475415004603e-05, 0.0016951553201354362, 0.0016947020406812144, 0.000747835778961566, 0.0012126505983407955, 0.0014667450796714467, 0.0005685655975481478, 0.001743682215389863, 0.0008868278214806589, 0.004367064746081161, 2.9682353885842178e-05, 0, 0.0013218497098178644, 0.02728416025373586, 0.0009234808217503927, 0.00036231633701993323, 0, 0.001093245277367735, 0, 0, 0.0343038740621145]
dual_delay_low_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.20873545324891454, 0.21408813650443478, 0.21400516070055609, 0.16563588864279274, 0.20879226114414495, 0.19358901938271433, 0.20960470292639524, 0.22633398448556208, 0.17452604705713853, 0.2101902333633368, 0.2195151420526325, 0.16790658662106256, 0.12225816581278302, 0.22856844795435546, 0.20700907315747016, 0.22798872710527532, 0.19599326973049475, 0.2260000277957875, 0.22292048125674874, 0, 0.22950783596734095, 0.21707317982898497]
dual_delay_low_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004816545383575455, 0.008764212948513529, 0.04298407916292717, 0.027025937171474015, 0.028268525022278747, 0.02798558813834064, 0.003033269790416782, 0, 0.029512498973759193, 0.008332368839572, 0, 0, 0, 0.03263641899183759, 0.001073801964517376, 0.0339612993985823, 0, 0.0017629434231440425, 0, 0, 0.011949877133045654]
dual_qdelay_total_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.015861778630042095, 0.015541491121160243, 0.015507794206666085, 0.015691107805838943, 0.015779666350898513, 0.015684429642844683, 0.015653698429355777, 0.01583446503380631, 0.016092610799395245, 0.01664709709756073, 0.016539433993426295, 0.016709899679893673, 0.016035547500067016, 0.01699533619230803, 0.01765113552964109, 0.016633698927108222, 0.01588429071377246, 0.016781507166022176, 0.0211785369394462, 0.022585532690099844, 0.020929957268139135, 0.0182734459904989, 0.022807994962500983, 0.016712510074070205, 0.022478867819266807, 0.03773136743882287]
dual_qdelay_total_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.588761721800586e-05, 0.0008119641457457944, 0.0005333040725206539, 0.0005274929320837313, 0.0008282775128617611, 0.0010371731301296087, 0.0013352509843493766, 0.001565367817461903, 0.00197774031645384, 0.0031081499769165894, 0.004479959982361114, 0.004107000722797874, 0.002587083071602353, 0.004291991952933477, 0.00631256668762715, 0.003780893895974453, 0.001977794038233907, 0.005056848253828416, 0.011166067569906128, 0.01337448227550352, 0.009539497962185088, 0.006292006771762184, 0.014013120419020728, 0.0041769122832628815, 0.013998354752436092, 0.018908503797340614]
dual_qdelay_high_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.015861778630042095, 0.015541491121160243, 0.015429783961319214, 0.015633036910754856, 0.01564729053220476, 0.015461216117417067, 0.015321076327243851, 0.015318614469633996, 0.015220252588009115, 0.015257136730689182, 0.015090568783153967, 0.014869018729196251, 0.015320701195913597, 0.014959003040713983, 0.014452522852215637, 0.015045734415370599, 0.015520758337735183, 0.014548789552485128, 0.012857765704765899, 0.012771161973381745, 0.012944559514276402, 0.014163554250091828, 0.012882515181672233, 0.014907072276853825, 0.012421137024360561, 0.008165989624305182]
dual_qdelay_high_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.588761721800586e-05, 0.0008119641457457944, 0.0008846196294007136, 0.0006640535012031682, 0.0006645319291013255, 0.0006964135123412291, 0.0015105728600675493, 0.001213005297325235, 0.0021751830903630285, 0.0019841975721145177, 0.0023202523385602706, 0.0031288034073802397, 0.0017062352550212849, 0.002737913654278539, 0.0038660653345248502, 0.001907333142480484, 0.0006495246132980119, 0.0030200760614013853, 0.005190374958949872, 0.005359763029009347, 0.0038867391323279764, 0.003783279342021042, 0.005755061186000316, 0.0021900752203297988, 0.00611846940327551, 0.005606096028859097]
dual_qdelay_med_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.215702197099624, 0.21495659109828386, 0.21557604060315474, 0.21535775436091403, 0.21638836338911396, 0.21787802482274898, 0.2179927140775223, 0.21802209066787753, 0.21727245640404058, 0.21690307393384065, 0.21828220667643186, 0.21779319933215394, 0.2152517075940979, 0.21885452407799738, 0, 0.21811099521686722, 0.20397362843982342, 0.217013637400242, 0.21802834246355107, 0.21882967236964238, 0.2169263371364453, 0.21841954853004383, 0.2170269122542597, 0.20612463345142779]
dual_qdelay_med_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.781225685331842e-05, 0.0016950176326737754, 0.0016947006369654617, 0.0007478394234762521, 0.001212600747993842, 0.0014667163120365347, 0.0005685699881919474, 0.0017436054473665378, 0.0008868392076572339, 0.004367074737113402, 2.9707778056142682e-05, 0, 0.001321912099623165, 0.02728418011745097, 0.0009234944002484535, 0.0003623418333104452, 0, 0.0010932264741061928, 0, 0, 0.03430388610758932]
dual_qdelay_low_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.20873505196195263, 0.21408757995676567, 0.21400461553610436, 0.16563531641606077, 0.20879174818578145, 0.19358849411016227, 0.2096041475605941, 0.22633342514450933, 0.17452547009161362, 0.21018964734719078, 0.21951471114177706, 0.16790599341745102, 0.12225761289848988, 0.228567864696014, 0.20700854189178364, 0.2279881643323749, 0.1959927182556727, 0.22599953049800306, 0.22291992631843355, 0, 0.22950728163826942, 0.21707261506473804]
dual_qdelay_low_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004816537452205044, 0.00876408207404599, 0.04298399968103644, 0.027025838814868856, 0.028268503766001766, 0.027985664007534626, 0.0030332649944403733, 0, 0.02951252190867415, 0.008332161457567358, 0, 0, 0, 0.032636360369312056, 0.0010737935776907325, 0.03396128383176914, 0, 0.0017628870691024474, 0, 0, 0.011949870046046708]
if ch==2:
    waa_load_total_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11015840000.0, 11667188571.428572, 12380384000.0, 13158358709.67742, 13881073230.76923, 14642430909.09091, 15365855632.183908, 16159744680.851065, 16895396781.609196, 17677365797.101448, 18474295172.41379, 19221647659.574467, 19950520000.0, 20774480000.0, 21590257297.2973, 22290220000.0, 23075166666.666668, 23757593600.0, 24662049523.809525, 25240676923.076923, 25988406153.846153, 26804933333.333332, 27629902222.22222, 28305480000.0, 29072640000.0, 34433381818.181816]
    waa_load_total_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 75801846.94319789, 225992862.2037275, 226165084.24894708, 227049368.55724177, 204674994.51193723, 217384659.99045116, 232675152.27818608, 214649735.8799631, 224237796.30527744, 221421360.28267196, 217152846.14025176, 230695047.59212705, 197595815.61595926, 209828166.2270874, 253176422.37785107, 227905658.3537965, 216918641.58404335, 236136929.67711198, 244552395.6635099, 148038296.3619333, 188124277.96266583, 232212987.29112172, 201123777.91908258, 115505274.81068088, 233474925.42026863, 5251324489.5774975]
    waa_load_high_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7889920000.0, 7982994285.714286, 7965798400.0, 7976340645.16129, 8009097846.153846, 7985541818.181818, 7987023448.275862, 7987091063.829787, 7972840459.770115, 7999777391.304348, 7988303448.275862, 8029848510.638298, 7986666666.666667, 8020869565.217391, 8014114594.594595, 8020480000.0, 7941226666.666667, 8033689600.0, 8027062857.142858, 8019495384.615385, 8029144615.384615, 7958186666.666667, 8097280000.0, 8047146666.666667, 7925120000.0, 7980450909.090909]
    waa_load_high_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18101933.59837562, 151879121.8605864, 132236824.16029206, 161877880.82754323, 147562011.0378632, 136346560.861377, 150170605.930873, 136476675.50114688, 122860374.44631398, 133101710.33121486, 114298840.57295525, 152974752.09382874, 153092570.8181697, 154009970.10953575, 153863621.62271777, 163361883.0260182, 111642646.46695244, 170961366.8951751, 171050478.8985654, 145235497.53276485, 102573391.66140056, 113977992.72959086, 108490854.9141355, 155084062.91330186, 109280819.90907645, 111106788.4023785]
    waa_load_med_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3125920000.0, 3684194285.714286, 4245740800.0, 5100322580.645162, 5609772307.692307, 6160807272.727273, 6577588965.5172415, 7090035744.680851, 6861526436.78161, 7001224347.826087, 7202140689.655172, 7176844255.319149, 7209770000.0, 6827346086.956522, 7367009729.72973, 6553845000.0, 6929053333.333333, 7287097600.0, 7090331428.571428, 7893083076.923077, 7137476923.076923, 7326693333.333333, 7297564444.444445, 7254693333.333333, 7993280000.0, 7702618181.818182]
    waa_load_med_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 57699913.34482228, 290303364.66197896, 456469999.4698447, 347715452.0766991, 776133229.958719, 948710757.2641929, 1017269400.3831503, 1376936200.12552, 1615377047.1964893, 1672175789.8754318, 1574049070.2396553, 1624247737.009813, 1475764459.104991, 1506880214.7475696, 1439044986.9396148, 1332817043.2922602, 1370050383.4171388, 1345020135.7640214, 1195977580.0669749, 1344395959.3772006, 1863022600.575852, 1311336091.2087588, 1743632316.7966857, 2032042804.225851, 2205275540.3955007, 1520365910.100711]
    waa_load_low_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 168844800.0, 81695483.87096775, 262203076.92307693, 496081818.1818182, 801243218.3908046, 1082617872.3404255, 2061029885.0574713, 2676364057.9710145, 3283851034.4827585, 4014954893.617021, 4754083333.333333, 5926264347.826087, 6209132972.972973, 7715895000.0, 8204886666.666667, 8436806400.0, 9544655238.095238, 9328098461.538462, 10821784615.384615, 11520053333.333334, 12235057777.777779, 13003640000.0, 13154240000.0, 18750312727.272728]
    waa_load_low_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 445970791.31859446, 281415828.68596417, 698955232.196873, 946837550.4095842, 1015403826.3179578, 1370587209.248125, 1686110309.4727972, 1668503173.1697152, 1671019392.822353, 1653404507.7773845, 1550528573.1074727, 1523806910.26368, 1461835001.1788168, 1284063624.8229868, 1413967831.6575377, 1418625766.1873574, 1280073164.8137112, 1288490362.2058785, 1899795557.1087792, 1092846521.6061523, 1630692033.5993688, 2103278287.972028, 2219332625.693289, 5534357628.916099]
    waa_thru_total_bps_avg=[6901120000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9857520000.0, 9825211428.571428, 9834169600.0, 9828614193.548388, 9827293538.461538, 9830974545.454546, 9832090114.94253, 9832044255.319149, 9827900689.655172, 9832296811.594202, 9826720000.0, 9833613617.021276, 9828003333.333334, 9826657391.304348, 9829448648.64865, 9825965000.0, 9828086666.666666, 9831641600.0, 9825295238.095238, 9843544615.384615, 9830264615.384615, 9854080000.0, 9839715555.555555, 9827906666.666666, 9813720000.0, 9816130909.09091]
    waa_thru_total_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26134666.632654797, 17491099.65190774, 27813630.423469234, 25937677.736994002, 24714738.797854085, 26267422.01970206, 26319400.02029862, 26480184.820902687, 22515122.65913856, 27737421.234559514, 23953864.428367954, 27560512.744136382, 29655556.64148478, 28364820.34216819, 32254034.90367628, 31921380.437447533, 26566787.154455557, 27211067.552254055, 25683758.21780131, 36720136.30498136, 17425418.51022265, 25935205.416576132, 31452697.464252215, 25933685.126538116, 26379588.06855533, 77736912.39746347]
    waa_thru_high_bps_avg=[186880000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8023040000.0, 7992868571.428572, 7971532800.0, 7965976774.193548, 8011500307.692307, 7990574545.454545, 7976371494.252873, 7985811063.829787, 7984228045.977012, 8007494492.753623, 7972193103.448276, 7996840851.063829, 7978826666.666667, 8043798260.869565, 7995156756.756757, 8022560000.0, 7979626666.666667, 8025088000.0, 8017554285.714286, 8009649230.769231, 8097083076.923077, 7967146666.666667, 8114346666.666667, 7966293333.333333, 8056320000.0, 8003956363.636364]
    waa_thru_high_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 152056242.22635517, 212713992.6993753, 144480043.706158, 242326789.739577, 203987449.6290246, 172519325.28703028, 191266598.49253356, 161750837.23815218, 163058075.3285722, 171105560.80914626, 188430698.60339782, 210886403.4604349, 206771608.95418778, 184132035.13064384, 166191769.9201413, 163034714.53017446, 194851924.39537185, 207360000.0, 197890294.5718013, 139772850.15705174, 102023101.25527252, 218854797.7693582, 113653621.14776634, 180141182.07336122, 156222938.13649774, 245795633.78029022]
    waa_thru_med_bps_avg=[5282400000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 791280000.0, 968011428.5714285, 1013894400.0, 1011633548.3870968, 1031933538.4615384, 991834545.4545455, 1033758160.9195403, 1037157446.8085107, 979078620.6896552, 1044660869.5652174, 1081897931.0344827, 1025855319.1489362, 1087553333.3333333, 1049606956.5217391, 954901621.6216216, 1008805000.0, 1099013333.3333333, 1006572800.0, 1035009523.8095238, 956123076.9230769, 867704615.3846154, 1031840000.0, 1032177777.7777778, 1092306666.6666667, 1111320000.0, 1030734545.4545455]
    waa_thru_med_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26360940.802634493, 189589436.53050938, 218746980.43782607, 228146455.1417793, 243894252.31818432, 221870729.116915, 239538984.80850685, 255142002.43034035, 263213479.78829166, 261947648.70855135, 269998708.0590184, 268904461.3988805, 292153771.1499941, 236056225.212644, 232075749.05038506, 239079112.34838212, 267350904.1896333, 241489528.47414866, 253810847.96509764, 257970839.9343039, 258957045.36387834, 283410507.0741027, 235653663.76198027, 267431664.04398215, 233976368.037458, 187286659.6617942]
    waa_thru_low_bps_avg=[1431840000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1043200000.0, 864331428.5714285, 848742400.0, 851003870.967742, 783859692.3076923, 848565454.5454545, 821960459.7701149, 809075744.6808511, 864594022.9885057, 780141449.2753624, 772628965.5172414, 810917446.8085107, 761623333.3333334, 733252173.9130435, 879390270.2702702, 794600000.0, 749446666.6666666, 799980800.0, 772731428.5714285, 877772307.6923077, 865476923.0769231, 855093333.3333334, 693191111.1111112, 769306666.6666666, 646080000.0, 781440000.0]
    waa_thru_low_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 151829968.05637547, 307909619.2780538, 229802029.0249849, 253944872.88279417, 257689941.6084257, 271284814.94635975, 234260348.86627516, 241732290.38329905, 279280799.5650979, 263358652.7536577, 268325529.21868992, 242287896.50607705, 301743077.50583947, 224721885.1816919, 246316169.97589013, 238594549.75793883, 223654986.3685946, 294168228.7671461, 219844410.85198674, 198119602.51970047, 259063175.02958667, 195466249.02183667, 258731689.42190114, 297523038.5986431, 186844060.47111407, 278540654.1243127]
    waa_drop_total_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2706880000.0, 3061954285.714286, 3375136000.0, 4242949677.419355, 4727175384.615385, 5494192727.272727, 5879893333.333333, 6634125957.446809, 7235417011.494253, 7514546086.956522, 8138455172.413794, 8793014468.085106, 9657480000.0, 9800177391.304348, 10157478918.918919, 11758350000.0, 12989900000.0, 12239859200.0, 10784899047.619047, 10802203076.923077, 12861636923.076923, 14724533333.333334, 12160088888.88889, 15443546666.666666, 14784560000.0, 11288901818.181818]
    waa_drop_total_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25342707.037725862, 403292239.4056637, 562066081.998668, 377557051.8737087, 690380474.944516, 657838564.2874252, 975401547.874976, 1126656530.8133364, 1507565750.3144588, 1640533692.6145651, 2111864937.4254887, 2418528778.582054, 1504901859.979651, 2494957635.8464684, 3463720092.2384844, 2151415439.3733892, 1550026257.1464646, 3245170944.05662, 5846031944.731319, 6536672449.179048, 4461916089.528102, 4606574684.7507715, 7218520695.039331, 3107036774.1667047, 6906254172.907336, 7988212097.501941]
    waa_drop_high_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_high_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_med_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2706880000.0, 3061954285.714286, 3305888000.0, 4192291612.903226, 4569248000.0, 5145261818.181818, 5385272643.678161, 5878897021.276596, 5638311724.137931, 5878504347.826087, 5845064827.586206, 5811748085.106383, 5885240000.0, 5336699130.434783, 5726918918.918919, 5234400000.0, 5935080000.0, 5770067200.0, 4823626666.666667, 4993513846.153846, 4587495384.615385, 5173333333.333333, 4763591111.111111, 5471920000.0, 4385480000.0, 1943621818.1818182]
    waa_drop_med_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25342707.037725862, 403292239.4056637, 628543642.3988394, 432761539.3587739, 822645681.7852993, 967909683.3882055, 1209823937.166315, 1696721269.469621, 2002905602.5232656, 1861172865.3439429, 1967388182.1884775, 2158237416.958407, 1727373343.1094468, 2061981921.2094908, 2459172814.8299785, 1839765518.4113772, 1426917125.6030009, 2355414961.6212707, 2683988544.992943, 3078019816.173862, 3046240625.9754972, 2863141627.1967173, 3092525366.090165, 2526195040.3359957, 3316788485.267036, 3210090631.511261]
    waa_drop_low_bps_avg=[0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 69248000.0, 50658064.51612903, 157927384.6153846, 348930909.09090906, 494620689.6551724, 755228936.1702127, 1597105287.3563218, 1636041739.1304348, 2293390344.827586, 2981266382.9787235, 3772240000.0, 4463478260.869565, 4430560000.0, 6523950000.0, 7054820000.0, 6469792000.0, 5961272380.952381, 5808689230.769231, 8274141538.461538, 9551200000.0, 7396497777.777778, 9971626666.666666, 10399080000.0, 9345280000.0]
    waa_drop_low_bps_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 280617422.12485665, 216923146.64482176, 551032675.9318501, 813147305.8497201, 815138970.8963358, 1112275141.9398668, 1577147379.8807585, 1677665219.894598, 1914886033.2034838, 1857942009.43389, 2006337997.6167653, 2630150126.3170886, 2498382131.647065, 2349406248.0110903, 1989809019.9466052, 2693599019.502841, 4050987993.339285, 4261156491.975822, 3876065225.4785523, 2723986020.522132, 4545645807.1922455, 3505560984.195704, 4944906449.590325, 5663413918.604219]
    waa_drop_prob_total_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.24573988759112197, 0.26239174339941745, 0.2727515677117527, 0.32235565142682876, 0.340419333281402, 0.3749979500475587, 0.38263431148628346, 0.41052601739148736, 0.4282571032113705, 0.4249688484401639, 0.4404143551405544, 0.4574970154213516, 0.48419702388182945, 0.4720027490812164, 0.4702370461046402, 0.5276753514142243, 0.5629172014967225, 0.5150063142680679, 0.4372050614212214, 0.4277001665168238, 0.495489923537997, 0.5489548157277183, 0.4394261787381572, 0.5456126277692003, 0.5097407588583632, 0.3549289932143695]
    waa_drop_prob_total_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0039915471162205235, 0.03356387784642855, 0.04561018507092997, 0.027138978165864212, 0.0487247706902124, 0.042527250563972795, 0.0628858312132094, 0.06900803896041467, 0.08895595144042223, 0.09178310398077151, 0.11359403958404898, 0.12574060983204904, 0.07584399218378314, 0.12094374681915808, 0.16061367553525693, 0.097072359605841, 0.06688678810065643, 0.1357459977040144, 0.2362760336329108, 0.2584751638503584, 0.17292311112710756, 0.17132788877092345, 0.2606297422578564, 0.10990542576613786, 0.23922931591962804, 0.25772799376326305]
    waa_drop_prob_high_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_prob_high_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_prob_med_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.8661690490970213, 0.8320024498575572, 0.7787013090240978, 0.8221285424622631, 0.8136816467707225, 0.8334139195342162, 0.8165822638971139, 0.8202288021354717, 0.8094955603254337, 0.8265632955502159, 0.8042745176679537, 0.7970884556090366, 0.8044901239423714, 0.7699686022343138, 0.7671396308659049, 0.7994377230186671, 0.8505874188670587, 0.7715683886610039, 0.6734019660288892, 0.650576671841137, 0.605026780890689, 0.6866452132353823, 0.6469833880236359, 0.7693595391961483, 0.5957691315487218, 0.24125678379609608]
    waa_drop_prob_med_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.024095493842641844, 0.09855021110875346, 0.12307258580048577, 0.06730418232512031, 0.09088876521352154, 0.08113916031191852, 0.1269187605866494, 0.16130818204355152, 0.19033882459172052, 0.1501945411525219, 0.17036716925559953, 0.21865015664686077, 0.1589051003337284, 0.22920837619394493, 0.27584334662358084, 0.21470750888479762, 0.06635852834219047, 0.2712034424531149, 0.34398802343439283, 0.373605544559836, 0.36371736924940823, 0.33898529879445743, 0.3712394393181908, 0.2505678174791385, 0.39889178088152927, 0.39335310384222005]
    waa_drop_prob_low_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.04291883167751587, 0.04646472665623738, 0.14698439379959022, 0.24091386739017723, 0.30297635797047706, 0.31283289288237603, 0.5583480005429826, 0.521186935642276, 0.5981657435691642, 0.6971978892394625, 0.7859181388670587, 0.7322869914494795, 0.7006137825872839, 0.8335120745773734, 0.8552831986922577, 0.7647426324987252, 0.6162864130015984, 0.5956901515252884, 0.7674023836776778, 0.8306636755480014, 0.6098605064506093, 0.7678918471120632, 0.7656428506884292, 0.5763597609989338]
    waa_drop_prob_low_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.16398495943913136, 0.18519616501578454, 0.33198106638214575, 0.40375364777361417, 0.413954364502638, 0.40944303119573594, 0.44225988807895045, 0.434987935910044, 0.42526876636165484, 0.368285085612076, 0.2997497087294376, 0.3585932562313357, 0.3454898212708739, 0.26040366408070487, 0.18700616842372453, 0.27636611620336204, 0.3920415449950345, 0.4333653194352212, 0.3079211362513395, 0.21932912302920132, 0.37358651735163284, 0.250164328958436, 0.26885412302843203, 0.3642331767282153]
    waa_delay_total_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0011041406796786686, 0.0011178802275783977, 0.0016479222239287746, 0.0015899977289637118, 0.0017798091526979125, 0.0017648609457357122, 0.0019383108765703074, 0.002192306710881069, 0.0020885288520051826, 0.0024419008594881966, 0.0024649134800001364, 0.002460685448131644, 0.0026020924825936806, 0.002913844619668207, 0.002853790385991557, 0.0026302393641699576, 0.0025902393585461535, 0.0033305659551186497, 0.003402381008659784, 0.003976683268250929, 0.003824361334591994, 0.0038656888675973108, 0.0042305975870416245, 0.0035366176098364376, 0.0038586065399143898, 0.005433061707049921]
    waa_delay_total_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5.688956071685524e-05, 0.000523735680997925, 0.0007312247996428514, 0.0006127885396336836, 0.0007438522416436258, 0.0007348260888654899, 0.0008415861172027021, 0.0009615939128550841, 0.0009695527877136664, 0.0010487195396089851, 0.001064172997960659, 0.0011001430391937308, 0.001062655876667625, 0.0014732046955269952, 0.001265484442033178, 0.001512136735094749, 0.0012444890283885338, 0.0016248020773574484, 0.0018171222820166678, 0.001962129047523357, 0.001805491069871252, 0.0022459051323499295, 0.0017667420875654071, 0.0016424797475328191, 0.002617578739685986, 0.0029141321913028536]
    waa_delay_high_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.2003658516065743e-05, 1.3708896678521545e-05, 1.395256508359966e-05, 1.3632659556714919e-05, 1.3635502054342304e-05, 1.3106756133711338e-05, 1.345369137194711e-05, 1.3098353412147116e-05, 1.3798451563770552e-05, 1.3924313007967595e-05, 1.3630488797009294e-05, 1.390811532935947e-05, 1.4348405935273985e-05, 1.4308165800080827e-05, 1.406294807424272e-05, 1.5190237120926727e-05, 1.5325256842239635e-05, 1.4129281974976481e-05, 1.4162849840529023e-05, 1.7659647596829082e-05, 1.4936941504128726e-05, 1.5878635828842057e-05, 1.3742221510460319e-05, 1.3550759582962202e-05, 1.4211916634779534e-05, 1.462632599533721e-05]
    waa_delay_high_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.3460856629778425e-06, 3.6942811540890773e-06, 3.0696628407124537e-06, 3.5990541345038404e-06, 3.6299309601086547e-06, 3.3978432118853125e-06, 3.644136727057518e-06, 3.2231527320794106e-06, 4.7274479891814965e-06, 3.660685172026573e-06, 3.1397114617169843e-06, 4.247686808952332e-06, 4.5458857174900955e-06, 4.203900059745738e-06, 3.927793734175224e-06, 3.5551324944002633e-06, 4.883747742282683e-06, 4.026017141319472e-06, 3.918341860442006e-06, 5.0370505933809576e-06, 2.6497318591555032e-06, 5.398165848195318e-06, 4.455745885045947e-06, 3.0667758279021258e-06, 4.79205098479133e-06, 2.0935143089535784e-06]
    waa_delay_med_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.06648650726106453, 0.05826142628400423, 0.06132334866579949, 0.055974606947183224, 0.05690638835424762, 0.05298810247771177, 0.05402307593122662, 0.056115144551576394, 0.04988083666219454, 0.05581163984386297, 0.05445051135676159, 0.05134796659786483, 0.051676845798790394, 0.05326063738219122, 0.05109408019161305, 0.05195216036261245, 0.057064594074731655, 0.050753551138683246, 0.04814030360397717, 0.04518571936798116, 0.05192404216321455, 0.0558790313831992, 0.04428435787577454, 0.04866982177412826, 0.04387680133909083, 0.03710275218975974]
    waa_delay_med_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004068787229829055, 0.008985356413503561, 0.010760070513987158, 0.014476950802681207, 0.015021659877842106, 0.016023380708300405, 0.016600060807423295, 0.012541186546847403, 0.017215228483180647, 0.014907489872018405, 0.01566322999993813, 0.01896214342074043, 0.01727581851646209, 0.01664158428628405, 0.019200315851745264, 0.01814680580902169, 0.012303330047793435, 0.018841341244665737, 0.02297228584426905, 0.020192760082452473, 0.017109239793402845, 0.012809737418734628, 0.023782477848831144, 0.021924214152072085, 0.021269146218383765, 0.021518317604654485]
    waa_delay_low_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.05355625323308448, 0.06354189578792432, 0.05652395849960711, 0.05318340957087458, 0.05275311380137358, 0.05791536464780692, 0.050945701843506386, 0.05423863084446547, 0.05402616457791466, 0.054943791899472516, 0.05250294113091015, 0.05405733895795047, 0.05060679360184329, 0.053896180716689515, 0.062107301083236664, 0.055362112206007966, 0.04621531490007774, 0.055886201535597535, 0.05079983886489045, 0.06741841865975086, 0.04937062188067002, 0.04485628121946426, 0.05710646494263399, 0.0495215481571472]
    waa_delay_low_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.026638052719884474, 0.012657760243629213, 0.020195355666798604, 0.021135106265397833, 0.02160453356355412, 0.022210864643135427, 0.02248181076307694, 0.02073628562960466, 0.018763841318315887, 0.020767678264804156, 0.019818810617132657, 0.020522933655512554, 0.021822680403798023, 0.023830548760662214, 0.018520532842202817, 0.019253327950977412, 0.025585748117719635, 0.019101246482185967, 0.019352507991832284, 0.01287817550016972, 0.022928962809385982, 0.02093529769427637, 0.030849836957797454, 0.021918242989623082]
    waa_qdelay_total_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0011039842122620351, 0.0011177215739794025, 0.0016477593021841377, 0.001589836163617031, 0.0017796454965262793, 0.0017646972017898584, 0.0019381434709413534, 0.0021921391419784542, 0.002088360007335916, 0.0024417266789059687, 0.002464737697192897, 0.002460509577651261, 0.0026019172312039098, 0.0029136630927488355, 0.002853604835132911, 0.002630062212141852, 0.002590065434301306, 0.0033303796911250297, 0.003402173182928723, 0.003976469949701717, 0.0038241597006320664, 0.003865495598778612, 0.0042303773963601726, 0.0035364181184429416, 0.003858394161525086, 0.0054327785741197735]
    waa_qdelay_total_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5.6890611503639255e-05, 0.0005237325924380042, 0.000731220636324277, 0.0006127863036267091, 0.0007438480957340114, 0.0007348225453822296, 0.0008415814511488447, 0.0009615866407841087, 0.0009695452976281104, 0.0010487106210401403, 0.001064161701526185, 0.0011001309662602087, 0.0010626474016339502, 0.0014731874305664253, 0.0012654707331573739, 0.001512122076989641, 0.0012444804322919874, 0.001624780466322092, 0.0018171066862575258, 0.0019620789060075606, 0.001805466652813636, 0.002245864492794099, 0.0017667210246962545, 0.001642455256782528, 0.0026175247067143467, 0.002914116192233248]
    waa_qdelay_high_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.1850855640030328e-05, 1.355609539783339e-05, 1.3799763889471e-05, 1.3479858115779283e-05, 1.3482700468207139e-05, 1.2953953100453127e-05, 1.3300887645523815e-05, 1.2945550768083986e-05, 1.3645649103332442e-05, 1.377150864994186e-05, 1.3477686937503984e-05, 1.3755314247654397e-05, 1.419560399445054e-05, 1.415536304846237e-05, 1.3910147928608735e-05, 1.5037433722486772e-05, 1.5172454433179043e-05, 1.3976482110872045e-05, 1.4010045569411786e-05, 1.7506847244277595e-05, 1.47841408588042e-05, 1.572583394083397e-05, 1.3589422556505914e-05, 1.3397962357004642e-05, 1.405911667422194e-05, 1.4473527438045715e-05]
    waa_qdelay_high_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.346108241444879e-06, 3.6942839470182483e-06, 3.0696622126486665e-06, 3.5990547582783244e-06, 3.6299305881302522e-06, 3.3978429628121827e-06, 3.644136739549765e-06, 3.223152265961586e-06, 4.727446635877728e-06, 3.6606850589115156e-06, 3.139710192734359e-06, 4.247686396289554e-06, 4.545882385286353e-06, 4.203899883646461e-06, 3.927790311619959e-06, 3.555131620945953e-06, 4.883750646361819e-06, 4.0260134742030385e-06, 3.918341115950241e-06, 5.037050157977856e-06, 2.649733294753327e-06, 5.3981624808149e-06, 4.455742706472306e-06, 3.0667718062614117e-06, 4.792045456696052e-06, 2.0935159927445355e-06]
    waa_qdelay_med_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.06648613182511709, 0.05826097894796711, 0.061322840515499175, 0.055974150474058876, 0.05690591944026044, 0.05298764462474403, 0.05402258812609003, 0.05611467189553028, 0.049880393985419096, 0.05581115850485152, 0.05445001504606264, 0.05134748927288357, 0.05167638582679064, 0.05326013304353325, 0.051093620014895556, 0.051951703757263525, 0.05706411855157965, 0.05075307966530203, 0.0481397760279447, 0.04518512257558812, 0.051923466451509734, 0.05587847201112625, 0.04428382374915732, 0.04866938105546401, 0.04387618439881632, 0.03710198359794264]
    waa_qdelay_med_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004068847310055141, 0.008985319870700467, 0.010760068392064987, 0.014476930055582298, 0.015021659231560713, 0.016023353901968587, 0.01660004408479073, 0.012541179440792178, 0.017215228825182838, 0.014907508276886213, 0.015663236219778248, 0.018962158057939334, 0.017275798200222393, 0.016641581133286544, 0.019200389670738716, 0.01814681341081449, 0.012303337953692293, 0.01884137849450593, 0.022972385095106743, 0.020192822101719764, 0.01710928085460363, 0.012809866877294174, 0.0237825862666908, 0.021924205245526036, 0.021269277728096933, 0.021518423485428415]
    waa_qdelay_low_avg=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.05355524557527157, 0.06354095381190247, 0.056523185832069216, 0.05318271459506271, 0.05275227524076738, 0.057914509907419885, 0.05094497634627764, 0.054237845846553535, 0.05402542795384436, 0.054943047397919546, 0.052502247400296374, 0.05405664710194783, 0.050606092018236674, 0.05389545917857179, 0.06210656167958935, 0.05536140527734334, 0.046214573719307275, 0.05588545803999014, 0.05079907097950177, 0.0674175322503696, 0.04936979739830315, 0.04485555181728997, 0.05710577640757293, 0.049520671188775685]
    waa_qdelay_low_err=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.02663790235258096, 0.012657919748594397, 0.02019515668815375, 0.021135192365674724, 0.021604637641307222, 0.02221092542957033, 0.022481782270472848, 0.020736350903719322, 0.018763897203653745, 0.020767764476144368, 0.019818812465581696, 0.020522994059938907, 0.02182276893352156, 0.023830600675941584, 0.01852053401110993, 0.019253333156720415, 0.025585897391085986, 0.019101403175067873, 0.019352613397201963, 0.012877838874411926, 0.022929063220949134, 0.020935364364046197, 0.030850140303839105, 0.02191841417062217]
else:
    waa_load_total_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11015840000.0, 11667188571.428572,
                              12380384000.0, 13158358709.67742, 13881073230.76923, 14642430909.09091,
                              15365914482.758621, 16159744680.851065, 16895396781.609196, 17677365797.101448,
                              18474295172.41379, 19221647659.574467, 19950520000.0, 20774480000.0, 21590257297.2973,
                              22290220000.0, 23075166666.666668, 23757593600.0, 24662049523.809525, 25240676923.076923,
                              25988406153.846153, 26804933333.333332, 27629902222.22222, 28305480000.0, 29072640000.0,
                              34433381818.181816]
    waa_load_total_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 75801846.94319789, 225992862.2037275,
                              226165084.24894708, 227049368.55724177, 204674994.51193723, 217384659.99045116,
                              232758744.4602124, 214649735.8799631, 224237796.30527744, 221421360.28267196,
                              217152846.14025176, 230695047.59212705, 197595815.61595926, 209828166.2270874,
                              253176422.37785107, 227905658.3537965, 216918641.58404335, 236136929.67711198,
                              244552395.6635099, 148038296.3619333, 188124277.96266583, 232212987.29112172,
                              201123777.91908258, 115505274.81068088, 233474925.42026863, 5251324489.5774975]
    waa_load_high_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7889920000.0, 7982994285.714286, 7965798400.0,
                             7976340645.16129, 8009097846.153846, 7985541818.181818, 7987023448.275862,
                             7987091063.829787, 7972840459.770115, 7999777391.304348, 7988303448.275862,
                             8029848510.638298, 7986666666.666667, 8020869565.217391, 8014114594.594595, 8020480000.0,
                             7941226666.666667, 8033689600.0, 8027062857.142858, 8019495384.615385, 8029144615.384615,
                             7958186666.666667, 8097280000.0, 8047146666.666667, 7925120000.0, 7980450909.090909]
    waa_load_high_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18101933.59837562, 151879121.8605864,
                             132236824.16029206, 161877880.82754323, 147562011.0378632, 136346560.861377,
                             150170605.930873, 136476675.50114688, 122860374.44631398, 133101710.33121486,
                             114298840.57295525, 152974752.09382874, 153092570.8181697, 154009970.10953575,
                             153863621.62271777, 163361883.0260182, 111642646.46695244, 170961366.8951751,
                             171050478.8985654, 145235497.53276485, 102573391.66140056, 113977992.72959086,
                             108490854.9141355, 155084062.91330186, 109280819.90907645, 111106788.4023785]
    waa_load_med_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3125920000.0, 3684194285.714286, 4245740800.0,
                            5100322580.645162, 5609772307.692307, 6160807272.727273, 6577588965.5172415,
                            7090035744.680851, 6861526436.78161, 7001224347.826087, 7202140689.655172,
                            7176844255.319149, 7209770000.0, 6827346086.956522, 7367009729.72973, 6553845000.0,
                            6929053333.333333, 7287097600.0, 7090331428.571428, 7893083076.923077, 7137476923.076923,
                            7326693333.333333, 7297564444.444445, 7254693333.333333, 7993280000.0, 7702618181.818182]
    waa_load_med_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 57699913.34482228, 290303364.66197896,
                            456469999.4698447, 347715452.0766991, 776133229.958719, 948710757.2641929,
                            1017269400.3831503, 1376936200.12552, 1615377047.1964893, 1672175789.8754318,
                            1574049070.2396553, 1624247737.009813, 1475764459.104991, 1506880214.7475696,
                            1439044986.9396148, 1332817043.2922602, 1370050383.4171388, 1345020135.7640214,
                            1195977580.0669749, 1344395959.3772006, 1863022600.575852, 1311336091.2087588,
                            1743632316.7966857, 2032042804.225851, 2205275540.3955007, 1520365910.100711]
    waa_load_low_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 168844800.0, 81695483.87096775,
                            262203076.92307693, 496081818.1818182, 801302068.9655173, 1082617872.3404255,
                            2061029885.0574713, 2676364057.9710145, 3283851034.4827585, 4014954893.617021,
                            4754083333.333333, 5926264347.826087, 6209132972.972973, 7715895000.0, 8204886666.666667,
                            8436806400.0, 9544655238.095238, 9328098461.538462, 10821784615.384615, 11520053333.333334,
                            12235057777.777779, 13003640000.0, 13154240000.0, 18750312727.272728]
    waa_load_low_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 445970791.31859446, 281415828.68596417,
                            698955232.196873, 946837550.4095842, 1015585596.9880743, 1370587209.248125,
                            1686110309.4727972, 1668503173.1697152, 1671019392.822353, 1653404507.7773845,
                            1550528573.1074727, 1523806910.26368, 1461835001.1788168, 1284063624.8229868,
                            1413967831.6575377, 1418625766.1873574, 1280073164.8137112, 1288490362.2058785,
                            1899795557.1087792, 1092846521.6061523, 1630692033.5993688, 2103278287.972028,
                            2219332625.693289, 5534357628.916099]
    waa_thru_total_bps_avg = [9886560000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9844960000.0, 9842068571.428572,
                              9840844800.0, 9841264516.129032, 9838830769.23077, 9842276363.636364, 9842328275.862068,
                              9841700425.531916, 9840788965.51724, 9836960000.0, 9839920000.0, 9837593191.48936,
                              9840983333.333334, 9840340869.565218, 9842391351.35135, 9841445000.0, 9844780000.0,
                              9837625600.0, 9843436190.47619, 9840123076.923077, 9832196923.076923, 9841093333.333334,
                              9834008888.88889, 9838373333.333334, 9842640000.0, 9832523636.363636]
    waa_thru_total_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 11576351.794892935, 10733774.235250773,
                              17894893.64635872, 19306391.129922196, 22506161.924146548, 17005743.64031825,
                              20342725.20175652, 18628275.272152174, 21279080.03318808, 19907756.400767032,
                              14641870.441571053, 19709798.981382962, 19727641.952469405, 24019013.089421257,
                              15822628.956553781, 13593353.874788128, 21000250.41120542, 12858627.639134152,
                              11377292.724703437, 22620925.189086683, 15596649.21278499, 21624743.029943988,
                              21501873.632243533, 1886372.1796082554, 41777289.3502504]
    waa_thru_high_bps_avg = [197120000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7946240000.0, 7987382857.142858,
                             7966617600.0, 8002766451.612904, 7996100923.076923, 7967243636.363636, 7997498850.574713,
                             7989133617.021276, 7985993563.21839, 7994805797.101449, 7980314482.75862,
                             8005446808.510638, 7986880000.0, 8026100869.565217, 8042274594.594595, 8014800000.0,
                             7934080000.0, 8041472000.0, 8035718095.238095, 7978141538.461538, 8051987692.307693,
                             8003413333.333333, 8081066666.666667, 8003840000.0, 7997440000.0, 7914821818.181818]
    waa_thru_high_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 43444640.63610148, 229480205.52908334,
                             187646253.74357998, 235728967.14476344, 192629425.7256264, 186321964.39016813,
                             207559814.88911334, 161930240.0766843, 182624903.8646549, 178030724.28496385,
                             192749295.720127, 201121480.282185, 218517694.4196238, 223328676.84524813,
                             194346195.15177026, 177570155.00468287, 146069793.44314054, 207899216.609074,
                             186274923.90601176, 167230307.15384468, 96504329.96795586, 232690716.1591684,
                             122913328.81343667, 193520668.94544083, 104574250.49536175, 211382506.26852646]
    waa_thru_med_bps_avg = [4889600000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1212400000.0, 1043851428.5714285,
                            1010867200.0, 1053003870.967742, 1051232000.0, 1078890909.090909, 1048292413.7931035,
                            1048098723.4042553, 1036513103.4482758, 1087257971.0144928, 1124411034.4827585,
                            1036616170.2127659, 1127303333.3333333, 1085179130.4347825, 992908108.1081082, 1069920000.0,
                            1201240000.0, 1020595200.0, 1108487619.047619, 1028110769.2307693, 1084258461.5384614,
                            877946666.6666666, 1038488888.8888888, 1162453333.3333333, 956200000.0, 1157280000.0]
    waa_thru_med_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 138140380.77260393, 270994604.96637034,
                            282475521.2332566, 290169773.591395, 240659361.25569683, 286172819.2095407,
                            282072855.8573967, 252960363.0272318, 272246417.6684055, 278876808.69020724,
                            267781358.2907404, 270894229.0183544, 267399554.45890835, 283810739.0327895,
                            272574830.64123714, 235643466.93612665, 319813574.39173436, 261120949.83487377,
                            202606721.15960917, 249457954.3216832, 194237633.5765958, 337837996.3631484,
                            287584757.43876123, 310746643.05459034, 431559446.9672361, 257375852.79120496]
    waa_thru_low_bps_avg = [4799840000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 686320000.0, 810834285.7142857,
                            863360000.0, 785494193.548387, 791497846.1538461, 796141818.1818181, 796537011.4942529,
                            804468085.106383, 818282298.8505747, 754896231.884058, 735194482.7586207, 795530212.7659575,
                            726800000.0, 729060869.5652174, 807208648.6486486, 756725000.0, 709460000.0, 775558400.0,
                            699230476.1904762, 833870769.2307693, 695950769.2307693, 959733333.3333334,
                            714453333.3333334, 672080000.0, 889000000.0, 760421818.1818181]
    waa_thru_low_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94695740.13650244, 327007124.21583736,
                            318137248.3693162, 298964061.5363702, 279524103.9723381, 295853798.1843473,
                            273504220.3922278, 249817404.3424973, 265431961.9285863, 283161353.48793966,
                            233840016.97946364, 251250754.00699633, 295211628.67022645, 310404351.60055405,
                            268795028.9115622, 238609245.20389858, 283921122.9105411, 191809490.37347797,
                            254159275.3860498, 220806061.60390082, 246497983.8477906, 214779429.43090865,
                            315557766.5024266, 294678638.89020157, 341519450.3001745, 203474098.88328204]
    waa_drop_total_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2457360000.0, 3100788571.428571, 3374227200.0,
                              4197207741.935484, 4717516307.692307, 5396660000.0, 5972082758.620689, 6588871489.361702,
                              7183492413.793103, 7496486956.521739, 8258893793.103448, 8784765957.446808,
                              9621583333.333334, 9753492173.913044, 10081478918.918919, 11735390000.0,
                              12901153333.333334, 12370028800.0, 10947093333.333334, 10851840000.0, 12477440000.0,
                              14941360000.0, 12424871111.11111, 15437106666.666666, 14515480000.0, 11281687272.727272]
    waa_drop_total_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 230233967.95433986, 372493139.9442069,
                              615095399.7248448, 425876856.7548696, 655278740.1451033, 725667031.6146475,
                              961108880.1528059, 1083740341.6800792, 1450508704.3925397, 1612536724.8780124,
                              2090075425.9476552, 2445072756.452524, 1504435683.1112587, 2484893769.8965573,
                              3410437445.6005425, 2114812741.0612125, 1444885464.8354497, 3256937242.574584,
                              5917663557.389296, 6545690758.598362, 4483391614.272986, 4193033432.005998,
                              7332450133.530478, 3370266206.063452, 7946901066.117953, 7767695076.977586]
    waa_drop_high_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                             0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_high_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                             0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_med_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2457360000.0, 3100788571.428571, 3304569600.0,
                            4149329032.2580647, 4544167384.615385, 5048003636.363636, 5454190344.827586,
                            5794738723.404255, 5558662988.505747, 5833131594.202899, 5880477241.379311,
                            5820040851.063829, 5824770000.0, 5269036521.73913, 5644644324.324325, 5164200000.0,
                            5787046666.666667, 5760268800.0, 4737653333.333333, 4971815384.615385, 4321661538.461538,
                            5494533333.333333, 4885084444.444445, 5352466666.666667, 4600040000.0, 1877440000.0]
    waa_drop_med_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 230233967.95433986, 372493139.9442069,
                            679453945.584737, 442587599.47482055, 815209467.2810267, 1011528667.6628925,
                            1205717562.1599953, 1702828058.6997406, 1957146567.416223, 1775520074.2794998,
                            1886467885.3886654, 2183848317.705945, 1664683803.4127324, 2026514474.2123303,
                            2445294676.389899, 1916950725.7234373, 1345335272.4997156, 2437048770.2826138,
                            2632833278.104281, 3075256199.865347, 3063220619.0920644, 2919710048.800508,
                            3153189895.9906898, 2583855845.9837193, 3313481014.7637787, 3214147587.5012336]
    waa_drop_low_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 69657600.0, 47878709.67741936,
                            173348923.07692307, 348656363.6363636, 517892413.79310346, 794132765.9574468,
                            1624829425.2873564, 1663355362.3188405, 2378416551.724138, 2964725106.382979,
                            3796813333.3333335, 4484455652.173913, 4436834594.594595, 6571190000.0, 7114106666.666667,
                            6609760000.0, 6209440000.0, 5880024615.384615, 8155778461.538462, 9446826666.666666,
                            7539786666.666667, 10084640000.0, 9915440000.0, 9404247272.727272]
    waa_drop_low_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 273960090.0569278, 216738618.49206468,
                            565233851.0522743, 844331516.2313719, 829489768.8940593, 1152964659.7605598,
                            1592031851.5039685, 1677677686.7694397, 1978717859.4271522, 1805236488.0293353,
                            1954224633.0835037, 2702670714.9383035, 2524363821.254547, 2423452612.121805,
                            1845285870.8816264, 2624258957.9536543, 4081395824.9206853, 4309935224.061988,
                            3926568746.4626718, 2642913504.4088497, 4601367014.268695, 3799536851.239539,
                            5572479394.3569975, 5496446284.699035]
    waa_drop_prob_total_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.22300850610435885, 0.2654648503244832,
                               0.27271380560526093, 0.31889593426336776, 0.33975115892093577, 0.3683993463374429,
                               0.38867529022604863, 0.4077428222984507, 0.4251943492600342, 0.42399539191025404,
                               0.44696465435133376, 0.4570996451081652, 0.4823962150129048, 0.46974657588192054,
                               0.466672942148413, 0.5266027895684496, 0.5591169792632068, 0.5205211806295446,
                               0.44381787417393365, 0.42963583187767523, 0.480731700444197, 0.5572094138274943,
                               0.4489825450906768, 0.5453689766699986, 0.5006721832588964, 0.3540376015863879]
    waa_drop_prob_total_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.019365705321390474, 0.028570714637028188,
                               0.04996171673690912, 0.031078785144050804, 0.046281338328385206, 0.047954639863039855,
                               0.06215409464170942, 0.06649343131238036, 0.0856464520795348, 0.09036824022702791,
                               0.11256002653521728, 0.12722433625467497, 0.0756511330089832, 0.12046557818100008,
                               0.15801092666796487, 0.09524243245439004, 0.0626798076188706, 0.13639071993168098,
                               0.23932448354878305, 0.25874067192383476, 0.17378395531869104, 0.1564684399218071,
                               0.2647131206625698, 0.11905809100832317, 0.27471904360917165, 0.25048025547923075]
    waa_drop_prob_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                              0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_prob_high_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                              0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa_drop_prob_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.7855778301995562, 0.8400508269212925,
                             0.7782762720101014, 0.8146259632096979, 0.8107632345325002, 0.817060455904416,
                             0.8273108416051103, 0.8083152642019572, 0.7991536614980238, 0.8239666032476514,
                             0.8127208864824148, 0.7974348733832665, 0.7978661790017556, 0.7617672944839654,
                             0.7559208613220894, 0.7832587410624988, 0.8310307943760369, 0.7680029114695381,
                             0.6622889880418871, 0.647126330236712, 0.568031446631591, 0.7344964085708559,
                             0.6635151650660683, 0.7478338782472599, 0.6366156430670725, 0.23125959157823642]
    waa_drop_prob_med_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.059152567956381415, 0.05259509650337279,
                             0.13685218308638283, 0.07776987556069095, 0.09381838405846765, 0.09804407135442968,
                             0.1251137873360546, 0.16368574388207932, 0.18554943171779825, 0.13597973380416395,
                             0.16692776736040102, 0.2185891137113745, 0.14811087287337066, 0.22979672368128454,
                             0.27402127118700614, 0.21679118313901816, 0.067903679394475, 0.27976183238941477,
                             0.3378332944999818, 0.37083996612533326, 0.3604302523154164, 0.3617565704368961,
                             0.37812726103321986, 0.24816547431921296, 0.4254350666839389, 0.3946804177744634]
    waa_drop_prob_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0437631805431253, 0.06327660599754911,
                             0.1603392456094517, 0.23263429649674974, 0.3283534634971585, 0.33098168524388644,
                             0.5697645059083478, 0.5322413415801197, 0.6220508854585379, 0.6944988410420609,
                             0.797881725948858, 0.7326405329234472, 0.7009302271250986, 0.8378278583436614,
                             0.8657468132522507, 0.7846693505785816, 0.6436785489537626, 0.6021998464729085,
                             0.7562207599588707, 0.8178824115735465, 0.621823237726187, 0.7735552738321383,
                             0.7247540626209759, 0.5783621346109346]
    waa_drop_prob_low_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.1622920829379284,
                             0.23744568850489733, 0.344985181926955, 0.40106428445142417, 0.4330839533698522,
                             0.42838074830114603, 0.4444832472045629, 0.43825657327175865, 0.427707859556844,
                             0.3602808116104406, 0.2818325735540146, 0.36939280438248834, 0.34968035961595734,
                             0.2668302736907974, 0.1754750728039978, 0.2650371173698647, 0.3988384782748866,
                             0.43632751075648785, 0.31633260023732135, 0.2004103915241232, 0.3792396278163898,
                             0.27143654174132864, 0.3376527413191437, 0.35451065722791086]
    waa_delay_total_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0009632096885471679, 0.001118312985737054,
                           0.001609146317379074, 0.0014980823015185271, 0.0017425299100930303, 0.0017304522145164855,
                           0.001849886573064998, 0.0022133737165374308, 0.002016264635268353, 0.0023801742101100284,
                           0.002267604640935205, 0.0024347058825955237, 0.0025647946800698824, 0.0029035941933323725,
                           0.0027867492911752456, 0.0025278590062343394, 0.002645800354558284, 0.003056530488063297,
                           0.0033285522804969696, 0.003968539736124586, 0.004061478899529079, 0.0039191384497971275,
                           0.003915565998968639, 0.003432319969972904, 0.004040266788974173, 0.005553292418522419]
    waa_delay_total_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0005333826112334863, 0.00046582375257870116,
                           0.0007026572266975035, 0.0006666243433302412, 0.00075509995684327, 0.000798332161125743,
                           0.0008723027588043452, 0.0009084709218684378, 0.0009725522109225295, 0.001072489577528111,
                           0.0010125099343338832, 0.0011789750525756258, 0.0011237285150516186, 0.0015199967290120706,
                           0.001369576017270287, 0.001545890927888062, 0.001267957314154506, 0.001763129735088821,
                           0.0016747620757979783, 0.0022502002151745877, 0.0018272777529293267, 0.0023097196920932694,
                           0.0018695330688699716, 0.001985943512272261, 0.003444786657576325, 0.003000283045979037]
    waa_delay_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0752247974379757e-05, 1.1434768640090247e-05,
                          1.1457929837188936e-05, 1.1869981874154893e-05, 1.182509115746391e-05, 1.141362690693053e-05,
                          1.1758815503137826e-05, 1.1063260852750101e-05, 1.2028124478595487e-05,
                          1.1907848143207838e-05, 1.2379795222039488e-05, 1.1994766318319033e-05,
                          1.1907608914455717e-05, 1.2442674612775522e-05, 1.1859507811633165e-05,
                          1.3507543700711687e-05, 1.3009726567261652e-05, 1.216699246671086e-05, 1.198648599408192e-05,
                          1.513607422716041e-05, 1.3070323243146029e-05, 1.3672101471675728e-05, 1.3894999504457743e-05,
                          1.1483991115623349e-05, 1.3307597677234262e-05, 1.2291131832647465e-05]
    waa_delay_high_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.3341766024003832e-06, 2.9611211695711233e-06,
                          3.1975241686928546e-06, 3.5163720074970937e-06, 4.1595834659767616e-06, 3.895284775580933e-06,
                          3.7693882421190363e-06, 3.6045678898508413e-06, 4.206653512378639e-06, 4.278945018531599e-06,
                          4.0314225195865255e-06, 4.3235983565404426e-06, 4.5444130208394125e-06, 4.007027238523292e-06,
                          3.097479803355745e-06, 5.290191493695402e-06, 4.043105703369538e-06, 4.352123672741052e-06,
                          4.401051065853875e-06, 4.849250129762628e-06, 2.5261423676201445e-06, 6.38510288935921e-06,
                          5.6011944116208845e-06, 4.180814456905145e-06, 7.707621566513112e-06, 2.123577195994976e-06]
    waa_delay_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.06010783826855505, 0.05723695447149782,
                         0.060019627561839435, 0.05447950915169401, 0.054906444174437484, 0.05096535542015186,
                         0.05224758931138546, 0.05504510965921637, 0.04846873834077241, 0.053694149730110406,
                         0.05301183077742161, 0.049532952070043844, 0.04976252703362487, 0.05166361416996546,
                         0.049475289656284754, 0.05013080979544768, 0.055458674007946636, 0.04908815240393771,
                         0.04614105216935998, 0.04300045307563557, 0.04851608648155958, 0.05336858917695485,
                         0.04434992426665305, 0.04645997116658359, 0.041735470744754706, 0.03530004508936358]
    waa_delay_med_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.010094892654393083, 0.008740873246846581,
                         0.011348802589179419, 0.014891112463784035, 0.014573797527093316, 0.01586232215357157,
                         0.016651342623193333, 0.012827609102989664, 0.0175311076972353, 0.01479621285991016,
                         0.015822847411976208, 0.018815732185227654, 0.017114255821790374, 0.01654683880259114,
                         0.019203121912422814, 0.018164072164202533, 0.012100647564704107, 0.01893406358413347,
                         0.02275709203665344, 0.01941888035692568, 0.016197211861617763, 0.013194657285284007,
                         0.02499143452130044, 0.021832906177245898, 0.020502443977105416, 0.021387609876374714]
    waa_delay_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.05770270954618265, 0.061126172439446395,
                         0.05549684967046696, 0.05283343926190254, 0.05356684707701305, 0.058635146213923316,
                         0.05384447654852982, 0.05547522174702002, 0.05444057799643472, 0.051822561912758434,
                         0.05331231491516525, 0.05667526470504065, 0.04820680295494746, 0.05889396108986186,
                         0.06296775637154008, 0.05795083366626025, 0.04693473889774526, 0.06054352386038121,
                         0.05617601521056481, 0.07178009921464162, 0.05042941437659135, 0.048041848494031675,
                         0.06009887069496368, 0.051120190388906195]
    waa_delay_low_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.029131613365635543, 0.013926664940420134,
                         0.024889639768167954, 0.023341697878971952, 0.025127965013750097, 0.02414648005939067,
                         0.024602910802239468, 0.022498555484248933, 0.020625467971687204, 0.02475257355873162,
                         0.02291921188326036, 0.023418741588889153, 0.02395018270404644, 0.02804740850294189,
                         0.02276317274769543, 0.02438822818094786, 0.02725727487809628, 0.023949630922531683,
                         0.023022519521384368, 0.016379249983039714, 0.025895484172719273, 0.026578159895513844,
                         0.03128320616439807, 0.022045508172271217]
    waa_qdelay_total_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0009631046030551395, 0.0011182087083117776,
                            0.0016090396364144284, 0.0014979759725189034, 0.0017424228132987298, 0.0017303445779064497,
                            0.001849778190697377, 0.002213264510529142, 0.002016154659019716, 0.0023800618175474626,
                            0.0022674920693686275, 0.00243459275700446, 0.002564681710796451, 0.0029034779894424882,
                            0.0027866308360873205, 0.0025277450468379242, 0.0026456877215166818, 0.0030564126156328937,
                            0.0033284240289628854, 0.003968408033206936, 0.004061350931251084, 0.003919017643066222,
                            0.003915431848814905, 0.0034321949850650733, 0.004040134717494389, 0.005553125473262345]
    waa_qdelay_total_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0005333818677683239, 0.0004658234290766648,
                            0.0007026550210818146, 0.0006666230610677852, 0.0007550981819743666, 0.000798329938719621,
                            0.0008723004304777359, 0.000908467432506492, 0.000972548590226165, 0.0010724842645277323,
                            0.0010125046472473787, 0.0011789681656149585, 0.001123724715058218, 0.0015199884408715154,
                            0.0013695699954157329, 0.00154588478572856, 0.0012679539418888079, 0.0017631179205693695,
                            0.001674752169134748, 0.0022501761090769, 0.0018272637994093048, 0.002309700821154219,
                            0.001869518176322559, 0.0019859293125165842, 0.003444753905601184, 0.0030002761870322188]
    waa_qdelay_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0650647297537422e-05, 1.1333169029417156e-05,
                           1.1356330613258537e-05, 1.1768382149297873e-05, 1.1723491458465955e-05,
                           1.1312025604035837e-05, 1.1657213224722935e-05, 1.0961659991326002e-05,
                           1.1926523943637497e-05, 1.1806245112364301e-05, 1.2278195654539447e-05,
                           1.189316708816653e-05, 1.1806008403688053e-05, 1.2341073597022085e-05,
                           1.1757909101664172e-05, 1.3405941992997145e-05, 1.290812563719088e-05,
                           1.2065393988330424e-05, 1.1884883489367585e-05, 1.5034473904414665e-05,
                           1.2968723040337677e-05, 1.3570501546789665e-05, 1.3793402859826497e-05,
                           1.1382397312878915e-05, 1.3205998448774601e-05, 1.218953449069034e-05]
    waa_qdelay_high_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.3341972945670743e-06, 2.9611227303762834e-06,
                           3.197526432408457e-06, 3.5163725111640477e-06, 4.1595820190493135e-06, 3.895284400988259e-06,
                           3.7693877645575776e-06, 3.6045682664186478e-06, 4.206651930653221e-06,
                           4.2789452051891655e-06, 4.0314208088193165e-06, 4.323597671511356e-06,
                           4.5444101541596406e-06, 4.007026840652731e-06, 3.0974779987720443e-06, 5.290189453581002e-06,
                           4.043107954468727e-06, 4.352120443237278e-06, 4.4010501473268164e-06, 4.849247676426574e-06,
                           2.526141800806716e-06, 6.385099962302171e-06, 5.601189193255234e-06, 4.180809335488324e-06,
                           7.707616358963272e-06, 2.123580469784323e-06]
    waa_qdelay_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.06010749963028876, 0.0572367006488456,
                          0.06001935096728298, 0.054479236786431275, 0.054906181432550695, 0.0509650872117203,
                          0.05224732948266255, 0.05504484590997058, 0.048468476217861566, 0.05369388331154912,
                          0.05301155222882041, 0.04953269428225243, 0.04976226384819783, 0.05166334568346167,
                          0.049475021859813124, 0.05013053907267633, 0.05545839013658481, 0.049087879513824484,
                          0.04614075479925775, 0.04300012392274741, 0.048515747104061965, 0.05336830032504068,
                          0.04434962992130561, 0.04645970230072198, 0.0417351465929163, 0.035299640429057144]
    waa_qdelay_med_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.010094939694626028, 0.008740883009336993,
                          0.011348795181823244, 0.014891105140809149, 0.014573806401841978, 0.015862313947997714,
                          0.01665133715231369, 0.012827606505378642, 0.017531109899521568, 0.014796211743559664,
                          0.01582285022610165, 0.01881572752396927, 0.01711423875158801, 0.016546863103828066,
                          0.019203145522904596, 0.018164075413231475, 0.012100639119480752, 0.018934082172433787,
                          0.02275713484257815, 0.019418930664651116, 0.01619724829170919, 0.01319474605931171,
                          0.024991483880783157, 0.021832893609185028, 0.020502523368565975, 0.021387675659281853]
    waa_qdelay_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.05770215638368541, 0.06112576043491312,
                          0.05549646810280907, 0.052833039199472694, 0.05356641178399869, 0.05863473175344033,
                          0.05384408551114589, 0.05547478844133951, 0.05444020711454917, 0.05182216584425852,
                          0.0533119147430068, 0.056674895791900305, 0.04820640095645421, 0.05889355030849769,
                          0.06296732010925431, 0.05795046375644165, 0.04693436447322933, 0.060543109587282776,
                          0.05617564189372742, 0.07177969340169285, 0.05042897163102344, 0.04804149815348446,
                          0.0600985091297246, 0.051119690314705236]
    waa_qdelay_low_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.029131544911932303, 0.013926750403047116,
                          0.02488956480345946, 0.023341694120663118, 0.02512802242693145, 0.024146520591982797,
                          0.024602905234458888, 0.02249856586399022, 0.020625528952899506, 0.024752573481453384,
                          0.022919249776420462, 0.023418774120003018, 0.02395020411763153, 0.02804740847903091,
                          0.022763147554305405, 0.02438821262502353, 0.027257325873507748, 0.023949726874663034,
                          0.023022554820729554, 0.01637908666145305, 0.025895515399366038, 0.026578224926721437,
                          0.031283347628314834, 0.022045551550341182]


def plot_thru_total_bps(cutdual,cutwaa):
    print(len(dual_load_total_bps_avg[cutdual:]))
    print(len(dual_thru_total_bps_avg[cutdual:]))
    print(len(dual_thru_total_bps_err[cutdual:]))
    print(len(waa_load_total_bps_avg[cutwaa:]))
    print(len(waa_thru_total_bps_avg[cutwaa:]))
    print(len(waa_thru_total_bps_err[cutwaa:]))
    plt.plot(waa_load_total_bps_avg[cutwaa:], waa_thru_total_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.plot(dual_load_total_bps_avg[cutdual:], dual_thru_total_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Throughput total', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_thru_high_bps(cutdual,cutwaa):
    print(len(dual_load_high_bps_avg[cutdual:]))
    print(len(dual_thru_high_bps_avg[cutdual:]))
    print(len(dual_thru_high_bps_err[cutdual:]))
    print(len(waa_load_high_bps_avg[cutwaa:]))
    print(len(waa_thru_high_bps_avg[cutwaa:]))
    print(len(waa_thru_high_bps_err[cutwaa:]))
    plt.plot(dual_load_high_bps_avg[cutdual:], dual_thru_high_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_high_bps_avg[cutwaa:], waa_thru_high_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Throughput high qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_thru_med_bps(cutdual,cutwaa):
    print(len(dual_load_med_bps_avg[cutdual:]))
    print(len(dual_thru_med_bps_avg[cutdual:]))
    print(len(dual_thru_med_bps_err[cutdual:]))
    print(len(waa_load_med_bps_avg[cutwaa:]))
    print(len(waa_thru_med_bps_avg[cutwaa:]))
    print(len(waa_thru_med_bps_err[cutwaa:]))
    plt.plot(dual_load_med_bps_avg[cutdual:], dual_thru_med_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_med_bps_avg[cutwaa:], waa_thru_med_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Throughput med qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_thru_low_bps(cutdual,cutwaa):
    print(len(dual_load_low_bps_avg[cutdual:]))
    print(len(dual_thru_low_bps_avg[cutdual:]))
    print(len(dual_thru_low_bps_err[cutdual:]))
    print(len(waa_load_low_bps_avg[cutwaa:]))
    print(len(waa_thru_low_bps_avg[cutwaa:]))
    print(len(waa_thru_low_bps_err[cutwaa:]))
    plt.plot(dual_load_low_bps_avg[cutdual:], dual_thru_low_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_low_bps_avg[cutwaa:], waa_thru_low_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Throughput low qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_drop_total_bps(cutdual,cutwaa):
    print(len(dual_load_total_bps_avg[cutdual:]))
    print(len(dual_drop_total_bps_avg[cutdual:]))
    print(len(dual_drop_total_bps_err[cutdual:]))
    print(len(waa_load_total_bps_avg[cutwaa:]))
    print(len(waa_drop_total_bps_avg[cutwaa:]))
    print(len(waa_drop_total_bps_err[cutwaa:]))
    plt.plot(dual_load_total_bps_avg[cutdual:], dual_drop_total_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_total_bps_avg[cutwaa:], waa_drop_total_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Drop rate total', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_drop_high_bps(cutdual,cutwaa):
    print(len(dual_load_high_bps_avg[cutdual:]))
    print(len(dual_drop_high_bps_avg[cutdual:]))
    print(len(dual_drop_high_bps_err[cutdual:]))
    print(len(waa_load_high_bps_avg[cutwaa:]))
    print(len(waa_drop_high_bps_avg[cutwaa:]))
    print(len(waa_drop_high_bps_err[cutwaa:]))
    plt.plot(dual_load_high_bps_avg[cutdual:], dual_drop_high_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_high_bps_avg[cutwaa:], waa_drop_high_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Drop rate high qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_drop_med_bps(cutdual,cutwaa):
    print(len(dual_load_med_bps_avg[cutdual:]))
    print(len(dual_drop_med_bps_avg[cutdual:]))
    print(len(dual_drop_med_bps_err[cutdual:]))
    print(len(waa_load_med_bps_avg[cutwaa:]))
    print(len(waa_drop_med_bps_avg[cutwaa:]))
    print(len(waa_drop_med_bps_err[cutwaa:]))
    plt.plot(dual_load_med_bps_avg[cutdual:], dual_drop_med_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_med_bps_avg[cutwaa:], waa_drop_med_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Drop rate med qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_drop_low_bps(cutdual,cutwaa):
    print(len(dual_load_low_bps_avg[cutdual:]))
    print(len(dual_drop_low_bps_avg[cutdual:]))
    print(len(dual_drop_low_bps_err[cutdual:]))
    print(len(waa_load_low_bps_avg[cutwaa:]))
    print(len(waa_drop_low_bps_avg[cutwaa:]))
    print(len(waa_drop_low_bps_err[cutwaa:]))
    plt.plot(dual_load_low_bps_avg[cutdual:], dual_drop_low_bps_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_low_bps_avg[cutwaa:], waa_drop_low_bps_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Bitrate', fontsize=25)
    plt.title('Drop rate low qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_delay_total(cutdual,cutwaa):
    print(len(dual_load_total_bps_avg[cutdual:]))
    print(len(dual_delay_total_avg[cutdual:]))
    print(len(dual_delay_total_err[cutdual:]))
    print(len(waa_load_total_bps_avg[cutwaa:]))
    print(len(waa_delay_total_avg[cutwaa:]))
    print(len(waa_delay_total_err[cutwaa:]))
    plt.plot(dual_load_total_bps_avg[cutdual:], dual_delay_total_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_total_bps_avg[cutwaa:], waa_delay_total_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Delay total', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_delay_high(cutdual,cutwaa):
    print(len(dual_load_high_bps_avg[cutdual:]))
    print(len(dual_delay_high_avg[cutdual:]))
    print(len(dual_delay_high_err[cutdual:]))
    print(len(waa_load_high_bps_avg[cutwaa:]))
    print(len(waa_delay_high_avg[cutwaa:]))
    print(len(waa_delay_high_err[cutwaa:]))
    plt.plot(dual_load_high_bps_avg[cutdual:], dual_delay_high_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_high_bps_avg[cutwaa:], waa_delay_high_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Delay high qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_delay_med(cutdual,cutwaa):
    print(len(dual_load_med_bps_avg[cutdual:]))
    print(len(dual_delay_med_avg[cutdual:]))
    print(len(dual_delay_med_err[cutdual:]))
    print(len(waa_load_med_bps_avg[cutwaa:]))
    print(len(waa_delay_med_avg[cutwaa:]))
    print(len(waa_delay_med_err[cutwaa:]))
    plt.plot(dual_load_med_bps_avg[cutdual:], dual_delay_med_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_med_bps_avg[cutwaa:], waa_delay_med_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Delay med qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_delay_low(cutdual,cutwaa):
    print(len(dual_load_low_bps_avg[cutdual:]))
    print(len(dual_delay_low_avg[cutdual:]))
    print(len(dual_delay_low_err[cutdual:]))
    print(len(waa_load_low_bps_avg[cutwaa:]))
    print(len(waa_delay_low_avg[cutwaa:]))
    print(len(waa_delay_low_err[cutwaa:]))
    plt.plot(dual_load_low_bps_avg[cutdual:], dual_delay_low_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_low_bps_avg[cutwaa:], waa_delay_low_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Delay low qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_qdelay_total(cutdual,cutwaa):
    print(len(dual_load_total_bps_avg[cutdual:]))
    print(len(dual_qdelay_total_avg[cutdual:]))
    print(len(dual_qdelay_total_err[cutdual:]))
    print(len(waa_load_total_bps_avg[cutwaa:]))
    print(len(waa_qdelay_total_avg[cutwaa:]))
    print(len(waa_qdelay_total_err[cutwaa:]))
    plt.plot(dual_load_total_bps_avg[cutdual:], dual_qdelay_total_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_total_bps_avg[cutwaa:], waa_qdelay_total_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Queuing Delay total', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_qdelay_high(cutdual,cutwaa):
    print(len(dual_load_high_bps_avg[cutdual:]))
    print(len(dual_qdelay_high_avg[cutdual:]))
    print(len(dual_qdelay_high_err[cutdual:]))
    print(len(waa_load_high_bps_avg[cutwaa:]))
    print(len(waa_qdelay_high_avg[cutwaa:]))
    print(len(waa_qdelay_high_err[cutwaa:]))
    plt.plot(dual_load_high_bps_avg[cutdual:], dual_qdelay_high_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_high_bps_avg[cutwaa:], waa_qdelay_high_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Queuing Delay high qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_qdelay_med(cutdual,cutwaa):
    print(len(dual_load_med_bps_avg[cutdual:]))
    print(len(dual_qdelay_med_avg[cutdual:]))
    print(len(dual_qdelay_med_err[cutdual:]))
    print(len(waa_load_med_bps_avg[cutwaa:]))
    print(len(waa_qdelay_med_avg[cutwaa:]))
    print(len(waa_qdelay_med_err[cutwaa:]))
    plt.plot(dual_load_med_bps_avg[cutdual:], dual_qdelay_med_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_med_bps_avg[cutwaa:], waa_qdelay_med_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Queuing Delay med qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot_qdelay_low(cutdual,cutwaa):
    print(len(dual_load_low_bps_avg[cutdual:]))
    print(len(dual_qdelay_low_avg[cutdual:]))
    print(len(dual_qdelay_low_err[cutdual:]))
    print(len(waa_load_low_bps_avg[cutwaa:]))
    print(len(waa_qdelay_low_avg[cutwaa:]))
    print(len(waa_qdelay_low_err[cutwaa:]))
    plt.plot(dual_load_low_bps_avg[cutdual:], dual_qdelay_low_avg[cutdual:],'k--', label="LSDM MAC")
    plt.plot(waa_load_low_bps_avg[cutwaa:], waa_qdelay_low_avg[cutwaa:],'k', label="Intra-MAC")
    plt.xlabel('Load (bps)', fontsize=25)
    plt.ylabel('Time (sec)', fontsize=25)
    plt.title('Queuing Delay low qos', fontsize=25)
    plt.grid(True, which='major', axis='both')
    plt.legend()
    plt.show()

def plot1_paper_total_thru_drop(cutdual,cutwaa):
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"
    print(len(dual_load_total_bps_avg[cutdual:]))
    print(len(dual_thru_total_bps_avg[cutdual:]))
    print(len(dual_thru_total_bps_err[cutdual:]))
    print(len(waa_load_total_bps_avg[cutwaa:]))
    print(len(waa_thru_total_bps_avg[cutwaa:]))
    print(len(waa_thru_total_bps_err[cutwaa:]))

    print(len(dual_load_total_bps_avg[cutdual:]))
    print(len(dual_drop_total_bps_avg[cutdual:]))
    print(len(dual_drop_total_bps_err[cutdual:]))
    print(len(waa_load_total_bps_avg[cutwaa:]))
    print(len(waa_drop_total_bps_avg[cutwaa:]))
    print(len(waa_drop_total_bps_err[cutwaa:]))

    fig, ax_thru = plt.subplots()
    ax_drop=ax_thru.twinx()

    waa_load=[x/(1e9) for x in waa_load_total_bps_avg[cutwaa:]]
    waa_thru=[x/(1e9) for x in waa_thru_total_bps_avg[cutwaa:]]
    dual_load=[x/(1e9) for x in dual_load_total_bps_avg[cutdual:]]
    dual_thru=[x/(1e9) for x in dual_thru_total_bps_avg[cutdual:]]
    waa_drop=[x/(1e9) for x in waa_drop_total_bps_avg[cutwaa:]]
    dual_drop=[x/(1e9) for x in dual_drop_total_bps_avg[cutdual:]]
    ax_thru.plot(waa_load, waa_thru,'b', label="Intra-MAC Throughput",linewidth=4)
    ax_thru.plot(dual_load, dual_thru,'b--', label="LSDM MAC Throughput",linewidth=4)
    ax_drop.plot(waa_load, waa_drop,'r', label="Intra-MAC Dropping Rate",linewidth=4)
    ax_drop.plot(dual_load, dual_drop,'r--', label="LSDM MAC Dropping Rate",linewidth=4)

    ax_thru.set_xlabel('Load $L_o$ (Gbps)', fontsize=22)
    ax_thru.set_ylabel('Throughput $S$ (Gbps)', color='b', fontsize=22)
    ax_thru.tick_params(labelsize=14)
    ax_drop.tick_params(labelsize=14)
    ax_drop.set_ylabel('Dropping Rate $S_d$ (Gbps)', color='r', fontsize=22)
    ax_thru.set_ylim(0, 20)
    ax_drop.set_ylim(0, 20)
    ax_thru.set_xlim(0, 23)
    ax_drop.set_xlim(0, 23)
    fig.legend(loc='upper left',bbox_to_anchor=(0.1,0.95), fontsize=15)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot1_drop_prob_total(cutdual,cutwaa):
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"
    print(len(dual_load_total_bps_avg[cutdual:]))
    print(len(dual_drop_prob_total_avg[cutdual:]))
    print(len(dual_drop_prob_total_err[cutdual:]))
    print(len(dual_load_high_bps_avg[cutdual:]))
    print(len(dual_drop_prob_high_avg[cutdual:]))
    print(len(dual_drop_prob_high_err[cutdual:]))
    print(len(dual_load_med_bps_avg[cutdual:]))
    print(len(dual_drop_prob_med_avg[cutdual:]))
    print(len(dual_drop_prob_med_err[cutdual:]))
    print(len(dual_load_low_bps_avg[cutdual:]))
    print(len(dual_drop_prob_low_avg[cutdual:]))
    print(len(dual_drop_prob_low_err[cutdual:]))
    print(len(waa_load_total_bps_avg[cutdual:]))
    print(len(waa_drop_prob_total_avg[cutdual:]))
    print(len(waa_drop_prob_total_err[cutdual:]))
    print(len(waa_load_high_bps_avg[cutdual:]))
    print(len(waa_drop_prob_high_avg[cutdual:]))
    print(len(waa_drop_prob_high_err[cutdual:]))
    print(len(waa_load_med_bps_avg[cutdual:]))
    print(len(waa_drop_prob_med_avg[cutdual:]))
    print(len(waa_drop_prob_med_err[cutdual:]))
    print(len(waa_load_low_bps_avg[cutdual:]))
    print(len(waa_drop_prob_low_avg[cutdual:]))
    print(len(waa_drop_prob_low_err[cutdual:]))

    print_total=True
    if print_total:
        waa_prob=[1*x for x in waa_drop_prob_total_avg[cutwaa:]]
        dual_prob=[1*x for x in dual_drop_prob_total_avg[cutdual:]]
        waa_load = [x / (1e9) for x in waa_load_total_bps_avg[cutwaa:]]
        dual_load = [x / (1e9) for x in dual_load_total_bps_avg[cutdual:]]
        plt.plot(waa_load, waa_prob,'b', label="Intra-MAC",linewidth=4)
        plt.plot(dual_load, dual_prob,'b--', label="LSDM MAC",linewidth=4)
    else:
        waa_high=[100*x for x in waa_drop_prob_high_avg[cutwaa:cutwaa+2]]
        dual_high=[100*x for x in dual_drop_prob_high_avg[cutdual:cutdual+2]]
        plt.plot(waa_load_high_bps_avg[cutwaa:cutwaa+2], waa_high,'r',marker='o', label="Intra-MAC high")
        plt.plot(dual_load_high_bps_avg[cutdual:cutdual+2], dual_high,'b',marker='o', label="LSDM MAC high")

        waa_med=[100*x for x in waa_drop_prob_med_avg[cutwaa:cutwaa+7]]
        dual_med=[100*x for x in dual_drop_prob_med_avg[cutdual:cutdual+7]]
        plt.plot(waa_load_med_bps_avg[cutwaa:cutwaa+7], waa_med,'r',marker='v', label="Intra-MAC med")
        plt.plot(dual_load_med_bps_avg[cutdual:cutdual+7], dual_med,'b',marker='v', label="LSDM MAC med")

        waa_low=[100*x for x in waa_drop_prob_low_avg[cutwaa:]]
        dual_low=[100*x for x in dual_drop_prob_low_avg[cutdual:]]
        plt.plot(waa_load_low_bps_avg[cutwaa:], waa_low,'r',marker='s', label="Intra-MAC low")
        plt.plot(dual_load_low_bps_avg[cutdual:], dual_low,'b',marker='s', label="LSDM MAC low")

    plt.xlabel('Load $L_o$ (Gbps)', fontsize=22)
    plt.ylabel('Dropping Probability $P_d$', fontsize=22)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 23, -0.01, 1.05))
    plt.tick_params(labelsize=14)
    plt.legend(loc='upper left', fontsize=15)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot1_delays(cutdual,cutwaa):
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"
    waa_delay = [1000 * x for x in waa_delay_total_avg[cutwaa:]]
    dual_delay = [1000 * x for x in dual_delay_total_avg[cutdual:]]
    waa_load = [x / (1e9) for x in waa_load_total_bps_avg[cutwaa:]]
    dual_load = [x / (1e9) for x in dual_load_total_bps_avg[cutdual:]]

    total=True
    if total:
        plt.plot(waa_load, waa_delay, 'b', label="Intra-MAC", linewidth=4)
        plt.plot(dual_load, dual_delay, 'b--', label="LSDM MAC", linewidth=4)
    else:
        plt.plot(waa_load_high_bps_avg[cutwaa:], waa_delay_high_avg[cutwaa:], 'r', label="Intra-MAC high")
        plt.plot(dual_load_high_bps_avg[cutdual:], dual_delay_high_avg[cutdual:], 'b', label="LSDM MAC high")

        plt.plot(waa_load_med_bps_avg[cutwaa:], waa_delay_med_avg[cutwaa:], 'r--', label="Intra-MAC med")
        dualx=dual_load_med_bps_avg[cutdual+3:]
        dualy=dual_delay_med_avg[cutdual+3:]
        dualx.insert(0,0)
        dualy.insert(0,0)
        plt.plot(dualx, dualy, 'b--', label="LSDM MAC med")

        plt.plot(waa_load_low_bps_avg[cutwaa:], waa_delay_low_avg[cutwaa:], 'r-.', label="Intra-MAC low")
        dualx=dual_load_low_bps_avg[cutdual:]
        dualy=dual_delay_low_avg[cutdual:]
        dualx.insert(0,0)
        dualy.insert(0,0)
        plt.plot(dualx, dualy, 'b-.', label="LSDM MAC low")


    plt.xlabel('Load $L_o$ (Gbps)', fontsize=22)
    plt.ylabel('Total Delay $D$ (ms)', fontsize=22)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 23, 0, 25))
    plt.tick_params(labelsize=14)
    plt.legend(loc='upper left', fontsize=15)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot1_thru_per_server():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_thru_m4_node1_bps_avg = [1540000000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2456640000.0, 2533657142.857143,
                              2457369600.0, 2472934193.548387, 2417292307.6923075, 2401370909.090909, 2424150804.597701,
                              2401982978.7234044, 2409092413.793103, 2420234202.8985505, 2371649655.172414,
                              2397065531.9148936, 2340286666.6666665, 2433126956.521739, 2384899459.4594593,
                              2433135000.0, 2330266666.6666665, 2381766400.0, 2502087619.047619, 2439963076.923077,
                              2426966153.8461537, 2416773333.3333335, 2362737777.7777777, 2522466666.6666665,
                              2769720000.0, 2547825454.5454545]
    waa_thru_m4_node1_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 357513188.5679184, 410803307.51849097,
                              364971664.52205575, 339431477.08759063, 316660444.3977079, 286667154.1975393,
                              291284047.52469426, 285252229.30279547, 260094531.3166927, 296849894.1156753,
                              312290157.41361886, 284772104.6946328, 303890219.7451204, 296601434.7823959,
                              305856149.4299962, 359434891.4795324, 200640458.5899574, 421103156.90734655,
                              404165407.6477199, 492026246.03748894, 251042818.04566267, 336710402.0173221,
                              293753392.5666978, 311082394.8536445, 615887163.691532, 395691622.66501516]
    waa_thru_m4_node2_bps_avg = [2493440000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2378720000.0, 2426982857.142857,
                              2544428800.0, 2486851612.903226, 2422434461.5384617, 2446427272.7272725,
                              2442521379.3103447, 2516272340.425532, 2492899310.3448277, 2418256231.884058,
                              2488201379.3103447, 2498250212.7659574, 2544056666.6666665, 2490452173.9130435,
                              2435770810.810811, 2519860000.0, 2407673333.3333335, 2487059200.0, 2510933333.3333335,
                              2693895384.6153846, 2398596923.076923, 2532933333.3333335, 2385706666.6666665,
                              2506826666.6666665, 2286520000.0, 2594254545.4545455]
    waa_thru_m4_node2_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 173326014.20444652, 336650766.7605104,
                              299509938.2925381, 314602359.9704796, 244991540.24954852, 311334500.58874667,
                              317168791.65213495, 318033954.2447127, 326083540.3796021, 307978288.7931314,
                              323424391.1830077, 321577017.3994388, 353652428.56079805, 313859026.0038063,
                              273404521.56687754, 382862508.26146203, 298693331.44426805, 335817576.8915816,
                              318852042.25993806, 445566882.53309, 338969438.33194894, 452369620.67170984,
                              216178814.8732433, 302120153.9825244, 110068167.9687638, 384586834.6255144]
    waa_thru_m4_node3_bps_avg = [1463520000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2108720000.0, 2477394285.714286,
                              2361164800.0, 2449698064.516129, 2478016000.0, 2482450909.090909, 2461482298.8505745,
                              2438811914.893617, 2423933793.1034484, 2464612173.9130435, 2522496551.724138,
                              2391148936.1702127, 2502753333.3333335, 2472069565.2173915, 2535718918.918919,
                              2418395000.0, 2532826666.6666665, 2496569600.0, 2449539047.6190476, 2409009230.769231,
                              2559347692.3076925, 2319706666.6666665, 2394488888.888889, 2351400000.0, 2496160000.0,
                              2305861818.181818]
    waa_thru_m4_node3_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64148727.18924359, 302968858.0521941,
                              284150880.1839849, 313239622.11343294, 338335754.89445394, 290914672.9412207,
                              295438036.9682907, 299630876.90380514, 323353232.43137246, 322589263.32772183,
                              328416485.8596353, 270614970.08009803, 372202322.40768427, 319906206.0803067,
                              341406997.0625137, 387474586.6879946, 397270219.7515556, 391206306.91575855,
                              446819760.9988256, 377410417.8579233, 353389611.3864943, 305864420.3346749,
                              496725244.6887626, 259995404.71463582, 508626821.6810173, 299603888.0194375]
    waa_thru_m4_node4_bps_avg = [2004960000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2881040000.0, 2384468571.428571,
                              2466208000.0, 2412908387.096774, 2501565538.4615383, 2484425454.5454545,
                              2493484137.9310346, 2463674893.617021, 2488025747.1264367, 2522295652.173913,
                              2437897931.034483, 2540034042.5531917, 2432296666.6666665, 2421947826.0869565,
                              2461085405.4054055, 2451690000.0, 2544153333.3333335, 2453427200.0, 2346194285.714286,
                              2275298461.5384617, 2427753846.1538463, 2580133333.3333335, 2689528888.888889,
                              2447466666.6666665, 2268960000.0, 2354123636.3636365]
    waa_thru_m4_node4_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 105556900.29552782, 345468290.9384826,
                              335882122.1797909, 249176950.8996588, 352184621.4613099, 246673323.11728004,
                              328201198.5882615, 324911206.72810817, 362277277.12999886, 361318343.01411474,
                              269484454.30383134, 322623651.3046255, 297808333.37391746, 307974217.54940635,
                              356710785.32891315, 329325412.55548245, 383951050.44293326, 370695363.6469349,
                              206583218.79018703, 257140240.13645917, 386085120.0952639, 435928289.637948,
                              392017086.24894285, 180664577.87006754, 321276042.47230554, 284540214.9177767]

    waa_thru_m8_node1_bps_avg = [780320000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1091680000.0, 1182674285.7142856,
                                 1272678400.0, 1210792258.064516, 1181654153.8461537, 1200061818.1818182,
                                 1202742068.9655173, 1209222127.6595745, 1189633103.4482758, 1187837681.1594203,
                                 1202860689.6551723, 1254658723.4042554, 1167536666.6666667, 1250365217.3913043,
                                 1194547027.0270271, 1145965000.0, 1145846666.6666667, 1185996800.0, 1257988571.4285715,
                                 1055716923.0769231, 1133501538.4615386, 1168453333.3333333, 1245297777.7777777,
                                 1227080000.0, 1278360000.0, 1338269090.909091]
    waa_thru_m8_node1_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 92093587.18173595, 183376875.88948888,
                                 270752851.74983233, 219226499.15674534, 233899972.2563867, 221490645.23742464,
                                 199881532.42601463, 226982881.99334556, 200850568.83924255, 190795663.02680475,
                                 211516772.7069372, 302287466.6217502, 178579409.42198107, 307963022.61248565,
                                 263046337.79436472, 158558884.06560206, 179420981.6305645, 217097066.43803367,
                                 292144944.0651971, 58954776.93178834, 157721625.33221593, 274377382.9357418,
                                 257175917.31039757, 324338646.81561124, 376578649.7754044, 398591978.2799083]
    waa_thru_m8_node2_bps_avg = [956960000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1245520000.0, 1189782857.142857,
                                 1186483200.0, 1277860645.1612904, 1240526769.2307692, 1210325454.5454545,
                                 1277745287.3563218, 1235242553.1914895, 1242714482.7586207, 1224331594.2028985,
                                 1235481379.310345, 1252905531.9148936, 1272016666.6666667, 1274240000.0,
                                 1261625945.945946, 1276825000.0, 1193406666.6666667, 1242528000.0, 1236243809.5238094,
                                 1472086153.8461537, 1201181538.4615386, 1490586666.6666667, 1217084444.4444444,
                                 1218360000.0, 1377600000.0, 1299156363.6363637]
    waa_thru_m8_node2_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107367093.65536538, 231446374.83006302,
                                 229462635.4245937, 274598265.8707973, 309915714.6361919, 224804901.25812665,
                                 272292639.9855924, 264029995.48127335, 310351505.6323649, 259443289.3355399,
                                 326168556.83025426, 248939154.7696511, 330250803.45116776, 279783677.70674384,
                                 262750225.66286388, 296411534.9720994, 241906818.04052722, 260556602.16799983,
                                 252856791.69198108, 484869287.08567876, 339048887.9656874, 496208507.5718338,
                                 235301852.47417364, 215560281.04369405, 196933634.84517655, 350114580.3097245]
    waa_thru_m8_node3_bps_avg = [853440000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1062960000.0, 1208571428.5714285,
                                 1179955200.0, 1218800000.0, 1254281846.1538463, 1281554545.4545455, 1226096551.724138,
                                 1216946382.9787233, 1220200459.770115, 1238265507.2463768, 1233657931.0344827,
                                 1178403404.255319, 1272093333.3333333, 1170702608.6956522, 1227878918.9189188,
                                 1181840000.0, 1215173333.3333333, 1283225600.0, 1180495238.0952382, 1118080000.0,
                                 1179089230.7692308, 1019733333.3333334, 1100497777.7777777, 1224000000.0, 1212320000.0,
                                 1212916363.6363637]
    waa_thru_m8_node3_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 33375440.072005045, 251429106.41301724,
                                 229244647.2861108, 248573115.46333313, 245186507.4214698, 272839863.01137686,
                                 236506678.2125484, 241013687.95667064, 253644055.9996867, 285215626.1679936,
                                 262235213.4660965, 262883968.29810506, 287440361.8538897, 206847284.45492536,
                                 260879669.91809955, 197631055.15401754, 289566728.49150914, 247355720.8771745,
                                 225633846.56604707, 157484451.71931523, 259055996.0851945, 35125837.02442785,
                                 95753030.47133519, 235394897.6043912, 366525183.8550797, 229584234.61870056]
    waa_thru_m8_node4_bps_avg = [1035200000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1472720000.0, 1160331428.5714285,
                                 1289683200.0, 1249984516.1290324, 1239574153.8461537, 1220452727.2727273,
                                 1266749425.2873564, 1216316595.744681, 1231054712.6436782, 1193080579.710145,
                                 1214223448.275862, 1253576170.212766, 1143236666.6666667, 1173773913.0434783,
                                 1213660540.5405405, 1218905000.0, 1218266666.6666667, 1165888000.0, 1241348571.4285715,
                                 1156381538.4615386, 1308209230.7692308, 1315706666.6666667, 1248302222.2222223,
                                 1254546666.6666667, 1184880000.0, 1203403636.3636363]
    waa_thru_m8_node4_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 652687843.3064308, 212310659.71488908,
                                 327364233.01271015, 321919599.07373583, 274975398.5751061, 246286476.57595944,
                                 276014814.86762637, 256701764.99534884, 259056160.6429533, 210644880.80991596,
                                 289274789.1001797, 289587439.51377505, 185280253.52449, 226843914.5754265,
                                 292682184.8006805, 320795221.2257694, 287611558.97837454, 286989601.6699328,
                                 305970931.2056574, 217624797.98367625, 450304531.6683207, 441342109.23802257,
                                 269282524.58049417, 207212039.89823535, 208659201.57040763, 206447313.5341183]
    waa_thru_m8_node5_bps_avg = [639840000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1362960000.0, 1201097142.857143,
                                 1215955200.0, 1235775483.8709676, 1238116923.0769231, 1201009090.909091,
                                 1204112183.908046, 1231771914.893617, 1214780689.6551723, 1250710724.6376812,
                                 1230044137.9310346, 1160571914.893617, 1247870000.0, 1205133913.0434783,
                                 1196722162.162162, 1313845000.0, 1121773333.3333333, 1178796800.0, 1322308571.4285715,
                                 1341587692.3076923, 1415347692.3076923, 1090826666.6666667, 1275537777.7777777,
                                 1262106666.6666667, 1306160000.0, 1329556363.6363637]
    waa_thru_m8_node5_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 55097760.39005578, 181745837.5537989,
                                 197741398.9094511, 257758964.42840675, 246833311.8024887, 246430560.70572653,
                                 231509297.40446705, 249123784.46375018, 233900910.03627566, 310544528.9767771,
                                 239290388.68268502, 200069257.5588926, 299285015.3992899, 234979592.14912695,
                                 231508256.2378852, 323248479.2369985, 180630297.6817004, 175803114.8453671,
                                 352118429.4280223, 407965203.5438367, 448961332.6734246, 118345183.70709755,
                                 288874244.6886611, 231063386.7119321, 153618360.01381257, 241710672.30359223]
    waa_thru_m8_node6_bps_avg = [880160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073200000.0, 1375348571.4285715,
                                 1332531200.0, 1264459354.8387096, 1228576000.0, 1199778181.8181818, 1220912183.908046,
                                 1262238297.8723404, 1254604137.9310346, 1201644057.9710145, 1227180689.6551723,
                                 1287880851.06383, 1216963333.3333333, 1257314782.6086957, 1151494054.054054,
                                 1276060000.0, 1241866666.6666667, 1235782400.0, 1273790476.1904762, 1387433846.1538463,
                                 1216012307.6923077, 1151866666.6666667, 1203057777.7777777, 1264760000.0, 1084360000.0,
                                 1148290909.090909]
    waa_thru_m8_node6_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22514279.912979674, 267978844.36755717,
                                 362851329.6140262, 304055780.1924335, 285086985.7429483, 219156318.73763812,
                                 276631091.4835996, 263258559.221772, 288753517.2948033, 235222631.77878478,
                                 256200693.39828423, 319018122.25905716, 230337129.6953925, 306070348.75981,
                                 201684164.13705778, 326497295.42919743, 347402486.87085986, 272286049.11746764,
                                 422494939.6913079, 466867048.5541264, 246857190.2319857, 160439346.13013938,
                                 182817442.39662814, 291603605.4147978, 48103599.310931675, 280204303.2308585]
    waa_thru_m8_node7_bps_avg = [1098560000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1270400000.0, 1266011428.5714285,
                                 1098400000.0, 1174247741.935484, 1147712000.0, 1256036363.6363637, 1197039080.4597702,
                                 1246830638.2978723, 1268443218.3908045, 1289602318.8405797, 1230587586.2068965,
                                 1234924255.319149, 1217200000.0, 1214024347.826087, 1339424864.8648648, 1189445000.0,
                                 1333880000.0, 1254368000.0, 1190080000.0, 1175913846.1538463, 1248123076.9230769,
                                 1200586666.6666667, 1296960000.0, 1177200000.0, 1177200000.0, 1083665454.5454545]
    waa_thru_m8_node7_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 341221448.3293804, 274963015.7747693,
                                 118090722.18708237, 188511947.9225963, 177347726.6840486, 240511316.44550326,
                                 215754463.54288825, 265447378.90056401, 299277910.21558857, 322506363.996237,
                                 232046928.8539769, 261098282.77576843, 247796009.99655497, 237015995.70635802,
                                 408472666.4432165, 207916419.87013173, 316741564.2197087, 251244127.7589057,
                                 264734952.7357504, 159192289.46667305, 251872739.53938904, 245706508.06738243,
                                 468930780.3930128, 192053828.817955, 304867744.0027615, 89821852.61545615]
    waa_thru_m8_node8_bps_avg = [656640000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1278080000.0, 1241394285.7142856,
                                 1258483200.0, 1196694193.548387, 1296851692.3076923, 1261756363.6363637,
                                 1236693333.3333333, 1213475744.680851, 1206469885.0574713, 1246824347.826087,
                                 1252684137.9310346, 1210692765.9574468, 1291086666.6666667, 1281102608.6956522,
                                 1244095135.1351352, 1223080000.0, 1357873333.3333333, 1285056000.0, 1123040000.0,
                                 1136344615.3846154, 1128800000.0, 1416320000.0, 1252977777.7777777, 1199853333.3333333,
                                 1192840000.0, 1200872727.2727273]
    waa_thru_m8_node8_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 352082608.48840576, 225973037.3880336,
                                 248074604.34850374, 249038128.31752563, 279830264.42140573, 297078587.080199,
                                 243371296.67117867, 255164095.66204822, 209548286.46785575, 267393661.1697435,
                                 280079399.73874503, 236854238.95668066, 271377255.48977596, 275821242.421285,
                                 276450285.0787464, 272160571.9589674, 383934334.9048644, 316860058.2802025,
                                 141976151.23674822, 168506649.94866842, 187097191.1422866, 466931955.98502356,
                                 200108569.64269283, 218364629.39243838, 326030519.6347933, 288181235.09662837]

    waa_thru_m12_node1_bps_avg = [458720000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 952240000.0, 772057142.8571428,
                                  879328000.0, 869303225.8064516, 843864615.3846154, 840496363.6363636,
                                  883667126.4367816, 848529361.7021277, 815724137.9310344, 845980289.8550725,
                                  799244137.9310344, 837606808.5106384, 842856666.6666666, 886473043.4782609,
                                  838127567.5675676, 890135000.0, 799833333.3333334, 733420800.0, 821866666.6666666,
                                  907396923.0769231, 756689230.7692307, 716933333.3333334, 943395555.5555556,
                                  783280000.0, 874040000.0, 1050545454.5454545]
    waa_thru_m12_node1_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 114607867.09471563, 135843219.7808914,
                                  220353393.7413566, 263043913.41155607, 257049257.89547688, 222254716.84317222,
                                  255156575.98728195, 252421300.15438715, 213181959.97104686, 276826743.4907246,
                                  197451684.47464654, 219943743.52968952, 208581377.97923455, 261938961.27719498,
                                  220272532.1732831, 252000321.50517127, 244268292.03307092, 123865727.90458761,
                                  191573107.6464892, 317871871.2360012, 129521019.30198681, 80076917.68959808,
                                  268676445.14876586, 162482264.87835526, 255537427.91745138, 412126007.6327054]
    waa_thru_m12_node2_bps_avg = [472640000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 688640000.0, 806971428.5714285,
                                  846956800.0, 788815483.8709677, 783037538.4615384, 781132727.2727273,
                                  839702068.9655173, 791615319.1489362, 809412413.7931035, 767332173.9130435,
                                  803451034.4827586, 815063829.7872341, 813733333.3333334, 847533913.0434783,
                                  787788108.1081082, 786095000.0, 747700000.0, 835392000.0, 937005714.2857143,
                                  814018461.5384616, 867938461.5384616, 919493333.3333334, 730186666.6666666,
                                  871480000.0, 978400000.0, 796509090.9090909]
    waa_thru_m12_node2_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 328250781.2131343, 359357539.6769444,
                                  202628368.9755619, 191087794.46591076, 177363851.23753324, 254829054.8042232,
                                  221257103.0617399, 242080064.19636282, 186843781.65658608, 217219068.24548665,
                                  233827893.550802, 190402103.570238, 240185921.05541223, 166984401.3646158,
                                  204490412.6153911, 131842518.4436539, 305479358.3861273, 309852788.3458761,
                                  191619785.07129484, 320274838.8974214, 185263071.18977237, 86064831.3772821,
                                  253099588.87937587, 245985417.4539621, 207659694.76306883]
    waa_thru_m12_node3_bps_avg = [612000000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1051200000.0, 795211428.5714285,
                                  854828800.0, 884763870.967742, 830464000.0, 862007272.7272727, 824134252.8735632,
                                  862599148.9361702, 829651494.2528735, 785201159.4202899, 846653793.1034483,
                                  881501276.5957447, 846470000.0, 843342608.6956521, 845267027.027027, 853205000.0,
                                  879346666.6666666, 874201600.0, 856952380.9523809, 842301538.4615384, 731360000.0,
                                  766080000.0, 738684444.4444444, 837546666.6666666, 838920000.0, 874603636.3636364]
    waa_thru_m12_node3_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 261799214.66650736, 269475528.1841189,
                                  262418534.79254597, 304713463.2725047, 243204899.29275686, 238035425.2044149,
                                  211732921.54093775, 244555717.24655625, 214716534.81313413, 171293306.34509912,
                                  251650067.76556328, 274930190.3931964, 233020239.82953233, 252982876.70147675,
                                  226632754.72869298, 220454532.8589651, 235563643.95556286, 258561024.25539702,
                                  266202855.46749422, 204632968.7451069, 69811387.80074972, 136480694.01933742,
                                  127983643.39937264, 253097347.18387538, 328481295.6623253, 255174981.50378016]
    waa_thru_m12_node4_bps_avg = [532960000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 692480000.0, 773600000.0,
                                  792019200.0, 794149677.4193548, 839918769.2307693, 795272727.2727273,
                                  805748965.5172414, 777857021.2765957, 785526436.7816092, 821648695.6521739,
                                  778383448.2758621, 816908936.1702127, 762400000.0, 775707826.0869565,
                                  782784864.8648648, 761365000.0, 798340000.0, 796832000.0, 775801904.7619047,
                                  724947692.3076923, 737243076.9230769, 842240000.0, 741244444.4444444, 808400000.0,
                                  754680000.0, 729658181.8181819]
    waa_thru_m12_node4_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12671353.518862931, 173254195.10960457,
                                  211390723.58076644, 239722964.2526101, 241273819.7535355, 210356543.43801415,
                                  214275410.9271224, 166043051.75523934, 165532209.11883128, 229447533.39728275,
                                  173341427.77879736, 240425036.0546654, 140759328.74870935, 175054664.60398456,
                                  159020926.46395147, 185606104.3907144, 249812194.3624328, 246050618.09852594,
                                  191969423.59706786, 112312297.20099266, 124843550.58663192, 395650463.91985947,
                                  153600620.36911756, 184749581.47326195, 97202194.76260126, 184216238.47088954]
    waa_thru_m12_node5_bps_avg = [846080000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 687360000.0, 871360000.0,
                                  709804800.0, 826350967.7419355, 847968000.0, 806921818.1818181, 832452413.7931035,
                                  841366808.5106384, 836123218.3908046, 858710724.6376811, 840976551.7241379,
                                  787220425.531915, 779366666.6666666, 828462608.6956521, 754049729.7297298,
                                  808480000.0, 832653333.3333334, 870163200.0, 760175238.0952381, 787593846.1538461,
                                  891015384.6153846, 983520000.0, 806933333.3333334, 855533333.3333334, 766480000.0,
                                  914647272.7272727]
    waa_thru_m12_node5_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9050966.79918781, 225071441.92284983,
                                  89013742.99885759, 248443379.16617367, 234511934.36582285, 215013819.55343026,
                                  225700229.3688004, 258368943.21427616, 229307332.40892726, 304997180.48030835,
                                  231395785.1331231, 221467521.83085886, 171705910.54565376, 226076607.29579434,
                                  106753097.23548713, 221163597.77469066, 283179137.19927806, 228023419.24167934,
                                  136754115.39032555, 251846739.55729708, 308241711.8814223, 389170365.1615832,
                                  147555245.247331, 170964833.66913545, 106472797.1518234, 303587251.28341305]
    waa_thru_m12_node6_bps_avg = [700160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1095840000.0, 879200000.0,
                                  822854400.0, 799419354.8387097, 820017230.7692307, 841798181.8181819,
                                  825480459.7701149, 823303829.7872341, 811321379.3103448, 815545507.2463768,
                                  866030344.8275862, 823261276.5957447, 783040000.0, 790445217.3913044,
                                  809392432.4324324, 790530000.0, 737286666.6666666, 773356800.0, 821935238.0952381,
                                  729846153.8461539, 829833846.1538461, 720533333.3333334, 696284444.4444444,
                                  798186666.6666666, 684440000.0, 680101818.1818181]
    waa_thru_m12_node6_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 343031641.6892179, 230521053.66889027,
                                  232963029.65062934, 164802862.89761192, 199848020.5017341, 256961984.49793306,
                                  251926299.70590025, 244425872.19017488, 217119668.16723934, 237293602.59798428,
                                  303314748.5783409, 226711557.1517274, 210001011.87192893, 306912911.52550554,
                                  203590923.5780499, 176286965.7597356, 127494178.64516716, 138114581.37840962,
                                  199607986.40382722, 133882011.58348729, 258815019.57764035, 103954927.66899829,
                                  47440052.463902034, 189414044.0858853, 56466230.61618333, 41389453.202037305]
    waa_thru_m12_node7_bps_avg = [803680000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1072240000.0, 901257142.8571428,
                                  845888000.0, 858616774.1935484, 785294769.2307693, 800340000.0, 793171494.2528735,
                                  811674893.6170213, 813596321.8390805, 786845217.3913044, 820904827.5862069,
                                  784480000.0, 894473333.3333334, 778514782.6086956, 745595675.6756756, 774250000.0,
                                  812013333.3333334, 899180800.0, 793432380.9523809, 826769230.7692307,
                                  943643076.9230769, 790533333.3333334, 825795555.5555556, 888400000.0, 790080000.0,
                                  1012829090.9090909]
    waa_thru_m12_node7_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 309656201.6172129, 305344343.2088932,
                                  318384719.9013588, 255718361.62987885, 170182781.08687007, 228257884.64683595,
                                  191323120.80540082, 224601672.37547347, 240052272.10850006, 198110121.95099306,
                                  242029772.8331972, 158021245.9023208, 319085465.86271006, 193250725.26802677,
                                  137114152.5343946, 235876031.5190191, 212114588.44663197, 234757839.8037717,
                                  166106660.48972154, 373652943.48413604, 322016090.05826133, 141730178.9551776,
                                  184325430.08976752, 282383113.58217514, 233997105.39520213, 311358600.7629963]
    waa_thru_m12_node8_bps_avg = [274720000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 686080000.0, 853565714.2857143,
                                  838131200.0, 824149677.4193548, 759977846.1538461, 789327272.7272727,
                                  839882298.8505747, 834973617.0212766, 814067126.4367816, 789342608.6956521,
                                  806813793.1034483, 772687659.5744681, 810006666.6666666, 862351304.3478261,
                                  834784864.8648648, 812745000.0, 817426666.6666666, 850624000.0, 900000000.0,
                                  994104615.3846154, 848578461.5384616, 754373333.3333334, 839697777.7777778,
                                  822426666.6666666, 799040000.0, 827141818.1818181]
    waa_thru_m12_node8_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14481546.878700493, 252841999.84953466,
                                  260812579.32852855, 202839350.2658882, 146736370.07074443, 185270864.97495618,
                                  247251637.81855148, 235285850.6585337, 247758510.7444299, 171065911.6836357,
                                  182270245.0991874, 136645559.0556119, 236323886.99223903, 319756488.4485185,
                                  268618283.7082062, 209942306.4835025, 296369337.30187684, 237646092.05006227,
                                  329297985.9033456, 376331835.67642766, 221556843.33996373, 108977005.03623077,
                                  268927248.98091763, 226068648.83897278, 162928087.20414045, 286247979.96905345]
    waa_thru_m12_node9_bps_avg = [536320000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 726320000.0, 793382857.1428572,
                                  795180800.0, 799318709.6774193, 821875692.3076923, 834136363.6363636,
                                  799882298.8505747, 799162553.1914893, 884025747.1264368, 805303188.4057971,
                                  816413793.1034483, 830400000.0, 834953333.3333334, 808953043.4782609,
                                  782685405.4054054, 842470000.0, 870993333.3333334, 749209600.0, 818293333.3333334,
                                  916233846.1538461, 761760000.0, 803520000.0, 693884444.4444444, 791786666.6666666,
                                  1018920000.0, 744858181.8181819]
    waa_thru_m12_node9_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17083699.833466988, 238055437.99804187,
                                  188325122.1053633, 209401661.00366697, 197685587.75528845, 201154311.27109036,
                                  182057927.2349118, 211585287.43766138, 278564079.8211185, 241416472.98985428,
                                  218761523.3562553, 221276338.11299312, 230988194.71845478, 198502038.15208396,
                                  167045130.33898944, 194753702.12225127, 317796046.7462366, 145357821.15409777,
                                  237386712.79861754, 330387697.0454172, 174120865.30147192, 274457715.2131089,
                                  42464085.74051463, 168991076.11368302, 446166655.858548, 188275124.95378575]
    waa_thru_m12_node10_bps_avg = [772640000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 686080000.0, 743520000.0,
                                   845376000.0, 745143225.8064516, 780381538.4615384, 810667272.7272727,
                                   813956781.6091954, 816451063.8297873, 816207816.091954, 805954782.6086956,
                                   807412413.7931035, 853518297.8723404, 811623333.3333334, 852664347.826087,
                                   883602162.1621622, 874255000.0, 914026666.6666666, 769376000.0, 793676190.4761904,
                                   775126153.8461539, 773267692.3076923, 1048213333.3333334, 1005511111.1111112,
                                   905200000.0, 754040000.0, 690181818.1818181]
    waa_thru_m12_node10_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28963093.757400986, 102077009.84287079,
                                   205582987.62300348, 137836371.42563003, 190458526.07285964, 208867729.49563175,
                                   188837397.48046714, 254980280.87563014, 218731060.5936681, 214893775.33623648,
                                   176311289.33921772, 226955017.63966882, 215904222.08020097, 285553254.9953758,
                                   242459368.22412047, 226964495.33337915, 294801532.09835297, 140335833.39024046,
                                   203290012.3094145, 156917488.16593927, 191347786.2494471, 406896121.32172835,
                                   483465497.33265465, 317428361.22358525, 140968104.1938211, 52860681.38383799]
    waa_thru_m12_node11_bps_avg = [342400000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 802240000.0, 809348571.4285715,
                                   821785600.0, 806707096.7741935, 809863384.6153846, 824772727.2727273,
                                   799297471.2643678, 833902978.7234043, 799378390.8045977, 870620289.8550725,
                                   824204137.9310344, 780891914.893617, 785776666.6666666, 791193043.4782609,
                                   922975135.1351352, 839910000.0, 858280000.0, 867161600.0, 815192380.9523809,
                                   764233846.1538461, 815987692.3076923, 767786666.6666666, 815715555.5555556,
                                   767426666.6666666, 843400000.0, 671025454.5454545]
    waa_thru_m12_node11_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 157034273.96590847, 201660842.7288498,
                                   188985737.33838576, 191150806.86516497, 238454865.21481457, 231188789.25573784,
                                   174479354.4341671, 200014749.00363922, 167440621.65070856, 269218893.63146496,
                                   224130217.37479278, 201291141.5861018, 140456359.13939616, 201281551.5404514,
                                   312662092.8380956, 230253835.13320333, 244091155.60273433, 231066966.47797439,
                                   232163294.12516445, 154364149.41831872, 216034569.693288, 130346911.07451172,
                                   194536475.18596038, 140184463.7568225, 325893761.01218426, 41666436.45997012]
    waa_thru_m12_node12_bps_avg = [673120000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 677120000.0, 838434285.7142857,
                                   786444800.0, 840312258.0645162, 915448615.3846154, 853234545.4545455,
                                   779398620.6896552, 801540425.531915, 820051494.2528735, 888468405.7971015,
                                   830543448.2758621, 860017021.2765957, 877773333.3333334, 773043478.2608696,
                                   850763243.2432432, 807440000.0, 778173333.3333334, 821094400.0, 744304761.9047619,
                                   765809230.7692307, 882966153.8461539, 741200000.0, 1010346666.6666666,
                                   713066666.6666666, 736480000.0, 827141818.1818181]
    waa_thru_m12_node12_bps_err = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16291740.238538055, 192183596.10276058,
                                   174042793.32777137, 228403148.99367607, 325747078.612557, 264817460.6308342,
                                   164889747.45774835, 231060548.91377088, 273645055.9873975, 279963699.58822703,
                                   223854984.01555088, 235745936.60489023, 261769007.45743033, 170998446.6364455,
                                   249516888.29565173, 187064049.89011204, 210902451.3570333, 165149181.4007364,
                                   145559615.54013008, 149274860.71346924, 347626469.97264326, 116575422.45259075,
                                   400421362.06751007, 112665479.21196006, 115740804.6743527, 219565864.27849764]

    waa4=[waa_thru_m4_node1_bps_avg,waa_thru_m4_node2_bps_avg,waa_thru_m4_node3_bps_avg,waa_thru_m4_node4_bps_avg]
    waa8=[waa_thru_m8_node1_bps_avg,waa_thru_m8_node2_bps_avg,waa_thru_m8_node3_bps_avg,waa_thru_m8_node4_bps_avg,
          waa_thru_m8_node5_bps_avg,waa_thru_m8_node6_bps_avg,waa_thru_m8_node7_bps_avg,waa_thru_m8_node8_bps_avg]
    waa12=[waa_thru_m12_node1_bps_avg,waa_thru_m12_node2_bps_avg,waa_thru_m12_node3_bps_avg,waa_thru_m12_node4_bps_avg,
          waa_thru_m12_node5_bps_avg,waa_thru_m12_node6_bps_avg,waa_thru_m12_node7_bps_avg,waa_thru_m12_node8_bps_avg,
           waa_thru_m12_node9_bps_avg,waa_thru_m12_node10_bps_avg,waa_thru_m12_node11_bps_avg,waa_thru_m12_node12_bps_avg]

    for i in range(0,len(waa4)):
        waa4[i]=waa4[i][cutwaa:]
    for i in range(0,len(waa8)):
        waa8[i]=waa8[i][cutwaa:]
    for i in range(0,len(waa12)):
        waa12[i]=waa12[i][cutwaa:]

    thru4=[]
    for i in range(0,len(waa4[0])):
        sum=0
        N=0
        for el in waa4:
            sum=sum+el[i]
            N=N+1
        thru4.append(sum/N)
    print(len(thru4))
    thru8=[]
    for i in range(0,len(waa8[0])):
        sum=0
        N=0
        for el in waa8:
            sum=sum+el[i]
            N=N+1
        thru8.append(sum/N)
    print(len(thru8))
    thru12=[]
    for i in range(0,len(waa12[0])):
        sum=0
        N=0
        for el in waa12:
            sum=sum+el[i]
            N=N+1
        thru12.append(sum/N)

    thru4=[x/(1e9) for x in thru4]
    thru8=[x/(1e9) for x in thru8]
    thru12=[x/(1e9) for x in thru12]
    waa_load=[x/(1e9) for x in waa_load_total_bps_avg[cutwaa:]]

    plt.plot(waa_load, thru4,'b', label="m=4",linewidth=4)
    plt.plot(waa_load, thru8,'r', label="m=8",linewidth=4)
    plt.plot(waa_load, thru12,'g', label="m=12",linewidth=4)
    #plt.yticks(fontsize=14)
    #plt.xticks(fontsize=14)
    plt.xlabel('Load $L_o$ (Gbps)', fontsize=22)
    plt.ylabel('Throughput per server $S_M$ (Gbps)', fontsize=20)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 23, 0, y2))
    plt.tick_params(labelsize=14)
    plt.legend(loc="upper left", fontsize=20)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot1_qdelays():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"
    dual_idx_10=None
    dual_idx_23=None
    waa_idx_10=None
    waa_idx_23=None
    refsmall=14e9
    refbig=22e9
    diff=math.inf
    i=0
    ref=refsmall
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_23=i
        i=i+1

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_23=i
        i=i+1

    print(str(waa_idx_10))
    print(str(waa_idx_23))
    print(str(dual_idx_10))
    print(str(dual_idx_23))
    print(str(waa_load_total_bps_avg[waa_idx_10]))
    print(str(waa_load_total_bps_avg[waa_idx_23]))
    print(str(dual_load_total_bps_avg[dual_idx_10]))
    print(str(dual_load_total_bps_avg[dual_idx_23]))
    print('----')
    dual_10_high=dual_qdelay_high_avg[dual_idx_10]*1000
    dual_10_med=dual_qdelay_med_avg[dual_idx_10]*1000
    dual_10_low=dual_qdelay_low_avg[dual_idx_10]*1000
    dual_23_high=dual_qdelay_high_avg[dual_idx_23]*1000
    dual_23_med=dual_qdelay_med_avg[dual_idx_23]*1000
    dual_23_low=dual_qdelay_low_avg[dual_idx_23]*1000
    waa_10_high=waa_qdelay_high_avg[waa_idx_10]*1000
    waa_10_med=waa_qdelay_med_avg[waa_idx_10]*1000
    waa_10_low=waa_qdelay_low_avg[waa_idx_10]*1000
    waa_23_high=waa_qdelay_high_avg[waa_idx_23]*1000
    waa_23_med=waa_qdelay_med_avg[waa_idx_23]*1000
    waa_23_low=waa_qdelay_low_avg[waa_idx_23]*1000
    print('dual_10_high='+str(dual_10_high))
    print('dual_10_med='+str(dual_10_med))
    print('dual_10_low='+str(dual_10_low))
    print('dual_23_high='+str(dual_23_high))
    print('dual_23_med='+str(dual_23_med))
    print('dual_23_low='+str(dual_23_low))
    print('waa_10_high='+str(waa_10_high))
    print('waa_10_med='+str(waa_10_med))
    print('waa_10_low='+str(waa_10_low))
    print('waa_23_high='+str(waa_23_high))
    print('waa_23_med='+str(waa_23_med))
    print('waa_23_low='+str(waa_23_low))

    fig, ax = plt.subplots()
    width=0.2
    pos_close=0.25
    pos_far=0.3
    pos_vfar=0.65

    pos=1
    label_1=pos
    #ax.bar(pos, waa_10_high*200, width, color='blue',edgecolor='black',linewidth=3, hatch='//')
    ax.bar(pos, waa_10_high*200, width, color='blue',edgecolor='black',linewidth=3)
    pos=pos+pos_close
    label_1=(label_1+pos)/2
    #ax.bar(pos, dual_10_high, width, color='magenta',edgecolor='black',linewidth=3, hatch='.')
    ax.bar(pos, dual_10_high, width, color='magenta',edgecolor='black',linewidth=3)

    pos=pos+pos_far
    label_2=pos
    ax.bar(pos, waa_10_med, width, color='blue',edgecolor='black',linewidth=3)
    pos=pos+pos_close
    label_2=(label_2+pos)/2
    ax.bar(pos, dual_10_med, width, color='magenta',edgecolor='black',linewidth=3)

    pos=pos+pos_far
    label_3=pos
    ax.bar(pos, waa_10_low, width, color='blue',edgecolor='black',linewidth=3)
    pos=pos+pos_close
    label_3=(label_3+pos)/2
    ax.bar(pos, dual_10_low, width, color='magenta',edgecolor='black',linewidth=3)

    pos=pos+pos_vfar
    label_4=pos
    ax.bar(pos, waa_23_high, width, color='blue',edgecolor='black',linewidth=3)
    pos=pos+pos_close
    label_4=(label_4+pos)/2
    ax.bar(pos, dual_23_high, width, color='magenta',edgecolor='black',linewidth=3)

    pos=pos+pos_far
    label_5=pos
    ax.bar(pos, waa_23_med, width, color='blue',edgecolor='black',linewidth=3,label="Intra-MAC")
    pos=pos+pos_close
    label_5=(label_5+pos)/2
    ax.bar(pos, dual_23_med, width, color='magenta',edgecolor='black',linewidth=3, label="LSDM MAC")

    pos=pos+pos_far
    label_6=pos
    ax.bar(pos, waa_23_low, width, color='blue',edgecolor='black',linewidth=3)
    pos=pos+pos_close
    label_6=(label_6+pos)/2
    ax.bar(pos, dual_23_low, width, color='magenta',edgecolor='black',linewidth=3)

    x = [label_1,label_2,label_3,label_4,label_5,label_6]
    labels = ['high', 'med', 'low','high', 'med', 'low']

    plt.text(label_2-0.2,-20,'10 Gbps',fontsize='xx-large',color='k')
    plt.text(label_5-0.2,-20,'23 Gbps',fontsize='xx-large',color='k')

    plt.xticks(x, labels, rotation='horizontal',fontsize=14)
    plt.yticks(fontsize=14)
    plt.tight_layout()
    plt.ylabel('Queuing Delay $D_{q}(x)$ (ms)', fontsize=25)
    #plt.ylabel('Dropping Probability (%)', fontsize=25)
    #plt.title('Queuing Delay low qos', fontsize=25)
    plt.legend(loc="upper left", fontsize=20)
    plt.grid(True, which='major', axis='both')
    plt.show()

def plot2_thru_vs_norm_load():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_load=[x/normload for x in waa_load_total_bps_avg[cutwaa:]]
    waa_thru=[x/(1e9) for x in waa_thru_total_bps_avg[cutwaa:]]
    dual_load=[x/normload for x in dual_load_total_bps_avg[cutdual:]]
    dual_thru=[x/(1e9) for x in dual_thru_total_bps_avg[cutdual:]]
    #waa_drop=[x/(1e9) for x in waa_drop_total_bps_avg[cutwaa:]]
    #dual_drop=[x/(1e9) for x in dual_drop_total_bps_avg[cutdual:]]
    plt.plot(waa_load, waa_thru,'k', label="            ",linewidth=4)
    plt.plot(dual_load, dual_thru,'k--', label="            ",linewidth=4)
    #ax_drop.plot(waa_load, waa_drop,'r', label="Intra-MAC Dropping Rate",linewidth=4)
    #ax_drop.plot(dual_load, dual_drop,'r--', label="LSDM MAC Dropping Rate",linewidth=4)

    #plt.yticks(fontsize=14)
    #plt.xticks(fontsize=14)
    plt.xlabel('Normalized Load', fontsize=22)
    plt.ylabel('Throughput (Gbps)', fontsize=22)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 2, 0, y2))
    plt.tick_params(labelsize=14)
    plt.legend(loc="upper left", fontsize=20,frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot2_drop_vs_norm_load():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_load=[x/normload for x in waa_load_total_bps_avg[cutwaa:]]
    dual_load=[x/normload for x in dual_load_total_bps_avg[cutdual:]]
    waa_drop=[x/(1e9) for x in waa_drop_total_bps_avg[cutwaa:]]
    dual_drop=[x/(1e9) for x in dual_drop_total_bps_avg[cutdual:]]
    plt.plot(waa_load, waa_drop,'k', label="            ",linewidth=4)
    plt.plot(dual_load, dual_drop,'k--', label="            ",linewidth=4)

    #plt.yticks(fontsize=14)
    #plt.xticks(fontsize=14)
    plt.xlabel('Normalized Load', fontsize=22)
    plt.ylabel('Rate of Dropped Packets (Gbps)', fontsize=22)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 2, 0, 16))
    plt.tick_params(labelsize=14)
    plt.legend(loc="upper left", fontsize=20,frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot2_delay_vs_thru():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_thru=[x/(1e9) for x in waa_thru_total_bps_avg[cutwaa:]]
    dual_thru=[x/(1e9) for x in dual_thru_total_bps_avg[cutdual:]]

    waa_delay = [1000 * x for x in waa_delay_total_avg[cutwaa:]]
    dual_delay = [1000 * x for x in dual_delay_total_avg[cutdual:]]

    prev=dual_delay[0]
    for i in range(1,len(dual_delay)):
        if dual_delay[i]<prev:
            dual_delay[i]=prev
        prev=dual_delay[i]

    prev=dual_thru[0]
    for i in range(1,len(dual_thru)):
        if dual_thru[i]<prev:
            dual_thru[i]=prev
        prev=dual_thru[i]

    plt.plot(waa_thru, waa_delay, 'k', label="            ", linewidth=4)
    plt.plot(dual_thru, dual_delay, 'k--', label="            ", linewidth=4)

    plt.xlabel('Throughput (Gbps)', fontsize=22)
    plt.ylabel('Total Delay (ms)', fontsize=22)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 10, 0, y2))
    plt.tick_params(labelsize=14)
    plt.legend(loc="upper left", fontsize=20, frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot2_queuing():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"
    dual_idx_5=None
    dual_idx_10=None
    dual_idx_20=None
    waa_idx_5=None
    waa_idx_10=None
    waa_idx_20=None
    refsmall=14e9
    refmed=25e9
    refbig=29e9

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_20=i
        i=i+1

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_20=i
        i=i+1

    print(str(waa_idx_5))
    print(str(waa_idx_10))
    print(str(waa_idx_20))
    print(str(dual_idx_5))
    print(str(dual_idx_10))
    print(str(dual_idx_20))
    print(str(waa_load_total_bps_avg[waa_idx_5]))
    print(str(waa_load_total_bps_avg[waa_idx_10]))
    print(str(waa_load_total_bps_avg[waa_idx_20]))
    print(str(dual_load_total_bps_avg[dual_idx_5]))
    print(str(dual_load_total_bps_avg[dual_idx_10]))
    print(str(dual_load_total_bps_avg[dual_idx_20]))
    print('----')
    dual_5_high=(dual_qdelay_high_avg[dual_idx_5]*1000)
    dual_5_med=dual_qdelay_med_avg[dual_idx_5]*1000
    dual_5_low=dual_qdelay_low_avg[dual_idx_5]*1000
    dual_10_high=dual_qdelay_high_avg[dual_idx_10]*1000
    dual_10_med=dual_qdelay_med_avg[dual_idx_10]*1000
    dual_10_low=dual_qdelay_low_avg[dual_idx_10]*1000
    dual_20_high=dual_qdelay_high_avg[dual_idx_20]*1000
    dual_20_med=dual_qdelay_med_avg[dual_idx_20]*1000
    dual_20_low=dual_qdelay_low_avg[dual_idx_20]*1000
    waa_5_high=(waa_qdelay_high_avg[waa_idx_5]*1000)*200
    waa_5_med=waa_qdelay_med_avg[waa_idx_5]*1000
    waa_5_low=waa_qdelay_low_avg[waa_idx_5]*1000
    waa_10_high=waa_qdelay_high_avg[waa_idx_10]*1000*200
    waa_10_med=waa_qdelay_med_avg[waa_idx_10]*1000
    waa_10_low=waa_qdelay_low_avg[waa_idx_10]*1000
    waa_20_high=waa_qdelay_high_avg[waa_idx_20]*1000*200
    waa_20_med=waa_qdelay_med_avg[waa_idx_20]*1000
    waa_20_low=waa_qdelay_low_avg[waa_idx_20]*1000
    print('dual_5_high='+str(dual_5_high))
    print('dual_5_med='+str(dual_5_med))
    print('dual_5_low='+str(dual_5_low))
    print('dual_10_high='+str(dual_10_high))
    print('dual_10_med='+str(dual_10_med))
    print('dual_10_low='+str(dual_10_low))
    print('dual_20_high='+str(dual_20_high))
    print('dual_20_med='+str(dual_20_med))
    print('dual_20_low='+str(dual_20_low))
    print('waa_5_high='+str(waa_5_high))
    print('waa_5_med='+str(waa_5_med))
    print('waa_5_low='+str(waa_5_low))
    print('waa_10_high='+str(waa_10_high))
    print('waa_10_med='+str(waa_10_med))
    print('waa_10_low='+str(waa_10_low))
    print('waa_20_high='+str(waa_20_high))
    print('waa_20_med='+str(waa_20_med))
    print('waa_20_low='+str(waa_20_low))

    fig, ax = plt.subplots()
    width=0.2
    pos_close=0.25
    pos_far=0.3
    pos_vfar=0.65

    pos=1
    label_1=pos
    ax.bar(pos, waa_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_1=(label_1+pos)/2
    ax.bar(pos, dual_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_2=pos
    ax.bar(pos, waa_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_2=(label_2+pos)/2
    ax.bar(pos, dual_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_3=pos
    ax.bar(pos, waa_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_3=(label_3+pos)/2
    ax.bar(pos, dual_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_vfar
    label_4=pos
    ax.bar(pos, waa_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_4=(label_4+pos)/2
    ax.bar(pos, dual_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_5=pos
    ax.bar(pos, waa_10_med, width, color='white',edgecolor='black',linewidth=3,label="            ", hatch='//')
    pos=pos+pos_close
    label_5=(label_5+pos)/2
    ax.bar(pos, dual_10_med, width, color='white',edgecolor='black',linewidth=3, label="            ", hatch='.')

    pos=pos+pos_far
    label_6=pos
    ax.bar(pos, waa_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_6=(label_6+pos)/2
    ax.bar(pos, dual_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_vfar
    label_7=pos
    ax.bar(pos, waa_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_7=(label_7+pos)/2
    ax.bar(pos, dual_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_8=pos
    ax.bar(pos, waa_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_8=(label_8+pos)/2
    ax.bar(pos, dual_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_9=pos
    ax.bar(pos, waa_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_9=(label_9+pos)/2
    ax.bar(pos, dual_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    x = [label_1,label_2,label_3,label_4,label_5,label_6,label_7,label_8,label_9]
    labels = ['high', 'med', 'low','high', 'med', 'low','high', 'med', 'low']

    plt.text(label_2-0.2,-20,'0.5',fontsize='xx-large',color='k')
    plt.text(label_5-0.2,-20,'1.0',fontsize='xx-large',color='k')
    plt.text(label_8-0.2,-20,'2.0',fontsize='xx-large',color='k')

    plt.xticks(x, labels, rotation='horizontal',fontsize=14)
    plt.yticks(fontsize=14)
    plt.tight_layout()
    plt.ylabel('Queuing Delay (ms)', fontsize=25)
    #plt.ylabel('Dropping Probability (%)', fontsize=25)
    #plt.title('Queuing Delay low qos', fontsize=25)
    plt.legend(loc="upper left", fontsize=20,frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.show()
def plot2_dropprob():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"
    dual_idx_5=None
    dual_idx_10=None
    dual_idx_20=None
    waa_idx_5=None
    waa_idx_10=None
    waa_idx_20=None
    refsmall=14e9
    refmed=25e9
    refbig=29e9

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_20=i
        i=i+1

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_20=i
        i=i+1

    print(str(waa_idx_5))
    print(str(waa_idx_10))
    print(str(waa_idx_20))
    print(str(dual_idx_5))
    print(str(dual_idx_10))
    print(str(dual_idx_20))
    print(str(waa_load_total_bps_avg[waa_idx_5]))
    print(str(waa_load_total_bps_avg[waa_idx_10]))
    print(str(waa_load_total_bps_avg[waa_idx_20]))
    print(str(dual_load_total_bps_avg[dual_idx_5]))
    print(str(dual_load_total_bps_avg[dual_idx_10]))
    print(str(dual_load_total_bps_avg[dual_idx_20]))
    print('----')
    dual_5_high=(dual_drop_prob_high_avg[dual_idx_5])
    dual_5_med=dual_drop_prob_med_avg[dual_idx_5]
    dual_5_low=dual_drop_prob_low_avg[dual_idx_5]
    dual_10_high=dual_drop_prob_high_avg[dual_idx_10]
    dual_10_med=dual_drop_prob_med_avg[dual_idx_10]
    dual_10_low=dual_drop_prob_low_avg[dual_idx_10]
    dual_20_high=dual_drop_prob_high_avg[dual_idx_20]
    dual_20_med=dual_drop_prob_med_avg[dual_idx_20]
    dual_20_low=dual_drop_prob_low_avg[dual_idx_20]
    waa_5_high=waa_drop_prob_high_avg[waa_idx_5]
    waa_5_med=waa_drop_prob_med_avg[waa_idx_5]
    waa_5_low=waa_drop_prob_low_avg[waa_idx_5]
    waa_10_high=waa_drop_prob_high_avg[waa_idx_10]
    waa_10_med=waa_drop_prob_med_avg[waa_idx_10]
    waa_10_low=waa_drop_prob_low_avg[waa_idx_10]
    waa_20_high=waa_drop_prob_high_avg[waa_idx_20]
    waa_20_med=waa_drop_prob_med_avg[waa_idx_20]
    waa_20_low=waa_drop_prob_low_avg[waa_idx_20]
    print('dual_5_high='+str(dual_5_high))
    print('dual_5_med='+str(dual_5_med))
    print('dual_5_low='+str(dual_5_low))
    print('dual_10_high='+str(dual_10_high))
    print('dual_10_med='+str(dual_10_med))
    print('dual_10_low='+str(dual_10_low))
    print('dual_20_high='+str(dual_20_high))
    print('dual_20_med='+str(dual_20_med))
    print('dual_20_low='+str(dual_20_low))
    print('waa_5_high='+str(waa_5_high))
    print('waa_5_med='+str(waa_5_med))
    print('waa_5_low='+str(waa_5_low))
    print('waa_10_high='+str(waa_10_high))
    print('waa_10_med='+str(waa_10_med))
    print('waa_10_low='+str(waa_10_low))
    print('waa_20_high='+str(waa_20_high))
    print('waa_20_med='+str(waa_20_med))
    print('waa_20_low='+str(waa_20_low))

    fig, ax = plt.subplots()
    width=0.2
    pos_close=0.25
    pos_far=0.3
    pos_vfar=0.65

    pos=1
    label_1=pos
    ax.bar(pos, waa_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_1=(label_1+pos)/2
    ax.bar(pos, dual_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_2=pos
    ax.bar(pos, waa_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_2=(label_2+pos)/2
    ax.bar(pos, dual_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_3=pos
    ax.bar(pos, waa_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_3=(label_3+pos)/2
    ax.bar(pos, dual_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_vfar
    label_4=pos
    ax.bar(pos, waa_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_4=(label_4+pos)/2
    ax.bar(pos, dual_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_5=pos
    ax.bar(pos, waa_10_med, width, color='white',edgecolor='black',linewidth=3,label="            ", hatch='//')
    pos=pos+pos_close
    label_5=(label_5+pos)/2
    ax.bar(pos, dual_10_med, width, color='white',edgecolor='black',linewidth=3, label="            ", hatch='.')

    pos=pos+pos_far
    label_6=pos
    ax.bar(pos, waa_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_6=(label_6+pos)/2
    ax.bar(pos, dual_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_vfar
    label_7=pos
    ax.bar(pos, waa_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_7=(label_7+pos)/2
    ax.bar(pos, dual_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_8=pos
    ax.bar(pos, waa_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_8=(label_8+pos)/2
    ax.bar(pos, dual_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_9=pos
    ax.bar(pos, waa_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_9=(label_9+pos)/2
    ax.bar(pos, dual_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    x = [label_1,label_2,label_3,label_4,label_5,label_6,label_7,label_8,label_9]
    labels = ['high', 'med', 'low','high', 'med', 'low','high', 'med', 'low']

    plt.text(label_2-0.2,-0.1,'0.5',fontsize='xx-large',color='k')
    plt.text(label_5-0.2,-0.1,'1.0',fontsize='xx-large',color='k')
    plt.text(label_8-0.2,-0.1,'2.0',fontsize='xx-large',color='k')

    plt.xticks(x, labels, rotation='horizontal',fontsize=14)
    plt.yticks(fontsize=14)
    plt.ylabel('Dropping Probability', fontsize=22)
    plt.legend(loc="upper left", fontsize=22,frameon=False)
    plt.grid(True, which='major', axis='both')
    #plt.tight_layout()
    plt.show()

def plot2_thru_per_server():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_thru_m4_node4_bps_avg = [1957440000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2526160000.0, 2412822857.142857,
                                 2579225600.0, 2413481290.322581, 2525952000.0, 2481360000.0, 2495387586.206897,
                                 2486680851.06383, 2486311724.137931, 2518965797.1014495, 2509277241.37931,
                                 2492142978.7234044, 2462530000.0, 2436733913.0434785, 2508294054.0540543, 2508225000.0,
                                 2488953333.3333335, 2496684800.0, 2245676190.4761906, 2271556923.076923,
                                 2472418461.5384617, 2517813333.3333335, 2575022222.2222223, 2377653333.3333335,
                                 2248400000.0, 2293090909.090909]
    waa_thru_m4_node3_bps_avg = [2622560000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2227440000.0, 2590468571.428571,
                                 2353612800.0, 2410978064.516129, 2448743384.6153846, 2494283636.3636365,
                                 2410994022.988506, 2446869787.2340426, 2436809195.402299, 2464714202.8985505,
                                 2409208275.862069, 2411710638.2978725, 2499166666.6666665, 2381053913.0434785,
                                 2494754594.5945945, 2391790000.0, 2613040000.0, 2512345600.0, 2494369523.8095236,
                                 2577858461.5384617, 2439913846.1538463, 2442693333.3333335, 2370471111.111111,
                                 2272226666.6666665, 2489960000.0, 2522312727.2727275]
    waa_thru_m4_node2_bps_avg = [3071840000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2189760000.0, 2443920000.0,
                                 2376780800.0, 2531220645.16129, 2461245538.4615383, 2454752727.2727275,
                                 2507777471.2643676, 2478313191.489362, 2509151264.367816, 2459863188.405797,
                                 2456082758.62069, 2539714042.5531917, 2486416666.6666665, 2569467826.0869565,
                                 2464259459.4594593, 2440965000.0, 2454626666.6666665, 2431328000.0, 2495779047.6190476,
                                 2622695384.6153846, 2517526153.8461537, 2503786666.6666665, 2302666666.6666665,
                                 2627773333.3333335, 2279680000.0, 2568014545.4545455]
    waa_thru_m4_node1_bps_avg = [2091040000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2917440000.0, 2383188571.428571,
                                 2528358400.0, 2482260645.16129, 2396440615.3846154, 2404054545.4545455,
                                 2419304827.586207, 2422534468.0851064, 2399034482.7586207, 2392753623.188406,
                                 2460121379.3103447, 2392571914.893617, 2385190000.0, 2448086956.521739,
                                 2368250810.810811, 2496160000.0, 2281613333.3333335, 2391481600.0, 2603779047.6190476,
                                 2359138461.5384617, 2408307692.3076925, 2376346666.6666665, 2592302222.2222223,
                                 2551280000.0, 2820320000.0, 2433614545.4545455]

    waa_thru_m8_node8_bps_avg = [942720000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1126080000.0, 1214400000.0,
                                 1195571200.0, 1149014193.548387, 1309127384.6153846, 1221638181.8181818,
                                 1231545747.1264367, 1207862127.6595745, 1167946666.6666667, 1259591884.057971,
                                 1246615172.413793, 1246365957.4468086, 1274166666.6666667, 1240240000.0,
                                 1263740540.5405405, 1312440000.0, 1294673333.3333333, 1338630400.0, 1109310476.1904762,
                                 1228541538.4615386, 1127704615.3846154, 1376560000.0, 1294808888.8888888, 1266680000.0,
                                 1294640000.0, 1147898181.8181818]
    waa_thru_m8_node7_bps_avg = [1235040000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1037360000.0, 1256628571.4285715,
                                 1128780800.0, 1205207741.935484, 1176992000.0, 1231883636.3636363, 1163354482.7586207,
                                 1295889361.7021277, 1274902068.9655173, 1295536231.884058, 1240515862.0689654,
                                 1265538723.4042554, 1197703333.3333333, 1205206956.5217392, 1330810810.8108108,
                                 1239005000.0, 1289140000.0, 1149689600.0, 1173805714.2857144, 1228824615.3846154,
                                 1202929230.7692308, 1365706666.6666667, 1193955555.5555556, 1094120000.0, 1091960000.0,
                                 1047752727.2727273]
    waa_thru_m8_node6_bps_avg = [1032000000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1008640000.0, 1238205714.2857144,
                                 1311852800.0, 1272312258.064516, 1203345230.7692308, 1254574545.4545455,
                                 1246125977.0114942, 1247962553.1914895, 1275810574.7126436, 1189597681.1594203,
                                 1241260689.6551723, 1246304680.8510637, 1214540000.0, 1200292173.9130435,
                                 1177656216.2162163, 1210675000.0, 1183713333.3333333, 1169753600.0, 1240076190.4761906,
                                 1405501538.4615386, 1147236923.0769231, 1047173333.3333334, 1164160000.0,
                                 1141466666.6666667, 1203360000.0, 1174269090.909091]
    waa_thru_m8_node5_bps_avg = [1444320000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1168880000.0, 1224617142.857143,
                                 1178771200.0, 1202918709.6774194, 1221299692.3076923, 1231412727.2727273,
                                 1206629885.0574713, 1235266382.9787233, 1222011954.0229886, 1249082898.5507247,
                                 1215826206.8965516, 1209773617.0212767, 1229510000.0, 1253499130.4347825,
                                 1170002162.162162, 1280655000.0, 1158820000.0, 1188806400.0, 1306575238.0952382,
                                 1306806153.8461537, 1375273846.1538463, 1078026666.6666667, 1277493333.3333333,
                                 1317960000.0, 1369000000.0, 1337672727.2727273]
    waa_thru_m8_node4_bps_avg = [2247360000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1466320000.0, 1252160000.0,
                                 1265228800.0, 1243698064.516129, 1221969230.7692308, 1222150909.090909,
                                 1242122298.8505747, 1217669787.2340426, 1277559540.229885, 1186988985.5072465,
                                 1244571034.4827585, 1250485106.3829787, 1188403333.3333333, 1243206956.5217392,
                                 1188462702.7027028, 1224245000.0, 1202113333.3333333, 1198963200.0, 1152099047.6190476,
                                 1154695384.6153846, 1265686153.8461537, 1171866666.6666667, 1204444444.4444444,
                                 1284666666.6666667, 1085280000.0, 1136421818.1818182]
    waa_thru_m8_node3_bps_avg = [862240000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1051440000.0, 1252422857.142857,
                                 1267878400.0, 1254379354.8387096, 1283128615.3846154, 1239241818.1818182,
                                 1270528735.6321838, 1239371914.893617, 1210718160.9195402, 1242884637.6811595,
                                 1161856551.724138, 1125137021.2765958, 1250706666.6666667, 1183182608.6956522,
                                 1186732972.9729729, 1174545000.0, 1217446666.6666667, 1271065600.0, 1288579047.6190476,
                                 1095680000.0, 1256147692.3076923, 1080160000.0, 1210542222.2222223, 1215520000.0,
                                 1147840000.0, 1345323636.3636363]
    waa_thru_m8_node2_bps_avg = [1780160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1917600000.0, 1106994285.7142856,
                                 1194752000.0, 1269120000.0, 1235630769.2307692, 1202889090.909091, 1250129655.1724138,
                                 1207598297.8723404, 1218674022.9885058, 1219612753.6231885, 1247302068.9655173,
                                 1266107234.0425532, 1297953333.3333333, 1283530434.7826087, 1270382702.7027028,
                                 1198740000.0, 1254413333.3333333, 1328384000.0, 1290720000.0, 1314572307.6923077,
                                 1228849230.7692308, 1536746666.6666667, 1226151111.1111112, 1306586666.6666667,
                                 1417200000.0, 1289512727.2727273]
    waa_thru_m8_node1_bps_avg = [342720000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1068640000.0, 1296640000.0,
                                 1298009600.0, 1244614193.548387, 1187337846.1538463, 1238485454.5454545,
                                 1231891494.2528737, 1190080000.0, 1193165977.0114942, 1193664927.536232,
                                 1241972413.7931035, 1227880851.06383, 1188000000.0, 1231182608.6956522,
                                 1254603243.2432432, 1201140000.0, 1244460000.0, 1192332800.0, 1282270476.1904762,
                                 1105501538.4615386, 1228369230.7692308, 1184853333.3333333, 1262453333.3333333,
                                 1211373333.3333333, 1233360000.0, 1353672727.2727273]

    waa_thru_m12_node12_bps_avg = [1056160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 661760000.0, 949314285.7142857,
                                   772102400.0, 827680000.0, 831955692.3076923, 866547272.7272727, 820950804.5977012,
                                   785831489.3617021, 829634942.5287356, 887353043.4782609, 817605517.2413793,
                                   847234042.5531915, 885373333.3333334, 798876521.7391304, 851792432.4324324,
                                   788405000.0, 758553333.3333334, 866796800.0, 747718095.2380953, 787790769.2307693,
                                   744393846.1538461, 764800000.0, 920551111.1111112, 787760000.0, 810200000.0,
                                   859738181.8181819]
    waa_thru_m12_node11_bps_avg = [871040000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 904320000.0, 755542857.1428572,
                                   762400000.0, 816686451.6129032, 834082461.5384616, 814874545.4545455,
                                   775946666.6666666, 846788085.106383, 806140689.6551725, 877495652.173913,
                                   865166896.5517242, 801542127.6595745, 789100000.0, 779805217.3913044,
                                   874425945.945946, 904415000.0, 864620000.0, 825177600.0, 856289523.8095238,
                                   750560000.0, 822572307.6923077, 917546666.6666666, 776160000.0, 804466666.6666666,
                                   714440000.0, 678240000.0]
    waa_thru_m12_node10_bps_avg = [1056160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1086880000.0, 814285714.2857143,
                                   829043200.0, 785948387.0967742, 758779076.9230769, 824536363.6363636,
                                   831518160.9195403, 829196595.7446809, 810530574.7126436, 829855072.4637681,
                                   806044137.9310344, 838696170.2127659, 800000000.0, 867196521.7391304,
                                   860147027.027027, 902255000.0, 883873333.3333334, 771616000.0, 797020952.3809524,
                                   798880000.0, 810584615.3846154, 882240000.0, 999128888.8888888, 800960000.0,
                                   835720000.0, 692974545.4545455]
    waa_thru_m12_node9_bps_avg = [936160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 651520000.0, 834982857.1428572,
                                  826336000.0, 772689032.2580645, 884300307.6923077, 827409090.9090909,
                                  839672643.6781609, 801045106.3829787, 855913563.2183908, 808222608.6956521,
                                  799817931.0344827, 849508085.106383, 851700000.0, 790160000.0, 847827027.027027,
                                  845365000.0, 907653333.3333334, 748537600.0, 829302857.1428572, 996381538.4615384,
                                  767187692.3076923, 861813333.3333334, 799982222.2222222, 810746666.6666666,
                                  940720000.0, 676610909.0909091]
    waa_thru_m12_node8_bps_avg = [633600000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 654080000.0, 857954285.7142857,
                                  821945600.0, 822356129.032258, 777353846.1538461, 782005454.5454545,
                                  817061149.4252874, 836148085.106383, 845804137.9310344, 816626086.9565217,
                                  814168275.862069, 778563404.2553191, 787103333.3333334, 880302608.6956521,
                                  823027027.027027, 789275000.0, 811266666.6666666, 840761600.0, 885104761.9047619,
                                  985858461.5384616, 849476923.0769231, 690106666.6666666, 887786666.6666666,
                                  914800000.0, 772520000.0, 824116363.6363636]
    waa_thru_m12_node7_bps_avg = [1236160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 987920000.0, 819462857.1428572,
                                  906355200.0, 825176774.1935484, 800672000.0, 811087272.7272727, 795681839.0804597,
                                  800149787.2340425, 832478160.9195403, 791923478.2608696, 797307586.2068965,
                                  821882553.1914893, 855960000.0, 809144347.826087, 778957837.8378378, 782015000.0,
                                  810580000.0, 877113600.0, 775801904.7619047, 800960000.0, 978510769.2307693,
                                  856080000.0, 823235555.5555556, 827240000.0, 948400000.0, 1078050909.090909]
    waa_thru_m12_node6_bps_avg = [811040000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1376640000.0, 825942857.1428572,
                                  805395200.0, 812325161.2903225, 840955076.9230769, 830336363.6363636,
                                  830122298.8505747, 833220425.531915, 808709885.0574713, 794330434.7826087,
                                  857635862.0689656, 845351489.3617021, 779930000.0, 787471304.3478261, 750560000.0,
                                  831005000.0, 763186666.6666666, 757625600.0, 829234285.7142857, 756270769.2307693,
                                  791249230.7692307, 693946666.6666666, 682666666.6666666, 815653333.3333334,
                                  690840000.0, 720712727.2727273]
    waa_thru_m12_node5_bps_avg = [518720000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 641280000.0, 806605714.2857143,
                                  739673600.0, 838880000.0, 852004923.0769231, 797958181.8181819, 849096091.954023,
                                  823564255.3191489, 830670344.8275862, 841270724.6376811, 853630344.8275862,
                                  805691914.893617, 808993333.3333334, 776003478.2608696, 771195675.6756756,
                                  777740000.0, 827820000.0, 892070400.0, 826620952.3809524, 788184615.3846154,
                                  941587692.3076923, 936933333.3333334, 799982222.2222222, 802240000.0, 858400000.0,
                                  807520000.0]
    waa_thru_m12_node4_bps_avg = [391040000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 646400000.0, 775897142.8571428,
                                  801881600.0, 803703225.8064516, 853715692.3076923, 794843636.3636364,
                                  803705747.1264368, 769251063.8297873, 797246896.5517242, 818460289.8550725,
                                  765464827.5862069, 815234042.5531915, 809473333.3333334, 749144347.826087,
                                  777059459.4594594, 763540000.0, 751846666.6666666, 798675200.0, 752022857.1428572,
                                  753427692.3076923, 763446153.8461539, 803946666.6666666, 820266666.6666666,
                                  752333333.3333334, 702640000.0, 793716363.6363636]
    waa_thru_m12_node3_bps_avg = [1111040000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 657920000.0, 776891428.5714285,
                                  836960000.0, 894348387.0967742, 824396307.6923077, 892372727.2727273,
                                  822578390.8045977, 876204255.3191489, 849908965.5172414, 789414492.7536232,
                                  877095172.4137931, 851142127.6595745, 829626666.6666666, 834674782.6086956,
                                  823117837.8378378, 854820000.0, 863933333.3333334, 875942400.0, 831725714.2857143,
                                  770510769.2307693, 735864615.3846154, 777120000.0, 796728888.8888888,
                                  907453333.3333334, 886480000.0, 846734545.4545455]
    waa_thru_m12_node2_bps_avg = [456160000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 655360000.0, 824765714.2857143,
                                  855340800.0, 781618064.516129, 769828923.0769231, 764032727.2727273,
                                  790160919.5402299, 808988936.1702127, 791203678.1609195, 772809275.3623189,
                                  790860689.6551725, 806267234.0425532, 822896666.6666666, 857819130.4347826,
                                  836674594.5945946, 766785000.0, 817013333.3333334, 863168000.0, 895855238.0952381,
                                  779741538.4615384, 786609230.7692307, 880533333.3333334, 712177777.7777778,
                                  801386666.6666666, 893160000.0, 861832727.2727273]
    waa_thru_m12_node1_bps_avg = [871040000.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 926640000.0, 794948571.4285715,
                                  884857600.0, 862812903.2258065, 812622769.2307693, 836692727.2727273,
                                  869268965.5172414, 836136170.2127659, 785627586.2068965, 812702608.6956521,
                                  799837241.3793104, 782689361.7021277, 825610000.0, 911464347.826087,
                                  847342702.7027028, 839980000.0, 785946666.6666666, 728313600.0, 817440000.0,
                                  882264615.3846154, 852320000.0, 761813333.3333334, 828195555.5555556, 814040000.0,
                                  792640000.0, 996000000.0]

    waa4=[waa_thru_m4_node1_bps_avg,waa_thru_m4_node2_bps_avg,waa_thru_m4_node3_bps_avg,waa_thru_m4_node4_bps_avg]
    waa8=[waa_thru_m8_node1_bps_avg,waa_thru_m8_node2_bps_avg,waa_thru_m8_node3_bps_avg,waa_thru_m8_node4_bps_avg,
          waa_thru_m8_node5_bps_avg,waa_thru_m8_node6_bps_avg,waa_thru_m8_node7_bps_avg,waa_thru_m8_node8_bps_avg]
    waa12=[waa_thru_m12_node1_bps_avg,waa_thru_m12_node2_bps_avg,waa_thru_m12_node3_bps_avg,waa_thru_m12_node4_bps_avg,
          waa_thru_m12_node5_bps_avg,waa_thru_m12_node6_bps_avg,waa_thru_m12_node7_bps_avg,waa_thru_m12_node8_bps_avg,
           waa_thru_m12_node9_bps_avg,waa_thru_m12_node10_bps_avg,waa_thru_m12_node11_bps_avg,waa_thru_m12_node12_bps_avg]

    for i in range(0,len(waa4)):
        waa4[i]=waa4[i][cutwaa:]
    for i in range(0,len(waa8)):
        waa8[i]=waa8[i][cutwaa:]
    for i in range(0,len(waa12)):
        waa12[i]=waa12[i][cutwaa:]

    thru4=[]
    for i in range(0,len(waa4[0])):
        sum=0
        N=0
        for el in waa4:
            sum=sum+el[i]
            N=N+1
        thru4.append(sum/N)
    print(len(thru4))
    thru8=[]
    for i in range(0,len(waa8[0])):
        sum=0
        N=0
        for el in waa8:
            sum=sum+el[i]
            N=N+1
        thru8.append(sum/N)
    print(len(thru8))
    thru12=[]
    for i in range(0,len(waa12[0])):
        sum=0
        N=0
        for el in waa12:
            sum=sum+el[i]
            N=N+1
        thru12.append(sum/N)

    thru4=[x/(1e9) for x in thru4]
    thru8=[x/(1e9) for x in thru8]
    thru12=[x/(1e9) for x in thru12]
    waa_load=[x/(10e9) for x in waa_load_total_bps_avg[cutwaa:]]

    plt.text(2,2.3,'N=4',fontsize='xx-large',color='k')
    plt.text(2,1.1,'N=8',fontsize='xx-large',color='k')
    plt.text(2,0.7,'N=12',fontsize='xx-large',color='k')

    plt.plot(waa_load, thru4,'k', label="m=4",linewidth=4)
    plt.plot(waa_load, thru8,'k', label="m=8",linewidth=4)
    plt.plot(waa_load, thru12,'k', label="m=12",linewidth=4)
    #plt.yticks(fontsize=14)
    #plt.xticks(fontsize=14)
    plt.xlabel('Normalized Load', fontsize=22)
    plt.ylabel('Throughput Per Server (Gbps)', fontsize=18)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 2.3, 0, y2))
    plt.tick_params(labelsize=14)
    #plt.legend(loc="upper left", fontsize=20)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot2_drop_per_server():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_drop_m4_node1_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 624320000.0, 686925714.2857143,
                                 759526400.0, 938843870.967742, 1195643076.9230769, 1428338181.8181818,
                                 1552840459.770115, 1712112340.4255319, 1585831724.137931, 1772670144.9275362,
                                 1792449655.1724138, 1503816170.212766, 1937693333.3333333, 1748281739.1304348,
                                 1637777297.2972972, 2071510000.0, 2145866666.6666667, 1729888000.0, 1272365714.2857144,
                                 1594461538.4615386, 3259040000.0, 2718106666.6666665, 1886506666.6666667,
                                 2164933333.3333335, 1926080000.0, 2371680000.0]
    waa_drop_m4_node2_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 251520000.0, 606205714.2857143,
                                 642457600.0, 892939354.8387097, 1114673230.7692308, 1333536363.6363637,
                                 1421559540.229885, 1649794042.5531914, 1734083678.1609194, 1830279420.289855,
                                 1770074482.7586207, 1886396595.744681, 2516556666.6666665, 2667582608.695652,
                                 2429474594.5945945, 3668315000.0, 2662386666.6666665, 3504697600.0, 3371009523.8095236,
                                 4979458461.538462, 4528381538.461538, 3440960000.0, 1686026666.6666667, 3236800000.0,
                                 5739280000.0, 4480145454.545455]
    waa_drop_m4_node3_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 480720000.0, 843222857.1428572,
                                 992652800.0, 1255378064.516129, 1408189538.4615386, 1333460000.0, 1566252873.5632184,
                                 1796112340.4255319, 2063347126.4367816, 2227329855.072464, 2811089655.172414,
                                 2600711489.361702, 2996923333.3333335, 3167440000.0, 3955900540.5405407, 3549740000.0,
                                 4112873333.3333335, 4360518400.0, 5161455238.095238, 2721021538.4615383,
                                 4214215384.6153846, 3390533333.3333335, 4022400000.0, 6576666666.666667, 7695520000.0,
                                 3803898181.818182]
    waa_drop_m4_node4_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 897600000.0, 742742857.1428572,
                                 991091200.0, 1118753548.387097, 1111721846.1538463, 1464187272.7272727,
                                 1506578390.8045976, 1695325957.4468086, 1729204597.7011495, 1728178550.7246377,
                                 1994124137.9310346, 2630461276.5957446, 2226436666.6666665, 2262699130.4347825,
                                 2169145945.9459457, 2751365000.0, 3137486666.6666665, 2641228800.0, 2370643809.5238094,
                                 1629464615.3846154, 2712012307.6923075, 5553226666.666667, 6189884444.444445,
                                 4510520000.0, 1121040000.0, 6704930909.090909]

    waa_drop_m8_node1_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 422000000.0, 350662857.14285713,
                                 331296000.0, 463277419.3548387, 529979076.9230769, 584965454.5454545,
                                 796575632.1839081, 781780425.531915, 630981149.4252874, 720136811.5942029,
                                 675318620.6896552, 623673191.4893616, 668980000.0, 792848695.6521739,
                                 686028108.1081082, 567790000.0, 831046666.6666666, 768288000.0, 532220952.38095236,
                                 603249230.7692307, 831089230.7692307, 688880000.0, 545920000.0, 746173333.3333334,
                                 867320000.0, 309003636.3636364]
    waa_drop_m8_node2_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1280000.0, 415805714.28571427, 359404800.0,
                                 449390967.7419355, 505248000.0, 649065454.5454545, 598937011.4942529,
                                 857356595.7446809, 1109677241.3793104, 956459130.4347826, 851166896.5517242,
                                 943686808.5106384, 1571436666.6666667, 1748942608.6956522, 1538175135.1351352,
                                 2285360000.0, 2066526666.6666667, 1953817600.0, 1884243809.5238094, 2441292307.6923075,
                                 2634116923.076923, 1277226666.6666667, 1061564444.4444444, 2239280000.0, 3276240000.0,
                                 2513163636.3636365]
    waa_drop_m8_node3_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 378640000.0, 315748571.4285714,
                                 529875200.0, 581052903.2258065, 630648615.3846154, 682494545.4545455,
                                 666144367.8160919, 871142127.6595745, 863628505.7471265, 970752463.768116,
                                 1275180689.6551723, 1346502127.6595745, 1153123333.3333333, 1532166956.5217392,
                                 2073245405.4054055, 1817150000.0, 2679773333.3333335, 1204128000.0, 2226483809.5238094,
                                 1676184615.3846154, 1350560000.0, 2161653333.3333335, 2194666666.6666665, 2697200000.0,
                                 4885800000.0, 2195810909.090909]
    waa_drop_m8_node4_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 523520000.0, 417714285.71428573,
                                 600000000.0, 561953548.3870968, 542653538.4615384, 726790909.0909091,
                                 744809195.4022988, 819072340.4255319, 932472643.6781609, 735482898.5507246,
                                 773205517.2413793, 1168313191.4893618, 979793333.3333334, 965210434.7826087,
                                 1100441081.0810812, 1324415000.0, 1612400000.0, 1428800000.0, 769196190.4761904,
                                 700418461.5384616, 537538461.5384616, 821680000.0, 2555680000.0, 1979960000.0,
                                 704880000.0, 1631141818.1818182]
    waa_drop_m8_node5_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 300000000.0, 343920000.0, 387340800.0,
                                 510139354.83870965, 646048000.0, 778536363.6363636, 759885977.0114943,
                                 846023829.7872341, 937314942.5287356, 977437681.1594203, 970182068.9655173,
                                 884255319.1489362, 1171360000.0, 880424347.826087, 853305945.945946, 1355945000.0,
                                 1623133333.3333333, 945312000.0, 717005714.2857143, 1305280000.0, 1274633846.1538463,
                                 1764960000.0, 1314240000.0, 1312346666.6666667, 1260880000.0, 1016552727.2727273]
    waa_drop_m8_node6_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 169200000.0, 306628571.4285714,
                                 278393600.0, 432593548.38709676, 593511384.6153846, 601110909.0909091,
                                 791753563.2183908, 750658723.4042553, 712114022.9885057, 972997101.4492754,
                                 916044137.9310344, 992493617.0212766, 989113333.3333334, 961311304.3478261,
                                 919576216.2162162, 1183280000.0, 980906666.6666666, 1422009600.0, 1112000000.0,
                                 2347495384.6153846, 1509587692.3076923, 1270640000.0, 447022222.2222222,
                                 1202506666.6666667, 596240000.0, 500174545.45454544]
    waa_drop_m8_node7_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 242000000.0, 622068571.4285715,
                                 465132800.0, 648960000.0, 748568615.3846154, 676492727.2727273, 853717701.1494253,
                                 864049361.7021277, 1165379310.3448277, 1193609275.3623188, 1572733793.1034484,
                                 1397708936.1702127, 1890546666.6666667, 1581206956.5217392, 1965807567.5675676,
                                 1830270000.0, 1444733333.3333333, 3261849600.0, 2092548571.4285715, 1140369230.7692308,
                                 2302498461.5384617, 919973333.3333334, 1343182222.2222223, 3144173333.3333335,
                                 2543360000.0, 210458181.8181818]
    waa_drop_m8_node8_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 420720000.0, 328240000.0, 422784000.0,
                                 549840000.0, 520859076.9230769, 697203636.3636364, 760259310.3448275, 798788085.106383,
                                 831924597.7011495, 969611594.2028985, 1225062068.9655173, 1428132765.9574468,
                                 1197230000.0, 1291380869.5652175, 944899459.4594594, 1371180000.0, 1662633333.3333333,
                                 1385824000.0, 1613394285.7142856, 637550769.2307693, 2037415384.6153846,
                                 6036346666.666667, 2962595555.5555553, 2115466666.6666667, 380760000.0,
                                 2905381818.181818]

    waa_drop_m12_node1_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30000000.0, 248354285.7142857,
                                  214310400.0, 284090322.58064514, 354845538.46153843, 408581818.1818182,
                                  391895172.4137931, 469424680.85106385, 591363678.1609195, 522281739.1304348,
                                  513947586.20689654, 562209361.7021277, 633886666.6666666, 765158260.8695652,
                                  630646486.4864864, 782130000.0, 849000000.0, 671206400.0, 782575238.0952381,
                                  711483076.9230769, 905132307.6923077, 716933333.3333334, 536853333.3333333,
                                  1057173333.3333334, 1089760000.0, 256523636.36363637]
    waa_drop_m12_node2_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 197920000.0, 209314285.7142857,
                                  238924800.0, 305383225.8064516, 361459692.3076923, 454963636.3636364,
                                  473259770.11494255, 541974468.0851064, 578806436.7816092, 549750724.6376811,
                                  574375172.4137931, 511036595.7446808, 743550000.0, 753673043.4782609,
                                  640990270.2702702, 960300000.0, 937600000.0, 713440000.0, 877699047.6190476,
                                  889033846.1538461, 1128209230.7692308, 637306666.6666666, 579377777.7777778,
                                  954920000.0, 1253840000.0, 168552727.27272728]
    waa_drop_m12_node3_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 261760000.0, 261840000.0, 269964800.0,
                                  344064516.12903225, 319938461.53846157, 386667272.72727275, 429287356.3218391,
                                  534978723.40425533, 509756321.83908045, 562212173.9130435, 504766896.55172414,
                                  482011914.89361703, 681190000.0, 786994782.6086956, 629876756.7567568, 914730000.0,
                                  807240000.0, 588704000.0, 700121904.7619047, 693501538.4615384, 1063544615.3846154,
                                  576933333.3333334, 526613333.3333333, 919586666.6666666, 1309080000.0,
                                  160174545.45454547]
    waa_drop_m12_node4_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 363280000.0, 226091428.57142857,
                                  387353600.0, 373205161.2903226, 409828923.0769231, 465701818.1818182,
                                  444722758.62068963, 569085957.4468085, 608104827.5862069, 534562318.8405797,
                                  668744827.5862069, 810382978.7234043, 744906666.6666666, 762754782.6086956,
                                  995442162.1621622, 989965000.0, 1318626666.6666667, 875411200.0, 1015687619.0476191,
                                  928172307.6923077, 576935384.6153846, 841013333.3333334, 1506915555.5555556,
                                  1683013333.3333333, 1661120000.0, 1115069090.909091]
    waa_drop_m12_node5_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 272000000.0, 174480000.0, 404460800.0,
                                  345917419.3548387, 351936000.0, 453878181.8181818, 454458850.57471263,
                                  531673191.4893617, 556491034.4827586, 563798260.8695652, 593633103.4482758,
                                  839465531.9148936, 666796666.6666666, 748121739.1304348, 1002058378.3783784,
                                  956720000.0, 1168893333.3333333, 856838400.0, 1017904761.9047619, 878953846.1538461,
                                  456603076.9230769, 805466666.6666666, 1578631111.1111112, 1512373333.3333333,
                                  2082680000.0, 1055665454.5454545]
    waa_drop_m12_node6_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 152560000.0, 227028571.42857143,
                                  352556800.0, 360503225.8064516, 400588307.6923077, 478561818.1818182,
                                  447065747.12643677, 536277446.80851066, 590350344.8275862, 591628985.5072464,
                                  549732413.7931035, 720268936.1702127, 719930000.0, 747586086.9565217,
                                  1066339459.4594594, 982315000.0, 1217666666.6666667, 910995200.0, 810209523.8095238,
                                  864886153.8461539, 514744615.38461536, 920213333.3333334, 1768497777.7777777,
                                  1649413333.3333333, 1633320000.0, 1019112727.2727273]
    waa_drop_m12_node7_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 355600000.0, 184880000.0, 214502400.0,
                                  249398709.67741936, 416886153.84615386, 434541818.1818182, 462618850.57471263,
                                  536878297.8723404, 486135172.4137931, 659675362.3188406, 588000000.0,
                                  604857872.3404255, 661713333.3333334, 613537391.3043479, 573543783.7837838,
                                  895735000.0, 707180000.0, 783507200.0, 830483809.5238096, 1398338461.5384614,
                                  602067692.3076923, 791386666.6666666, 691733333.3333334, 679586666.6666666,
                                  460600000.0, 244785454.54545453]
    waa_drop_m12_node8_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 229200000.0, 188697142.85714287,
                                  196985600.0, 319434838.7096774, 415677538.46153843, 446690909.09090906,
                                  536787126.4367816, 536737021.2765958, 522160919.54022986, 634193623.1884058,
                                  605075862.0689656, 664708085.106383, 657026666.6666666, 523554782.6086956,
                                  564021621.6216216, 730965000.0, 760166666.6666666, 704486400.0, 541401904.7619047,
                                  1044910769.2307693, 919815384.6153846, 903146666.6666666, 496817777.7777778,
                                  858400000.0, 478160000.0, 246545454.54545453]
    waa_drop_m12_node9_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 270720000.0, 125954285.71428572,
                                  213843200.0, 314926451.61290324, 331072000.0, 438485454.54545456, 484121379.3103448,
                                  547816170.2127659, 478777011.49425286, 631494492.7536232, 649431724.137931,
                                  606369361.7021277, 637856666.6666666, 621147826.0869565, 518192432.4324324,
                                  804255000.0, 667013333.3333334, 765580800.0, 702491428.5714285, 1109132307.6923077,
                                  697944615.3846154, 778213333.3333334, 633155555.5555556, 852600000.0, 452920000.0,
                                  266632727.27272728]
    waa_drop_m12_node10_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 190240000.0, 246240000.0, 255724800.0,
                                   371254193.5483871, 451428923.0769231, 454901818.1818182, 479172413.79310346,
                                   494408510.63829786, 604976551.7241379, 647587246.3768116, 922402758.6206896,
                                   938260425.531915, 1047820000.0, 935196521.7391304, 1070313513.5135136, 940315000.0,
                                   874966666.6666666, 1319795200.0, 1395260952.3809524, 636344615.3846154,
                                   1157169230.7692308, 2032826666.6666667, 1521511111.1111112, 1820720000.0,
                                   944800000.0, 619505454.5454545]
    waa_drop_m12_node11_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96400000.0, 330434285.71428573,
                                   319820800.0, 355122580.6451613, 362040615.38461536, 443620000.0, 500391724.13793105,
                                   508148085.10638297, 648307126.4367816, 668282898.5507246, 895597241.3793104,
                                   965964255.3191489, 1125026666.6666667, 956382608.6956521, 955481081.081081,
                                   1054015000.0, 852220000.0, 1410790400.0, 1285112380.952381, 592160000.0,
                                   1091372307.6923077, 2044533333.3333333, 1237084444.4444444, 1625426666.6666667,
                                   808520000.0, 639898181.8181819]
    waa_drop_m12_node12_bps_avg = [0.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 286640000.0, 298502857.14285713,
                                   239904000.0, 362544516.12903225, 409412923.0769231, 433623636.3636364,
                                   533267126.4367816, 545108085.106383, 597645977.0114943, 638675942.0289855,
                                   920819310.3448275, 985773617.0212766, 931450000.0, 921085217.3913044,
                                   1079827027.0270271, 1154905000.0, 1056953333.3333334, 1255584000.0,
                                   1339984761.9047618, 595987692.3076923, 1304972307.6923077, 2212080000.0,
                                   1535662222.2222223, 2088066666.6666667, 907480000.0, 430036363.6363636]

    waa4=[waa_drop_m4_node1_bps_avg,waa_drop_m4_node2_bps_avg,waa_drop_m4_node3_bps_avg,waa_drop_m4_node4_bps_avg]
    waa8=[waa_drop_m8_node1_bps_avg,waa_drop_m8_node2_bps_avg,waa_drop_m8_node3_bps_avg,waa_drop_m8_node4_bps_avg,
          waa_drop_m8_node5_bps_avg,waa_drop_m8_node6_bps_avg,waa_drop_m8_node7_bps_avg,waa_drop_m8_node8_bps_avg]
    waa12=[waa_drop_m12_node1_bps_avg,waa_drop_m12_node2_bps_avg,waa_drop_m12_node3_bps_avg,waa_drop_m12_node4_bps_avg,
          waa_drop_m12_node5_bps_avg,waa_drop_m12_node6_bps_avg,waa_drop_m12_node7_bps_avg,waa_drop_m12_node8_bps_avg,
           waa_drop_m12_node9_bps_avg,waa_drop_m12_node10_bps_avg,waa_drop_m12_node11_bps_avg,waa_drop_m12_node12_bps_avg]

    for i in range(0,len(waa4)):
        waa4[i]=waa4[i][cutwaa:]
    for i in range(0,len(waa8)):
        waa8[i]=waa8[i][cutwaa:]
    for i in range(0,len(waa12)):
        waa12[i]=waa12[i][cutwaa:]

    thru4=[]
    for i in range(0,len(waa4[0])):
        sum=0
        N=0
        for el in waa4:
            sum=sum+el[i]
            N=N+1
        thru4.append(sum/N)
    print(len(thru4))
    thru8=[]
    for i in range(0,len(waa8[0])):
        sum=0
        N=0
        for el in waa8:
            sum=sum+el[i]
            N=N+1
        thru8.append(sum/N)
    print(len(thru8))
    thru12=[]
    for i in range(0,len(waa12[0])):
        sum=0
        N=0
        for el in waa12:
            sum=sum+el[i]
            N=N+1
        thru12.append(sum/N)

    thru4=[x/(1e9) for x in thru4]
    thru8=[x/(1e9) for x in thru8]
    thru12=[x/(1e9) for x in thru12]
    waa_load=[x/(10e9) for x in waa_load_total_bps_avg[cutwaa:]]

    plt.text(2,2.8,'N=4',fontsize='xx-large',color='k')
    plt.text(2,1.4,'N=8',fontsize='xx-large',color='k')
    plt.text(2,0.5,'N=12',fontsize='xx-large',color='k')

    plt.plot(waa_load, thru4,'k', label="m=4",linewidth=4)
    plt.plot(waa_load, thru8,'k', label="m=8",linewidth=4)
    plt.plot(waa_load, thru12,'k', label="m=12",linewidth=4)
    #plt.yticks(fontsize=14)
    #plt.xticks(fontsize=14)
    plt.xlabel('Normalized Load', fontsize=22)
    plt.ylabel('Rate of Dropped Packets Per Server (Gbps)', fontsize=16)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, 2.3, 0, y2))
    plt.tick_params(labelsize=14)
    #plt.legend(loc="upper left", fontsize=20)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot2_delay_per_server():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_delay_m4_node1_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0017500916060134877, 0.0006857248195200854,
                              0.000908349638507983, 0.0009635057325390923, 0.0008706077908269167, 0.0009607021157266583,
                              0.0010997646209372433, 0.0011323649378645593, 0.0012495094077896135,
                              0.0011922629750698317, 0.0012148601801972077, 0.001103854267686691, 0.001065606949414787,
                              0.0012496612301860432, 0.0010498621343189483, 0.0016250032703279873,
                              0.0015802823247436516, 0.001106882161240154, 0.0016113261671100354, 0.0023649525705964456,
                              0.0016998588775772735, 0.0010057952421583661, 0.0021356109598968513,
                              0.0016390553217975883, 0.0019972777021801864, 0.002401373134619222]
    waa_delay_m4_node2_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00042955908927206515, 0.0008524529943179777,
                              0.0010620595214524073, 0.0010895546709143705, 0.0010293993058481114,
                              0.0011328866448330236, 0.0013249311782338555, 0.0014271358484509492,
                              0.0014775437269620641, 0.0014435935045193238, 0.0012493139675326815,
                              0.0017131855563577904, 0.001635245239226389, 0.0018856718797500517, 0.0019050045833196153,
                              0.001644804147134662, 0.0021003396863770785, 0.0022561682878204222, 0.0020886165650210392,
                              0.0028275204424638898, 0.001981081719901658, 0.0025626541202974145, 0.001885501457303138,
                              0.0024468332746455023, 0.0012999370191753114, 0.0021849657451195126]
    waa_delay_m4_node3_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0009443416142899166, 0.001191235668253488,
                              0.0008841300660498314, 0.0011147723785366204, 0.00121551585466511, 0.001364775370840406,
                              0.0014220410823224802, 0.0015754173148514617, 0.0016021394206795585,
                              0.0018730744440332093, 0.0020207710881263684, 0.0016789766640314071, 0.002141791158222939,
                              0.0015530995849111359, 0.002577114969561241, 0.001525476277515406, 0.002342715349702247,
                              0.001994028383529492, 0.0020579631121698237, 0.002997702262209636, 0.002162729879601685,
                              0.0015954841804822245, 0.0013432026117777475, 0.0016263589555927272, 0.003222157704622669,
                              0.0019652754097797447]
    waa_delay_m4_node4_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00036421356692279815, 0.0007669841415614879,
                              0.0012689265851000041, 0.000986875829852306, 0.0013304449926660575, 0.0012623689617223353,
                              0.0012843407162899455, 0.00134319857453332, 0.0013605561221825416, 0.0014301766762024497,
                              0.001464754242170516, 0.0015593723587300078, 0.0015018031615484332, 0.0019785039303041956,
                              0.0016641099763838219, 0.0014775240686666772, 0.0017746027815233943, 0.001706868884943682,
                              0.0015738981088890055, 0.0016401252934352321, 0.002310290999734834, 0.0024879982389028154,
                              0.003368873383524559, 0.001892107739288449, 0.001632456083375528, 0.002246738771041578]

    waa_delay_m8_node1_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0011142869118180745, 0.0016503543030706891,
                              0.0015971143973801442, 0.0012231528471387555, 0.0012313538581715815,
                              0.0018519415236637883, 0.001618904266687764, 0.0015467783719967938, 0.0018128292999206248,
                              0.0018239128811476206, 0.0021012930399938257, 0.0017514138807659552, 0.001883305014381744,
                              0.0017221768696216561, 0.0017582150559519842, 0.001536371991969191, 0.0016458852079492216,
                              0.0014278115648825994, 0.0023031099226435967, 0.0016477324892928402, 0.003477165852773931,
                              0.0018322504322287306, 0.001972132270873068, 0.0011331192649677384, 0.0012613225513695018,
                              0.002437628484970776]
    waa_delay_m8_node2_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0010404190288894526, 0.0007665537202515524,
                              0.0013406883121711507, 0.001782161663612014, 0.0014555442670884785, 0.0015826790318359527,
                              0.001727650252697951, 0.0019122184496700133, 0.0013990526380594742, 0.0022451172621480776,
                              0.0015622774068350307, 0.00259346968565172, 0.00279738111501028, 0.003164724684721025,
                              0.0034524896111523123, 0.002612191241376254, 0.0033287145557117375, 0.003975155303955734,
                              0.004213675609441855, 0.0035936972283240293, 0.004694681317729385, 0.006563988106599526,
                              0.0017475408155158076, 0.004507289280466695, 0.011821773252112129, 0.004045196568431464]
    waa_delay_m8_node3_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.0591449198046062e-05, 0.0012796204750367018,
                              0.002226436044406381, 0.0014666051736007318, 0.0022826089605710153, 0.0018549124018597222,
                              0.0021509445577223745, 0.002492649499564619, 0.002168739253694286, 0.002803948442756596,
                              0.0028972496006856407, 0.002398468608486021, 0.003325626259974567, 0.002268685784986867,
                              0.0018874841944866692, 0.0009540211015697568, 0.0036698254118385926,
                              0.0031472923772514995, 0.0025250229054290547, 0.0045054695712509465, 0.003981619256879463,
                              0.0016518408899148284, 0.0009376815721082301, 0.0029621897988134373,
                              0.0074800415401420186, 0.005973389224079703]
    waa_delay_m8_node4_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9.893282367158938e-06, 0.0009405275555229135,
                              0.001753406417706287, 0.0016035066604675107, 0.0019056564205657874, 0.0016955487945595792,
                              0.0017051587276909741, 0.00213145400964258, 0.001777093895809175, 0.002031752850017122,
                              0.0015307107790569333, 0.0022471460038211125, 0.0017709157482249953, 0.002511108830348058,
                              0.002329667337391245, 0.001843571739082742, 0.0016085340850429037, 0.0024406325429738385,
                              0.0017707764548834345, 0.003914142030928894, 0.0037211991000253622, 0.001153853832353118,
                              0.0040527210224777154, 0.0038662794292739014, 0.002996011696169496, 0.006804664241505436]
    waa_delay_m8_node5_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004663483586166068, 0.0007663799124418116,
                              0.0014457600873204598, 0.0014064949957420733, 0.002021280204448303, 0.001387237391307231,
                              0.0017386424253948583, 0.0026648376308339226, 0.0018332347140875905,
                              0.0022673698008861694, 0.001828315557731235, 0.0024181621075035713, 0.00220861324705785,
                              0.002506041545934597, 0.0016477110673820056, 0.00353910510053477, 0.0028381176294677304,
                              0.0021311991710153415, 0.0022673585819150102, 0.005458383875633158, 0.00399450337655305,
                              0.001503681293515269, 0.00410805669050128, 0.002784833824786418, 0.0012818381601155102,
                              0.006744750505319905]
    waa_delay_m8_node6_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00011130777381965733, 0.0006217935280453542,
                              0.0015390394682893358, 0.001405901797970814, 0.0015304249547458825, 0.0017354844942153236,
                              0.0015801542159164853, 0.0022052911356087996, 0.0022877883066690927,
                              0.0017193885721499555, 0.0019811689572328275, 0.002349559142475342, 0.0018053801593882293,
                              0.0022926124806134968, 0.0027676742122364284, 0.0030636615941652292,
                              0.0015813146142926143, 0.003721897973659917, 0.004773527137774176, 0.004676422554639223,
                              0.0033792394752250633, 0.004670598542695768, 0.003165899346064396, 0.0030295353257938904,
                              0.0010648156553970858, 0.005475905921037709]
    waa_delay_m8_node7_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.970337471603035e-05, 0.0016181444068892122,
                              0.0009680512304660056, 0.0015521831172989435, 0.0014822244341117583,
                              0.0018718901174285994, 0.0018158498370120628, 0.0021713989057946365,
                              0.0020903559981212076, 0.0023877948707935214, 0.0024867845222835924, 0.001889826375851399,
                              0.0026036425581643196, 0.0023577267600047476, 0.0035882909360393546, 0.002145079758929999,
                              0.002268529437165368, 0.0022165751176049836, 0.003475168130263221, 0.00265210357525546,
                              0.0027575842961184865, 0.0027051669205363595, 0.0022182765318470928,
                              0.0043661886456236665, 0.0010777579869177306, 0.004157087715642491]
    waa_delay_m8_node8_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0317445173144504e-05, 0.001170271079413722,
                              0.0015967010035058816, 0.0011709533092189826, 0.0016431293833794266, 0.001492984706052079,
                              0.0019263447740054886, 0.00204111931976907, 0.0020862202059112483, 0.002733830538956256,
                              0.0026951653334809913, 0.0024515834607307476, 0.002903218458216802, 0.004651793849867327,
                              0.002775406604941075, 0.0031257462848172123, 0.0026477681519008487, 0.0033780912361878555,
                              0.0031806756190376636, 0.0016430266251610494, 0.003141657809219598, 0.007610221468662538,
                              0.009662724956339443, 0.0018933122122412663, 0.0015102865280329804, 0.005192823877282001]

    waa_delay_m12_node3_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00036592298535244555, 0.0018254707132437096,
                               0.001850287173942983, 0.0018786991699899671, 0.0019394294330761655, 0.002222042557434375,
                               0.0027582231509265054, 0.0025036474955633836, 0.002889920755883502,
                               0.0028206309213108373, 0.0035202977422441805, 0.002621212351695018,
                               0.0033813613403494004, 0.003144396950626248, 0.003971147597252008, 0.004616065611273165,
                               0.0046526781786373475, 0.006269073195704492, 0.0035042604240606576, 0.004626315287218344,
                               0.007730388371072014, 0.005528981710662734, 0.00245734698738191, 0.004151192345009917,
                               0.007132490242528369, 0.00957161875966897]
    waa_delay_m12_node2_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0005736539837966344, 0.002985143832878586,
                               0.002460579183514659, 0.0021030623918539383, 0.002081708883766656, 0.00202133762037028,
                               0.0024925151123404597, 0.0028215002757648105, 0.002527599375410196, 0.003007335384027036,
                               0.0024741604765477674, 0.0028682079007711185, 0.003771422823815202, 0.005612468601968214,
                               0.005528796385049581, 0.004373359874360735, 0.005192128104785453, 0.005580838967813072,
                               0.004332551758263487, 0.005134957291082859, 0.008105432643359221, 0.010564937745058182,
                               0.0037118132325906395, 0.006589386919423041, 0.008218093500740663, 0.007659360348951059]
    waa_delay_m12_node1_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004219005398677657, 0.0015189531569059383,
                               0.0020901418001209697, 0.0030075529727450244, 0.0019361945199601526,
                               0.0027959745070829673, 0.003329858273286835, 0.00298902553738472, 0.001832944739120323,
                               0.0031941711559880025, 0.00262869338521286, 0.0025623516501871784, 0.004032695596806301,
                               0.0042322500574869595, 0.004125481094069938, 0.004711001729590228, 0.0027390066919702007,
                               0.004263254082521656, 0.0039730303583669115, 0.004797724414943826, 0.010297047284296888,
                               0.004682372526257425, 0.0011545727318205586, 0.004392314410756212, 0.008529895336830079,
                               0.006889234106594481]
    waa_delay_m12_node4_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5.201270138069431e-05, 0.0019838600125039224,
                               0.0017730971027591792, 0.0018009177741572931, 0.00230238655501843, 0.0024987241623318827,
                               0.0025666733170732693, 0.002898156970428956, 0.002711379502383249, 0.004082877933737131,
                               0.0038402610694573936, 0.003708548655409318, 0.004006533567692932, 0.004666340765751122,
                               0.0034676191926760044, 0.00311420010800795, 0.0056198250468963, 0.004955020946298918,
                               0.002360766936837268, 0.00458712557433871, 0.005745075248397255, 0.003920478531926153,
                               0.0030443773190512585, 0.003055823801050891, 0.007597672803398447, 0.016276574818252402]
    waa_delay_m12_node5_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5.01427098756216e-05, 0.0015909636973772984,
                               0.0018878757440391875, 0.002484381481264854, 0.0026557139799673925,
                               0.0023152904612385073, 0.002877948568790525, 0.0032723761120461944,
                               0.0026623576444563045, 0.0033516164422739162, 0.003993800794308973,
                               0.0033666376581715307, 0.0029498556810504234, 0.004375340103366012,
                               0.0029477428836153135, 0.0029635921002079562, 0.0064155179229672685,
                               0.0035064740190130102, 0.0033705586829002074, 0.004615897033826681, 0.005642504602218623,
                               0.003557316479401429, 0.004838265790512956, 0.006168800563452831, 0.008625959986965474,
                               0.010152601539320554]
    waa_delay_m12_node6_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004055335988095711, 0.0009870591981129473,
                               0.0025497047993401556, 0.002702484419400806, 0.0029875033982184117, 0.002391168941269882,
                               0.002676691535815528, 0.003332536799612748, 0.002086387043823948, 0.0036188790986686585,
                               0.005383904107361139, 0.004090488093130616, 0.00326722470773693, 0.0037964647514082657,
                               0.0034950980428416836, 0.0028362848181859367, 0.0044407571061698, 0.003059569888385396,
                               0.004804747127840971, 0.005295888685095381, 0.005124808170648126, 0.0017386853402173318,
                               0.0012665545830054647, 0.004929332813845895, 0.0038279448411908837, 0.009574545618470038]
    waa_delay_m12_node7_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00014905595521886268, 0.0009835344089480114,
                               0.00242713779526041, 0.002178761204423257, 0.0017193569452133026, 0.0017330732637992731,
                               0.0017702342730573097, 0.0022776014160467745, 0.0031311640654433956,
                               0.0022883603376673434, 0.0024815653642662697, 0.0024754186583202686,
                               0.0031617052382159243, 0.0030061414320404736, 0.0031625893225276447,
                               0.003397119797764819, 0.005477716452960398, 0.0045528845799841225, 0.0017460846599649331,
                               0.0031315013277923754, 0.007821269185140657, 0.007899330211202264, 0.005658626679282335,
                               0.005193733692044853, 0.0025443828153875717, 0.012797827114973423]
    waa_delay_m12_node8_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0012717239654370523, 0.001548185462964985,
                               0.0024201198671048555, 0.0019026791125084767, 0.0023340824125909054,
                               0.002025919185627843, 0.002321130745063573, 0.003242915445262119, 0.003289976921051575,
                               0.002761433126447717, 0.003307765860821263, 0.0021496671219743283, 0.0034182180675695006,
                               0.004178073297523805, 0.0036424402566676427, 0.005389513724059809, 0.006537840427442803,
                               0.005644688356604968, 0.006267480920302888, 0.007620594488615985, 0.003587192245541426,
                               0.004594806750425407, 0.0063447031183535806, 0.006791932474181895, 0.0039210070599005956,
                               0.008687028199082913]
    waa_delay_m12_node9_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0983606403247073e-05, 0.001235953946149532,
                               0.0019025016510020802, 0.0016639818802789078, 0.003046871506210841, 0.002810191255771434,
                               0.0025673400150923284, 0.0025199863113705145, 0.0034237926712720637,
                               0.0026409127086919576, 0.002180286581094617, 0.0037139584760018875,
                               0.0034051474994169274, 0.002962146344404671, 0.003405250779192659, 0.0066038147264570095,
                               0.005771377636297355, 0.004669686743708112, 0.0025420135863571027, 0.007702064712207338,
                               0.0050932929403288175, 0.006960168678732222, 0.005623164848391401, 0.002988282480859485,
                               0.005684360567836496, 0.007752265624759252]
    waa_delay_m12_node10_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0009043833825740368, 0.0023289687057951947,
                                0.002230627395088761, 0.001538266158616628, 0.0016595115295903044, 0.002057711034517349,
                                0.0030364616284703208, 0.003311119983267131, 0.0030288235143111054,
                                0.004166788286714983, 0.004066611708122307, 0.0037392502725695042, 0.003208766297705688,
                                0.004942175786559519, 0.0036072669832791756, 0.004695647378291106, 0.006369648205829477,
                                0.0052141715605869, 0.0041083083607329225, 0.0023687724937113313, 0.006146360159426029,
                                0.009842998565626341, 0.007495378496577971, 0.0042816098863978375,
                                0.0027847093236418614, 0.007209534236732684]
    waa_delay_m12_node11_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0019710213076329546, 0.0011259965743957902,
                                0.001763397349774428, 0.0027412551211320785, 0.0031053073480144496,
                                0.0023964209353486044, 0.0029131844044471846, 0.00343524402240866,
                                0.0031653009078537807, 0.004368188998775931, 0.004146197828458572, 0.003221212743474945,
                                0.003007300404993572, 0.0046892176859127015, 0.004913824959140468, 0.004226703371241686,
                                0.0052329448008682465, 0.005563896952643806, 0.006815501855754028, 0.002146685875022878,
                                0.005951557594970479, 0.008968331235414845, 0.007592337491073224, 0.0070500047872546975,
                                0.0023637276079001334, 0.0065755800855780405]
    waa_delay_m12_node12_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001995417465018875, 0.0021751355379851156,
                                0.0017032518795935328, 0.0024524763642594215, 0.0024842863557171403,
                                0.002117793105691702, 0.0024525030811503477, 0.0026656364265790103,
                                0.003271245090516979, 0.004513233787001017, 0.003637261020066287, 0.0031182949262464166,
                                0.004091123287440307, 0.0051733663460498255, 0.004265879545306882, 0.002018882451045573,
                                0.003745853014422285, 0.005989000532813917, 0.005003245697363627, 0.0019055727131450215,
                                0.005522996405751053, 0.005759847630942015, 0.006932053298176623, 0.0026177321490426036,
                                0.0010852183384606683, 0.010910603532340694]

    waa4=[waa_delay_m4_node1_avg,waa_delay_m4_node2_avg,waa_delay_m4_node3_avg,waa_delay_m4_node4_avg]
    waa8=[waa_delay_m8_node1_avg,waa_delay_m8_node2_avg,waa_delay_m8_node3_avg,waa_delay_m8_node4_avg,
          waa_delay_m8_node5_avg,waa_delay_m8_node6_avg,waa_delay_m8_node7_avg,waa_delay_m8_node8_avg]
    waa12=[waa_delay_m12_node1_avg,waa_delay_m12_node2_avg,waa_delay_m12_node3_avg,waa_delay_m12_node4_avg,
          waa_delay_m12_node5_avg,waa_delay_m12_node6_avg,waa_delay_m12_node7_avg,waa_delay_m12_node8_avg,
           waa_delay_m12_node9_avg,waa_delay_m12_node10_avg,waa_delay_m12_node11_avg,waa_delay_m12_node12_avg]

    for i in range(0,len(waa4)):
        waa4[i]=waa4[i][cutwaa:]
    for i in range(0,len(waa8)):
        waa8[i]=waa8[i][cutwaa:]
    for i in range(0,len(waa12)):
        waa12[i]=waa12[i][cutwaa:]

    thru4=[]
    for i in range(0,len(waa4[0])):
        sum=0
        N=0
        for el in waa4:
            sum=sum+el[i]
            N=N+1
        thru4.append(sum/N)
    print(len(thru4))
    thru8=[]
    for i in range(0,len(waa8[0])):
        sum=0
        N=0
        for el in waa8:
            sum=sum+el[i]
            N=N+1
        thru8.append(sum/N)
    print(len(thru8))
    thru12=[]
    for i in range(0,len(waa12[0])):
        sum=0
        N=0
        for el in waa12:
            sum=sum+el[i]
            N=N+1
        thru12.append(sum/N)

    thru4=[x*1000 for x in thru4]
    thru8=[x*1000 for x in thru8]
    thru12=[x*1000 for x in thru12]
    waa_load=[x/(10e9) for x in waa_load_total_bps_avg[cutwaa:]]
    waa_thru=[x/(1e9) for x in waa_thru_total_bps_avg[cutwaa:]]

    plt.text(8.5,0.3,'N=4, N=8',fontsize='xx-large',color='k')
    #plt.text(9,2.1,'N=8',fontsize='xx-large',color='k')
    plt.text(8.5,1.7,'N=12',fontsize='xx-large',color='k')

    plt.plot(waa_thru, thru4,'k', label="m=4",linewidth=4)
    plt.plot(waa_thru, thru8,'k', label="m=8",linewidth=4)
    plt.plot(waa_thru, thru12,'k', label="m=12",linewidth=4)
    #plt.yticks(fontsize=14)
    #plt.xticks(fontsize=14)
    plt.xlabel('Throughput (Gbps)', fontsize=22)
    plt.ylabel('Total Delay (ms)', fontsize=22)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, x2, 0, y2))
    plt.tick_params(labelsize=14)
    #plt.legend(loc="upper left", fontsize=20)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot2_queuing_per_server():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"
    node4_idx_5=None
    node4_idx_10=None
    node4_idx_20=None
    node8_idx_5=None
    node8_idx_10=None
    node8_idx_20=None
    node12_idx_5=None
    node12_idx_10=None
    node12_idx_20=None
    refsmall=14e9
    refmed=17e9
    refbig=25e9

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(dual_load_total_bps_avg):
        new_diff=abs(dual_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            dual_idx_20=i
        i=i+1

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa_idx_20=i
        i=i+1

    print(str(waa_idx_5))
    print(str(waa_idx_10))
    print(str(waa_idx_20))
    print(str(dual_idx_5))
    print(str(dual_idx_10))
    print(str(dual_idx_20))
    print(str(waa_load_total_bps_avg[waa_idx_5]))
    print(str(waa_load_total_bps_avg[waa_idx_10]))
    print(str(waa_load_total_bps_avg[waa_idx_20]))
    print(str(dual_load_total_bps_avg[dual_idx_5]))
    print(str(dual_load_total_bps_avg[dual_idx_10]))
    print(str(dual_load_total_bps_avg[dual_idx_20]))
    print('----')
    dual_5_high=(dual_qdelay_high_avg[dual_idx_5]*1000)
    dual_5_med=dual_qdelay_med_avg[dual_idx_5]*1000
    dual_5_low=dual_qdelay_low_avg[dual_idx_5]*1000
    dual_10_high=dual_qdelay_high_avg[dual_idx_10]*1000
    dual_10_med=dual_qdelay_med_avg[dual_idx_10]*1000
    dual_10_low=dual_qdelay_low_avg[dual_idx_10]*1000
    dual_20_high=dual_qdelay_high_avg[dual_idx_20]*1000
    dual_20_med=dual_qdelay_med_avg[dual_idx_20]*1000
    dual_20_low=dual_qdelay_low_avg[dual_idx_20]*1000
    waa_5_high=(waa_qdelay_high_avg[waa_idx_5]*1000)*300
    waa_5_med=waa_qdelay_med_avg[waa_idx_5]*1000
    waa_5_low=waa_qdelay_low_avg[waa_idx_5]*1000
    waa_10_high=waa_qdelay_high_avg[waa_idx_10]*1000
    waa_10_med=waa_qdelay_med_avg[waa_idx_10]*1000
    waa_10_low=waa_qdelay_low_avg[waa_idx_10]*1000
    waa_20_high=waa_qdelay_high_avg[waa_idx_20]*1000
    waa_20_med=waa_qdelay_med_avg[waa_idx_20]*1000
    waa_20_low=waa_qdelay_low_avg[waa_idx_20]*1000
    print('dual_5_high='+str(dual_5_high))
    print('dual_5_med='+str(dual_5_med))
    print('dual_5_low='+str(dual_5_low))
    print('dual_10_high='+str(dual_10_high))
    print('dual_10_med='+str(dual_10_med))
    print('dual_10_low='+str(dual_10_low))
    print('dual_20_high='+str(dual_20_high))
    print('dual_20_med='+str(dual_20_med))
    print('dual_20_low='+str(dual_20_low))
    print('waa_5_high='+str(waa_5_high))
    print('waa_5_med='+str(waa_5_med))
    print('waa_5_low='+str(waa_5_low))
    print('waa_10_high='+str(waa_10_high))
    print('waa_10_med='+str(waa_10_med))
    print('waa_10_low='+str(waa_10_low))
    print('waa_20_high='+str(waa_20_high))
    print('waa_20_med='+str(waa_20_med))
    print('waa_20_low='+str(waa_20_low))

    fig, ax = plt.subplots()
    width=0.2
    pos_close=0.25
    pos_far=0.3
    pos_vfar=0.65

    pos=1
    label_1=pos
    ax.bar(pos, waa_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_1=(label_1+pos)/2
    ax.bar(pos, dual_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_2=pos
    ax.bar(pos, waa_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_2=(label_2+pos)/2
    ax.bar(pos, dual_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_3=pos
    ax.bar(pos, waa_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_3=(label_3+pos)/2
    ax.bar(pos, dual_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_vfar
    label_4=pos
    ax.bar(pos, waa_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_4=(label_4+pos)/2
    ax.bar(pos, dual_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_5=pos
    ax.bar(pos, waa_10_med, width, color='white',edgecolor='black',linewidth=3,label="            ", hatch='//')
    pos=pos+pos_close
    label_5=(label_5+pos)/2
    ax.bar(pos, dual_10_med, width, color='white',edgecolor='black',linewidth=3, label="            ", hatch='.')

    pos=pos+pos_far
    label_6=pos
    ax.bar(pos, waa_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_6=(label_6+pos)/2
    ax.bar(pos, dual_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_vfar
    label_7=pos
    ax.bar(pos, waa_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_7=(label_7+pos)/2
    ax.bar(pos, dual_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_8=pos
    ax.bar(pos, waa_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_8=(label_8+pos)/2
    ax.bar(pos, dual_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    pos=pos+pos_far
    label_9=pos
    ax.bar(pos, waa_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_9=(label_9+pos)/2
    ax.bar(pos, dual_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')

    x = [label_1,label_2,label_3,label_4,label_5,label_6,label_7,label_8,label_9]
    labels = ['high', 'med', 'low','high', 'med', 'low','high', 'med', 'low']

    plt.text(label_2-0.2,-20,'0.5',fontsize='xx-large',color='k')
    plt.text(label_5-0.2,-20,'1.0',fontsize='xx-large',color='k')
    plt.text(label_8-0.2,-20,'2.0',fontsize='xx-large',color='k')

    plt.xticks(x, labels, rotation='horizontal',fontsize=14)
    plt.yticks(fontsize=14)
    plt.tight_layout()
    plt.ylabel('Queuing Delay (ms)', fontsize=25)
    #plt.ylabel('Dropping Probability (%)', fontsize=25)
    #plt.title('Queuing Delay low qos', fontsize=25)
    plt.legend(loc="upper left", fontsize=20,frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.show()
def plot2_delay_overall():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa_4m_delay_total_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0008892287608681711, 0.0008786900303064433,
                           0.0010367595469279226, 0.0010433449369324586, 0.0011198757987882276, 0.0011873553477994131,
                           0.0012997740380217553, 0.0013829077806417221, 0.0014449486346366468, 0.0015169470678262288,
                           0.0015193136720940612, 0.0015683087061052238, 0.0016322277920598823, 0.001722301093608706,
                           0.0018692284320577512, 0.0016182357494622175, 0.0020485009104347974, 0.0018487491454370142,
                           0.0018837046853495225, 0.0026139513465870553, 0.0021143671126356797, 0.0020160913260874195,
                           0.0022796730514816027, 0.001991840215291078, 0.0020805115855294805, 0.002252750107226622]

    waa_8m_delay_total_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0009632096885471679, 0.001118312985737054,
                           0.001609146317379074, 0.0014980823015185271, 0.0017425299100930303, 0.0017304522145164855,
                           0.001849886573064998, 0.0022133737165374308, 0.002016264635268353, 0.0023801742101100284,
                           0.002267604640935205, 0.0024347058825955237, 0.0025647946800698824, 0.0029035941933323725,
                           0.0027867492911752456, 0.0025278590062343394, 0.002645800354558284, 0.003056530488063297,
                           0.0033285522804969696, 0.003968539736124586, 0.004061478899529079, 0.0039191384497971275,
                           0.003915565998968639, 0.003432319969972904, 0.004040266788974173, 0.005553292418522419]

    waa_12m_delay_total_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0013075909400291036, 0.0017261437934957958,
                           0.0021369855562765657, 0.00226287820114732, 0.0024100202170651936, 0.0023488015547121553,
                           0.00272949877282669, 0.0030409945144182766, 0.0029514518327885776, 0.003564229054889237,
                           0.0036261124111215907, 0.003337941261464395, 0.0036971309154694835, 0.0045104626558126835,
                           0.004178861251418499, 0.004380849812032108, 0.005576346463527079, 0.0053440076284644155,
                           0.00429860622388671, 0.004999002624076045, 0.007051241583187794, 0.0065576187432021225,
                           0.0051513428751854525, 0.005209346896846998, 0.005666892287029021, 0.010187249353723279]

    waa_thru=[x/(1e9) for x in waa_thru_total_bps_avg[cutwaa:]]

    waa4_delay = [1000 * x for x in waa_4m_delay_total_avg[cutwaa:]]
    waa8_delay = [1000 * x for x in waa_8m_delay_total_avg[cutwaa:]]
    waa12_delay = [1000 * x for x in waa_12m_delay_total_avg[cutwaa:]]

    plt.plot(waa_thru, waa4_delay,'k', label="m=4",linewidth=3)
    plt.plot(waa_thru, waa8_delay,'k', label="m=8",linewidth=3)
    plt.plot(waa_thru, waa12_delay,'k', label="m=12",linewidth=3)

    plt.text(9,0.35,'N=4, N=8',fontsize='xx-large',color='k')
    #plt.text(9,1.05,'N=8',fontsize='xx-large',color='k')
    plt.text(9,1.65,'N=12',fontsize='xx-large',color='k')
    plt.xlabel('Throughput (Gbps)', fontsize=22)
    plt.ylabel('Total Delay (ms)', fontsize=22)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, x2, 0, 10.28))
    plt.tick_params(labelsize=14)
    #plt.legend(loc="upper left", fontsize=20, frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()
def plot2_qdelay_overall():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa4_qdelay_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5.638092358949874e-06, 5.69022531135302e-06,
                           5.827745478292494e-06, 6.367846016758198e-06, 6.509654093582516e-06, 6.345172373682276e-06,
                           6.115520941014969e-06, 6.252964181855903e-06, 6.4468101395073595e-06, 6.694979590114481e-06,
                           6.069237468047769e-06, 6.853735185836703e-06, 6.393603414211307e-06, 6.530659570021659e-06,
                           6.394922902573947e-06, 7.258190029096871e-06, 6.581277243430998e-06, 7.093876829195722e-06,
                           7.385860896104219e-06, 8.223972294475903e-06, 6.827928559422028e-06, 7.3906109141917916e-06,
                           7.713330903914284e-06, 5.897679041404363e-06, 7.876728492648523e-06, 6.715590658527857e-06]
    waa4_qdelay_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.03384014460463184, 0.03465627727505686,
                          0.03371754786752136, 0.032465623134988915, 0.03279897172758325, 0.031782588420061514,
                          0.03175680247258037, 0.0334362771282374, 0.03063534187852198, 0.03237708331891942,
                          0.03257228050477569, 0.03012637586520794, 0.030816079493678445, 0.031052656660410148,
                          0.030350684480915054, 0.030459345574681173, 0.03302790999589919, 0.029787405645111238,
                          0.027265055440988367, 0.028354974217623327, 0.03124765097137554, 0.03395189909270509,
                          0.027064638361782717, 0.028375188095079634, 0.028256433726655573, 0.02649522560161954]
    waa4_qdelay_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.029869404534009762, 0.025118712284926292,
                          0.028536592952000433, 0.02783211137386968, 0.03298770291211062, 0.030297112780023783,
                          0.028992469004474077, 0.029876881750588953, 0.029080279451688645, 0.027315252917743952,
                          0.029660961554018594, 0.029919671156786443, 0.02864224156600644, 0.030187172374727185,
                          0.03187440583471311, 0.029035266183638452, 0.027853580955176576, 0.03233232359741974,
                          0.03219118597063263, 0.032747119817870804, 0.026875690870290278, 0.02466951925640077,
                          0.030619738040276925, 0.02937146524960324]
    waa8_qdelay_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0650647297537422e-05, 1.1333169029417156e-05,
                           1.1356330613258537e-05, 1.1768382149297873e-05, 1.1723491458465955e-05,
                           1.1312025604035837e-05, 1.1657213224722935e-05, 1.0961659991326002e-05,
                           1.1926523943637497e-05, 1.1806245112364301e-05, 1.2278195654539447e-05,
                           1.189316708816653e-05, 1.1806008403688053e-05, 1.2341073597022085e-05,
                           1.1757909101664172e-05, 1.3405941992997145e-05, 1.290812563719088e-05,
                           1.2065393988330424e-05, 1.1884883489367585e-05, 1.5034473904414665e-05,
                           1.2968723040337677e-05, 1.3570501546789665e-05, 1.3793402859826497e-05,
                           1.1382397312878915e-05, 1.3205998448774601e-05, 1.218953449069034e-05]
    waa8_qdelay_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.06010749963028876, 0.0572367006488456,
                          0.06001935096728298, 0.054479236786431275, 0.054906181432550695, 0.0509650872117203,
                          0.05224732948266255, 0.05504484590997058, 0.048468476217861566, 0.05369388331154912,
                          0.05301155222882041, 0.04953269428225243, 0.04976226384819783, 0.05166334568346167,
                          0.049475021859813124, 0.05013053907267633, 0.05545839013658481, 0.049087879513824484,
                          0.04614075479925775, 0.04300012392274741, 0.048515747104061965, 0.05336830032504068,
                          0.04434962992130561, 0.04645970230072198, 0.0417351465929163, 0.035299640429057144]
    waa8_qdelay_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.05770215638368541, 0.06112576043491312,
                          0.05549646810280907, 0.052833039199472694, 0.05356641178399869, 0.05863473175344033,
                          0.05384408551114589, 0.05547478844133951, 0.05444020711454917, 0.05182216584425852,
                          0.0533119147430068, 0.056674895791900305, 0.04820640095645421, 0.05889355030849769,
                          0.06296732010925431, 0.05795046375644165, 0.04693436447322933, 0.060543109587282776,
                          0.05617564189372742, 0.07177969340169285, 0.05042897163102344, 0.04804149815348446,
                          0.0600985091297246, 0.051119690314705236]
    waa12_qdelay_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.342962559761841e-05, 2.016432730283867e-05,
                           2.053708216831911e-05, 2.0986123042310094e-05, 2.0434982661385776e-05, 1.969581757582973e-05,
                           2.0762567603463324e-05, 1.984841658296019e-05, 1.9478845471563327e-05, 2.008319916320624e-05,
                           2.1258581654104207e-05, 1.986720784293856e-05, 1.9137642484418328e-05,
                           1.9318311006845284e-05, 1.9799039790141967e-05, 2.1978805620714286e-05,
                           2.0756065983222103e-05, 1.9103171252676455e-05, 2.1388185077285755e-05,
                           2.3109691298830007e-05, 1.7887810869999482e-05, 2.3518495248196586e-05,
                           2.0121761241027526e-05, 1.6420148786279523e-05, 2.0951858473552692e-05,
                           1.8832010861617133e-05]
    waa12_qdelay_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.09903357250712616, 0.08378964167230869,
                          0.08729001540344551, 0.07744099757099672, 0.07695188964705367, 0.07215969791873571,
                          0.07235994715662943, 0.07539148214625893, 0.06544907811662826, 0.07549808863915804,
                          0.07347333508335302, 0.07153091047388924, 0.06826517450269541, 0.07232276306813819,
                          0.07019601501936976, 0.07210790862948108, 0.08011510174691944, 0.0663141131400594,
                          0.06600462659836581, 0.06291834916659908, 0.06335052636900157, 0.08023105319675247,
                          0.0616531696188688, 0.06459907726071179, 0.06048805866465347, 0.04618424591069754]
    waa12_qdelay_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.08732405897105483, 0.10496707017408956,
                          0.07411023077574189, 0.07430272427575599, 0.07932257271279039, 0.09214812910060835,
                          0.07626274964830043, 0.08723822079158013, 0.08360530379557828, 0.07816039344701135,
                          0.07833807663124183, 0.0858759896955656, 0.07894876613761655, 0.09158334899688236,
                          0.10090736016505386, 0.07955092336931201, 0.0732301431746694, 0.07740142155284653,
                          0.08788355974725195, 0.09406639766334039, 0.07373028833068238, 0.07332153480250508,
                          0.08155314851169705, 0.07521420375835504]

    waa4_idx_5=None
    waa4_idx_10=None
    waa4_idx_20=None
    waa8_idx_5=None
    waa8_idx_10=None
    waa8_idx_20=None
    waa12_idx_5=None
    waa12_idx_10=None
    waa12_idx_20=None
    refsmall=14e9
    refmed=25e9
    refbig=29e9

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa4_idx_5=i
            waa8_idx_5=i
            waa12_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa4_idx_10=i
            waa8_idx_10=i
            waa12_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa4_idx_20=i
            waa8_idx_20=i
            waa12_idx_20=i
        i=i+1

    print(str(waa4_idx_5))
    print(str(waa4_idx_10))
    print(str(waa4_idx_20))
    print(str(waa8_idx_5))
    print(str(waa8_idx_10))
    print(str(waa8_idx_20))
    print(str(waa12_idx_5))
    print(str(waa12_idx_10))
    print(str(waa12_idx_20))

    print(str(waa_load_total_bps_avg[waa4_idx_5]))
    print(str(waa_load_total_bps_avg[waa4_idx_10]))
    print(str(waa_load_total_bps_avg[waa4_idx_20]))

    print('----')
    waa4_5_high=(waa4_qdelay_high_avg[waa4_idx_5]*1000)*50
    waa4_5_med=waa4_qdelay_med_avg[waa4_idx_5]*1000
    waa4_5_low=waa4_qdelay_low_avg[waa4_idx_5]*1000
    waa4_10_high=waa4_qdelay_high_avg[waa4_idx_10]*1000*50
    waa4_10_med=waa4_qdelay_med_avg[waa4_idx_10]*1000
    waa4_10_low=waa4_qdelay_low_avg[waa4_idx_10]*1000
    waa4_20_high=waa4_qdelay_high_avg[waa4_idx_20]*1000*50
    waa4_20_med=waa4_qdelay_med_avg[waa4_idx_20]*1000
    waa4_20_low=waa4_qdelay_low_avg[waa4_idx_20]*1000
    waa8_5_high=(waa8_qdelay_high_avg[waa8_idx_5]*1000)*50
    waa8_5_med=waa8_qdelay_med_avg[waa8_idx_5]*1000
    waa8_5_low=waa8_qdelay_low_avg[waa8_idx_5]*1000
    waa8_10_high=waa8_qdelay_high_avg[waa8_idx_10]*1000*50
    waa8_10_med=waa8_qdelay_med_avg[waa8_idx_10]*1000
    waa8_10_low=waa8_qdelay_low_avg[waa8_idx_10]*1000
    waa8_20_high=waa8_qdelay_high_avg[waa8_idx_20]*1000*50
    waa8_20_med=waa8_qdelay_med_avg[waa8_idx_20]*1000
    waa8_20_low=waa8_qdelay_low_avg[waa8_idx_20]*1000
    waa12_5_high=(waa12_qdelay_high_avg[waa12_idx_5]*1000)*50
    waa12_5_med=waa12_qdelay_med_avg[waa12_idx_5]*1000
    waa12_5_low=waa12_qdelay_low_avg[waa12_idx_5]*1000
    waa12_10_high=waa12_qdelay_high_avg[waa12_idx_10]*1000*50
    waa12_10_med=waa12_qdelay_med_avg[waa12_idx_10]*1000
    waa12_10_low=waa12_qdelay_low_avg[waa12_idx_10]*1000
    waa12_20_high=waa12_qdelay_high_avg[waa12_idx_20]*1000*50
    waa12_20_med=waa12_qdelay_med_avg[waa12_idx_20]*1000
    waa12_20_low=waa12_qdelay_low_avg[waa12_idx_20]*1000

    print('waa_5_high='+str(waa4_5_high))
    print('waa_5_med='+str(waa4_5_med))
    print('waa_5_low='+str(waa4_5_low))
    print('waa_10_high='+str(waa4_10_high))
    print('waa_10_med='+str(waa4_10_med))
    print('waa_10_low='+str(waa4_10_low))
    print('waa_20_high='+str(waa4_20_high))
    print('waa_20_med='+str(waa4_20_med))
    print('waa_20_low='+str(waa4_20_low))
    print('waa_5_high='+str(waa8_5_high))
    print('waa_5_med='+str(waa8_5_med))
    print('waa_5_low='+str(waa8_5_low))
    print('waa_10_high='+str(waa8_10_high))
    print('waa_10_med='+str(waa8_10_med))
    print('waa_10_low='+str(waa8_10_low))
    print('waa_20_high='+str(waa8_20_high))
    print('waa_20_med='+str(waa8_20_med))
    print('waa_20_low='+str(waa8_20_low))
    print('waa_5_high='+str(waa12_5_high))
    print('waa_5_med='+str(waa12_5_med))
    print('waa_5_low='+str(waa12_5_low))
    print('waa_10_high='+str(waa12_10_high))
    print('waa_10_med='+str(waa12_10_med))
    print('waa_10_low='+str(waa12_10_low))
    print('waa_20_high='+str(waa12_20_high))
    print('waa_20_med='+str(waa12_20_med))
    print('waa_20_low='+str(waa12_20_low))

    fig, ax = plt.subplots()
    width=0.2
    pos_close=0.25
    pos_far=0.3
    pos_vfar=0.65

    pos=1
    label_1=pos
    ax.bar(pos, waa4_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_1=(label_1+pos)/2
    ax.bar(pos, waa8_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_2=pos
    ax.bar(pos, waa4_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_2=(label_2+pos)/2
    ax.bar(pos, waa8_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_3=pos
    ax.bar(pos, waa4_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_3=(label_3+pos)/2
    ax.bar(pos, waa8_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_vfar
    label_4=pos
    ax.bar(pos, waa4_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_4=(label_4+pos)/2
    ax.bar(pos, waa8_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_5=pos
    ax.bar(pos, waa4_10_med, width, color='white',edgecolor='black',linewidth=3,label="N=4", hatch='//')
    pos=pos+pos_close
    label_5=(label_5+pos)/2
    ax.bar(pos, waa8_10_med, width, color='white',edgecolor='black',linewidth=3, label="N=8", hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_10_med, width, color='white',edgecolor='black',linewidth=3, label="N=12",hatch='o')

    pos=pos+pos_far
    label_6=pos
    ax.bar(pos, waa4_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_6=(label_6+pos)/2
    ax.bar(pos, waa8_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_vfar
    label_7=pos
    ax.bar(pos, waa4_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_7=(label_7+pos)/2
    ax.bar(pos, waa8_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_8=pos
    ax.bar(pos, waa4_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_8=(label_8+pos)/2
    ax.bar(pos, waa8_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_9=pos
    ax.bar(pos, waa4_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_9=(label_9+pos)/2
    ax.bar(pos, waa8_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    x = [label_1,label_2,label_3,label_4,label_5,label_6,label_7,label_8,label_9]
    labels = ['high', 'med', 'low','high', 'med', 'low','high', 'med', 'low']

    plt.text(label_2-0.2,-10,'0.5',fontsize='xx-large',color='k')
    plt.text(label_5-0.2,-10,'1.0',fontsize='xx-large',color='k')
    plt.text(label_8-0.2,-10,'2.0',fontsize='xx-large',color='k')

    plt.xticks(x, labels, rotation='horizontal',fontsize=14)
    plt.yticks(fontsize=14)
    plt.tight_layout()
    plt.ylabel('Queuing Delay (ms)', fontsize=25)
    #plt.ylabel('Dropping Probability (%)', fontsize=25)
    #plt.title('Queuing Delay low qos', fontsize=25)
    plt.legend(loc="upper left", fontsize=20,frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.show()
def plot2_dropprob_overall():
    plt.rcParams["font.weight"] = "bold"
    plt.rcParams["axes.labelweight"] = "bold"

    waa4_drop_prob_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                              0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa4_drop_prob_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.721340330160775, 0.780421475288193,
                             0.7816489194024848, 0.8145633566703018, 0.8344385925794343, 0.8477432530200477,
                             0.8469456929469169, 0.8649906827436876, 0.8312454032024956, 0.8512165053190384,
                             0.8308779060703454, 0.8270477211930288, 0.8583870140768014, 0.8230274726001909,
                             0.8051748803237232, 0.8565769030186694, 0.8553434513444518, 0.8250630093850169,
                             0.7021031605468899, 0.6695798711551276, 0.7839711099583817, 0.8873742203255859,
                             0.6779965742756507, 0.8510797068437449, 0.6948654034319455, 0.5949359619101555]
    waa4_drop_prob_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.050685467653074585, 0.0481420988158432,
                             0.12048400962080959, 0.1946217703977335, 0.27615356830871207, 0.2810591991836669,
                             0.4736770934102849, 0.4915172403931031, 0.6052492861200891, 0.6180008975031088,
                             0.7137174042280279, 0.6755572124072264, 0.659056129613941, 0.8101331876532054,
                             0.7289638654892858, 0.7151645245911875, 0.7335424291060362, 0.5955851062985459,
                             0.8347439287029622, 0.7597062064440572, 0.7397180880656771, 0.7823131819123715,
                             0.8594687641091564, 0.75779341915729]

    waa8_drop_prob_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                              0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa8_drop_prob_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.7855778301995562, 0.8400508269212925,
                             0.7782762720101014, 0.8146259632096979, 0.8107632345325002, 0.817060455904416,
                             0.8273108416051103, 0.8083152642019572, 0.7991536614980238, 0.8239666032476514,
                             0.8127208864824148, 0.7974348733832665, 0.7978661790017556, 0.7617672944839654,
                             0.7559208613220894, 0.7832587410624988, 0.8310307943760369, 0.7680029114695381,
                             0.6622889880418871, 0.647126330236712, 0.568031446631591, 0.7344964085708559,
                             0.6635151650660683, 0.7478338782472599, 0.6366156430670725, 0.23125959157823642]
    waa8_drop_prob_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0437631805431253, 0.06327660599754911,
                             0.1603392456094517, 0.23263429649674974, 0.3283534634971585, 0.33098168524388644,
                             0.5697645059083478, 0.5322413415801197, 0.6220508854585379, 0.6944988410420609,
                             0.797881725948858, 0.7326405329234472, 0.7009302271250986, 0.8378278583436614,
                             0.8657468132522507, 0.7846693505785816, 0.6436785489537626, 0.6021998464729085,
                             0.7562207599588707, 0.8178824115735465, 0.621823237726187, 0.7735552738321383,
                             0.7247540626209759, 0.5783621346109346]

    waa12_drop_prob_high_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                              0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    waa12_drop_prob_med_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.8658806226389132, 0.7399618546993043,
                             0.7659404838599427, 0.7736824868266571, 0.7891933553799274, 0.7941523925080276,
                             0.7840295209190866, 0.7916538500219301, 0.7711321706871189, 0.7879421335566719,
                             0.774740270501264, 0.7810690187109447, 0.785291576135817, 0.7471852682127937,
                             0.7654296262494207, 0.7847253055624999, 0.7773665235764595, 0.7119617706798027,
                             0.7020266768443068, 0.6663608271400681, 0.521679485522725, 0.7382408157864685,
                             0.6768640707592993, 0.7744019182304575, 0.5744352576328783, 0.23416265583492704]
    waa12_drop_prob_low_avg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.06732510994101691, 0.08820739836632313,
                             0.1619392680626218, 0.23321463114836588, 0.2808314376440554, 0.28958341040269014,
                             0.5063182173445965, 0.5035977028485805, 0.6175815993836209, 0.7078696581187371,
                             0.7028359814285045, 0.6524349628385581, 0.6377059884934645, 0.7750743327735241,
                             0.687077093743836, 0.6550118698570241, 0.6523981777549386, 0.5356913347713335,
                             0.6128666353958883, 0.671315046274094, 0.6284286934503985, 0.7739994428147388,
                             0.6368061791869971, 0.28225656840001173]

    waa4_idx_5=None
    waa4_idx_10=None
    waa4_idx_20=None
    waa8_idx_5=None
    waa8_idx_10=None
    waa8_idx_20=None
    waa12_idx_5=None
    waa12_idx_10=None
    waa12_idx_20=None
    refsmall=14e9
    refmed=25e9
    refbig=29e9

    diff=math.inf
    i=0
    ref=refsmall
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa4_idx_5=i
            waa8_idx_5=i
            waa12_idx_5=i
        i=i+1

    diff=math.inf
    i=0
    ref=refmed
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa4_idx_10=i
            waa8_idx_10=i
            waa12_idx_10=i
        i=i+1

    diff=math.inf
    i=0
    ref=refbig
    while i<len(waa_load_total_bps_avg):
        new_diff=abs(waa_load_total_bps_avg[i]-ref)
        if new_diff<=diff:
            diff=new_diff
            waa4_idx_20=i
            waa8_idx_20=i
            waa12_idx_20=i
        i=i+1

    print(str(waa4_idx_5))
    print(str(waa4_idx_10))
    print(str(waa4_idx_20))
    print(str(waa8_idx_5))
    print(str(waa8_idx_10))
    print(str(waa8_idx_20))
    print(str(waa12_idx_5))
    print(str(waa12_idx_10))
    print(str(waa12_idx_20))

    print(str(waa_load_total_bps_avg[waa4_idx_5]))
    print(str(waa_load_total_bps_avg[waa4_idx_10]))
    print(str(waa_load_total_bps_avg[waa4_idx_20]))

    print('----')
    waa4_5_high=(waa4_drop_prob_high_avg[waa4_idx_5]*1)
    waa4_5_med=waa4_drop_prob_med_avg[waa4_idx_5]*1
    waa4_5_low=waa4_drop_prob_low_avg[waa4_idx_5]*1
    waa4_10_high=waa4_drop_prob_high_avg[waa4_idx_10]*1
    waa4_10_med=waa4_drop_prob_med_avg[waa4_idx_10]*1
    waa4_10_low=waa4_drop_prob_low_avg[waa4_idx_10]*1
    waa4_20_high=waa4_drop_prob_high_avg[waa4_idx_20]*1
    waa4_20_med=waa4_drop_prob_med_avg[waa4_idx_20]*1
    waa4_20_low=waa4_drop_prob_low_avg[waa4_idx_20]*1
    waa8_5_high=(waa8_drop_prob_high_avg[waa8_idx_5]*1)
    waa8_5_med=waa8_drop_prob_med_avg[waa8_idx_5]*1
    waa8_5_low=waa8_drop_prob_low_avg[waa8_idx_5]*1
    waa8_10_high=waa8_drop_prob_high_avg[waa8_idx_10]*1
    waa8_10_med=waa8_drop_prob_med_avg[waa8_idx_10]*1
    waa8_10_low=waa8_drop_prob_low_avg[waa8_idx_10]*1
    waa8_20_high=waa8_drop_prob_high_avg[waa8_idx_20]*1
    waa8_20_med=waa8_drop_prob_med_avg[waa8_idx_20]*1
    waa8_20_low=waa8_drop_prob_low_avg[waa8_idx_20]*1
    waa12_5_high=(waa12_drop_prob_high_avg[waa12_idx_5]*1)
    waa12_5_med=waa12_drop_prob_med_avg[waa12_idx_5]*1
    waa12_5_low=waa12_drop_prob_low_avg[waa12_idx_5]*1
    waa12_10_high=waa12_drop_prob_high_avg[waa12_idx_10]*1
    waa12_10_med=waa12_drop_prob_med_avg[waa12_idx_10]*1
    waa12_10_low=waa12_drop_prob_low_avg[waa12_idx_10]*1
    waa12_20_high=waa12_drop_prob_high_avg[waa12_idx_20]*1
    waa12_20_med=waa12_drop_prob_med_avg[waa12_idx_20]*1
    waa12_20_low=waa12_drop_prob_low_avg[waa12_idx_20]*1

    print('waa_5_high='+str(waa4_5_high))
    print('waa_5_med='+str(waa4_5_med))
    print('waa_5_low='+str(waa4_5_low))
    print('waa_10_high='+str(waa4_10_high))
    print('waa_10_med='+str(waa4_10_med))
    print('waa_10_low='+str(waa4_10_low))
    print('waa_20_high='+str(waa4_20_high))
    print('waa_20_med='+str(waa4_20_med))
    print('waa_20_low='+str(waa4_20_low))
    print('waa_5_high='+str(waa8_5_high))
    print('waa_5_med='+str(waa8_5_med))
    print('waa_5_low='+str(waa8_5_low))
    print('waa_10_high='+str(waa8_10_high))
    print('waa_10_med='+str(waa8_10_med))
    print('waa_10_low='+str(waa8_10_low))
    print('waa_20_high='+str(waa8_20_high))
    print('waa_20_med='+str(waa8_20_med))
    print('waa_20_low='+str(waa8_20_low))
    print('waa_5_high='+str(waa12_5_high))
    print('waa_5_med='+str(waa12_5_med))
    print('waa_5_low='+str(waa12_5_low))
    print('waa_10_high='+str(waa12_10_high))
    print('waa_10_med='+str(waa12_10_med))
    print('waa_10_low='+str(waa12_10_low))
    print('waa_20_high='+str(waa12_20_high))
    print('waa_20_med='+str(waa12_20_med))
    print('waa_20_low='+str(waa12_20_low))

    fig, ax = plt.subplots()
    width=0.2
    pos_close=0.25
    pos_far=0.3
    pos_vfar=0.65

    pos=1
    label_1=pos
    ax.bar(pos, waa4_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_1=(label_1+pos)/2
    ax.bar(pos, waa8_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_5_high, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_2=pos
    ax.bar(pos, waa4_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_2=(label_2+pos)/2
    ax.bar(pos, waa8_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_5_med, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_3=pos
    ax.bar(pos, waa4_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_3=(label_3+pos)/2
    ax.bar(pos, waa8_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_5_low, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_vfar
    label_4=pos
    ax.bar(pos, waa4_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_4=(label_4+pos)/2
    ax.bar(pos, waa8_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_10_high, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_5=pos
    ax.bar(pos, waa4_10_med, width, color='white',edgecolor='black',linewidth=3,label="N=4", hatch='//')
    pos=pos+pos_close
    label_5=(label_5+pos)/2
    ax.bar(pos, waa8_10_med, width, color='white',edgecolor='black',linewidth=3, label="N=8", hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_10_med, width, color='white',edgecolor='black',linewidth=3, label="N=12",hatch='o')

    pos=pos+pos_far
    label_6=pos
    ax.bar(pos, waa4_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_6=(label_6+pos)/2
    ax.bar(pos, waa8_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_10_low, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_vfar
    label_7=pos
    ax.bar(pos, waa4_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_7=(label_7+pos)/2
    ax.bar(pos, waa8_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_20_high, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_8=pos
    ax.bar(pos, waa4_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_8=(label_8+pos)/2
    ax.bar(pos, waa8_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_20_med, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    pos=pos+pos_far
    label_9=pos
    ax.bar(pos, waa4_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='//')
    pos=pos+pos_close
    label_9=(label_9+pos)/2
    ax.bar(pos, waa8_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='.')
    pos=pos+pos_close
    ax.bar(pos, waa12_20_low, width, color='white',edgecolor='black',linewidth=3, hatch='o')

    x = [label_1,label_2,label_3,label_4,label_5,label_6,label_7,label_8,label_9]
    labels = ['high', 'med', 'low','high', 'med', 'low','high', 'med', 'low']

    plt.text(label_2-0.2,-0.1,'0.5',fontsize='xx-large',color='k')
    plt.text(label_5-0.2,-0.1,'1.0',fontsize='xx-large',color='k')
    plt.text(label_8-0.2,-0.1,'2.0',fontsize='xx-large',color='k')

    plt.xticks(x, labels, rotation='horizontal',fontsize=14)
    plt.yticks(fontsize=14)
    plt.ylabel('Dropping Probability', fontsize=25)
    x1, x2, y1, y2 = plt.axis()
    plt.axis((0, x2, 0, 1))
    #plt.ylabel('Dropping Probability (%)', fontsize=25)
    #plt.title('Queuing Delay low qos', fontsize=25)
    plt.legend(loc="upper left", fontsize=20,frameon=False)
    plt.grid(True, which='major', axis='both')
    plt.tight_layout()
    plt.show()

# Common
cutdual=13
cutwaa=13
normload=10e9
#plot_thru_total_bps(cutdual,cutwaa)
#plot_thru_high_bps(cutdual,cutwaa)
#plot_thru_med_bps(cutdual,cutwaa)
#plot_thru_low_bps(cutdual,cutwaa)
#plot_drop_total_bps(cutdual,cutwaa)
#plot_drop_high_bps(cutdual,cutwaa)
#plot_drop_med_bps(cutdual,cutwaa)
#plot_drop_low_bps(cutdual,cutwaa)
#plot_delay_total(cutdual,cutwaa)
#plot_qdelay_total(cutdual,cutwaa)
#plot_qdelay_high(cutdual,cutwaa)
#plot_qdelay_med(cutdual,cutwaa)

# journal plots
#plot1_paper_total_thru_drop(cutdual,cutwaa)
#plot1_drop_prob_total(cutdual,cutwaa)
#plot1_delays(cutdual,cutwaa)
#plot1_qdelays()
#plot1_thru_per_server()

# conf plots
#plot2_thru_vs_norm_load()
#plot2_drop_vs_norm_load()
#plot2_delay_vs_thru()
#plot2_queuing()
#plot2_dropprob()
#plot2_thru_per_server()
#plot2_drop_per_server()
plot2_delay_overall()
#plot2_qdelay_overall()
#plot2_dropprob_overall()